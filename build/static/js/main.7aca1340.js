/*! For license information please see main.7aca1340.js.LICENSE.txt */
(()=>{var t={730:(t,e,i)=>{"use strict";var r=i(43),s=i(853);function n(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,i=1;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,o={};function l(t,e){u(t,e),u(t+"Capture",e)}function u(t,e){for(o[t]=e,t=0;t<e.length;t++)a.add(e[t])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(t,e,i,r,s,n,a){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=i,this.propertyName=t,this.type=e,this.sanitizeURL=n,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){g[t]=new m(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];g[e]=new m(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){g[t]=new m(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){g[t]=new m(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){g[t]=new m(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){g[t]=new m(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){g[t]=new m(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){g[t]=new m(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){g[t]=new m(t,5,!1,t.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function b(t){return t[1].toUpperCase()}function v(t,e,i,r){var s=g.hasOwnProperty(e)?g[e]:null;(null!==s?0!==s.type:r||!(2<e.length)||"o"!==e[0]&&"O"!==e[0]||"n"!==e[1]&&"N"!==e[1])&&(function(t,e,i,r){if(null===e||"undefined"===typeof e||function(t,e,i,r){if(null!==i&&0===i.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==i?!i.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,i,r))return!0;if(r)return!1;if(null!==i)switch(i.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,i,s,r)&&(i=null),r||null===s?function(t){return!!d.call(f,t)||!d.call(p,t)&&(_.test(t)?f[t]=!0:(p[t]=!0,!1))}(e)&&(null===i?t.removeAttribute(e):t.setAttribute(e,""+i)):s.mustUseProperty?t[s.propertyName]=null===i?3!==s.type&&"":i:(e=s.attributeName,r=s.attributeNamespace,null===i?t.removeAttribute(e):(i=3===(s=s.type)||4===s&&!0===i?"":""+i,r?t.setAttributeNS(r,e,i):t.setAttribute(e,i))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(y,b);g[e]=new m(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(y,b);g[e]=new m(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(y,b);g[e]=new m(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){g[t]=new m(t,1,!1,t.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){g[t]=new m(t,1,!1,t.toLowerCase(),null,!0,!0)}));var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=Symbol.for("react.element"),x=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),z=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),q=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),L=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var T=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function N(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=R&&t[R]||t["@@iterator"])?t:null}var U,D=Object.assign;function M(t){if(void 0===U)try{throw Error()}catch(i){var e=i.stack.trim().match(/\n( *(at )?)/);U=e&&e[1]||""}return"\n"+U+t}var F=!1;function j(t,e){if(!t||F)return"";F=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&"string"===typeof u.stack){for(var s=u.stack.split("\n"),n=r.stack.split("\n"),a=s.length-1,o=n.length-1;1<=a&&0<=o&&s[a]!==n[o];)o--;for(;1<=a&&0<=o;a--,o--)if(s[a]!==n[o]){if(1!==a||1!==o)do{if(a--,0>--o||s[a]!==n[o]){var l="\n"+s[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}}while(1<=a&&0<=o);break}}}finally{F=!1,Error.prepareStackTrace=i}return(t=t?t.displayName||t.name:"")?M(t):""}function V(t){switch(t.tag){case 5:return M(t.type);case 16:return M("Lazy");case 13:return M("Suspense");case 19:return M("SuspenseList");case 0:case 2:case 15:return t=j(t.type,!1);case 11:return t=j(t.type.render,!1);case 1:return t=j(t.type,!0);default:return""}}function B(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case C:return"Fragment";case x:return"Portal";case A:return"Profiler";case S:return"StrictMode";case P:return"Suspense";case q:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case z:return(t.displayName||"Context")+".Consumer";case E:return(t._context.displayName||"Context")+".Provider";case I:var e=t.render;return(t=t.displayName)||(t=""!==(t=e.displayName||e.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case O:return null!==(e=t.displayName||null)?e:B(t.type)||"Memo";case L:e=t._payload,t=t._init;try{return B(t(e))}catch(i){}}return null}function G(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=(t=e.render).displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(e);case 8:return e===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e}return null}function W(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":case"object":return t;default:return""}}function H(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function $(t){t._valueTracker||(t._valueTracker=function(t){var e=H(t)?"checked":"value",i=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof i&&"function"===typeof i.get&&"function"===typeof i.set){var s=i.get,n=i.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(t){r=""+t,n.call(this,t)}}),Object.defineProperty(t,e,{enumerable:i.enumerable}),{getValue:function(){return r},setValue:function(t){r=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function Q(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var i=e.getValue(),r="";return t&&(r=H(t)?t.checked?"true":"false":t.value),(t=r)!==i&&(e.setValue(t),!0)}function K(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function X(t,e){var i=e.checked;return D({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=i?i:t._wrapperState.initialChecked})}function Y(t,e){var i=null==e.defaultValue?"":e.defaultValue,r=null!=e.checked?e.checked:e.defaultChecked;i=W(null!=e.value?e.value:i),t._wrapperState={initialChecked:r,initialValue:i,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function J(t,e){null!=(e=e.checked)&&v(t,"checked",e,!1)}function Z(t,e){J(t,e);var i=W(e.value),r=e.type;if(null!=i)"number"===r?(0===i&&""===t.value||t.value!=i)&&(t.value=""+i):t.value!==""+i&&(t.value=""+i);else if("submit"===r||"reset"===r)return void t.removeAttribute("value");e.hasOwnProperty("value")?et(t,e.type,i):e.hasOwnProperty("defaultValue")&&et(t,e.type,W(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function tt(t,e,i){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!("submit"!==r&&"reset"!==r||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,i||e===t.value||(t.value=e),t.defaultValue=e}""!==(i=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==i&&(t.name=i)}function et(t,e,i){"number"===e&&K(t.ownerDocument)===t||(null==i?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+i&&(t.defaultValue=""+i))}var it=Array.isArray;function rt(t,e,i,r){if(t=t.options,e){e={};for(var s=0;s<i.length;s++)e["$"+i[s]]=!0;for(i=0;i<t.length;i++)s=e.hasOwnProperty("$"+t[i].value),t[i].selected!==s&&(t[i].selected=s),s&&r&&(t[i].defaultSelected=!0)}else{for(i=""+W(i),e=null,s=0;s<t.length;s++){if(t[s].value===i)return t[s].selected=!0,void(r&&(t[s].defaultSelected=!0));null!==e||t[s].disabled||(e=t[s])}null!==e&&(e.selected=!0)}}function st(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(n(91));return D({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function nt(t,e){var i=e.value;if(null==i){if(i=e.children,e=e.defaultValue,null!=i){if(null!=e)throw Error(n(92));if(it(i)){if(1<i.length)throw Error(n(93));i=i[0]}e=i}null==e&&(e=""),i=e}t._wrapperState={initialValue:W(i)}}function at(t,e){var i=W(e.value),r=W(e.defaultValue);null!=i&&((i=""+i)!==t.value&&(t.value=i),null==e.defaultValue&&t.defaultValue!==i&&(t.defaultValue=i)),null!=r&&(t.defaultValue=""+r)}function ot(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}function lt(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ut(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?lt(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var ht,ct,dt=(ct=function(t,e){if("http://www.w3.org/2000/svg"!==t.namespaceURI||"innerHTML"in t)t.innerHTML=e;else{for((ht=ht||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ht.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,i,r){MSApp.execUnsafeLocalFunction((function(){return ct(t,e)}))}:ct);function _t(t,e){if(e){var i=t.firstChild;if(i&&i===t.lastChild&&3===i.nodeType)return void(i.nodeValue=e)}t.textContent=e}var pt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ft=["Webkit","ms","Moz","O"];function mt(t,e,i){return null==e||"boolean"===typeof e||""===e?"":i||"number"!==typeof e||0===e||pt.hasOwnProperty(t)&&pt[t]?(""+e).trim():e+"px"}function gt(t,e){for(var i in t=t.style,e)if(e.hasOwnProperty(i)){var r=0===i.indexOf("--"),s=mt(i,e[i],r);"float"===i&&(i="cssFloat"),r?t.setProperty(i,s):t[i]=s}}Object.keys(pt).forEach((function(t){ft.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),pt[e]=pt[t]}))}));var yt=D({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function bt(t,e){if(e){if(yt[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(n(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(n(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(n(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(n(62))}}function vt(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wt=null;function kt(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var xt=null,Ct=null,St=null;function At(t){if(t=bs(t)){if("function"!==typeof xt)throw Error(n(280));var e=t.stateNode;e&&(e=ws(e),xt(t.stateNode,t.type,e))}}function Et(t){Ct?St?St.push(t):St=[t]:Ct=t}function zt(){if(Ct){var t=Ct,e=St;if(St=Ct=null,At(t),e)for(t=0;t<e.length;t++)At(e[t])}}function It(t,e){return t(e)}function Pt(){}var qt=!1;function Ot(t,e,i){if(qt)return t(e,i);qt=!0;try{return It(t,e,i)}finally{qt=!1,(null!==Ct||null!==St)&&(Pt(),zt())}}function Lt(t,e){var i=t.stateNode;if(null===i)return null;var r=ws(i);if(null===r)return null;i=r[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!r;break t;default:t=!1}if(t)return null;if(i&&"function"!==typeof i)throw Error(n(231,e,typeof i));return i}var Tt=!1;if(c)try{var Rt={};Object.defineProperty(Rt,"passive",{get:function(){Tt=!0}}),window.addEventListener("test",Rt,Rt),window.removeEventListener("test",Rt,Rt)}catch(ct){Tt=!1}function Nt(t,e,i,r,s,n,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(i,u)}catch(h){this.onError(h)}}var Ut=!1,Dt=null,Mt=!1,Ft=null,jt={onError:function(t){Ut=!0,Dt=t}};function Vt(t,e,i,r,s,n,a,o,l){Ut=!1,Dt=null,Nt.apply(jt,arguments)}function Bt(t){var e=t,i=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(4098&(e=t).flags)&&(i=e.return),t=e.return}while(t)}return 3===e.tag?i:null}function Gt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function Wt(t){if(Bt(t)!==t)throw Error(n(188))}function Ht(t){return null!==(t=function(t){var e=t.alternate;if(!e){if(null===(e=Bt(t)))throw Error(n(188));return e!==t?null:t}for(var i=t,r=e;;){var s=i.return;if(null===s)break;var a=s.alternate;if(null===a){if(null!==(r=s.return)){i=r;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===i)return Wt(s),t;if(a===r)return Wt(s),e;a=a.sibling}throw Error(n(188))}if(i.return!==r.return)i=s,r=a;else{for(var o=!1,l=s.child;l;){if(l===i){o=!0,i=s,r=a;break}if(l===r){o=!0,r=s,i=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===i){o=!0,i=a,r=s;break}if(l===r){o=!0,r=a,i=s;break}l=l.sibling}if(!o)throw Error(n(189))}}if(i.alternate!==r)throw Error(n(190))}if(3!==i.tag)throw Error(n(188));return i.stateNode.current===i?t:e}(t))?$t(t):null}function $t(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var e=$t(t);if(null!==e)return e;t=t.sibling}return null}var Qt=s.unstable_scheduleCallback,Kt=s.unstable_cancelCallback,Xt=s.unstable_shouldYield,Yt=s.unstable_requestPaint,Jt=s.unstable_now,Zt=s.unstable_getCurrentPriorityLevel,te=s.unstable_ImmediatePriority,ee=s.unstable_UserBlockingPriority,ie=s.unstable_NormalPriority,re=s.unstable_LowPriority,se=s.unstable_IdlePriority,ne=null,ae=null;var oe=Math.clz32?Math.clz32:function(t){return t>>>=0,0===t?32:31-(le(t)/ue|0)|0},le=Math.log,ue=Math.LN2;var he=64,ce=4194304;function de(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&t;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&t;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function _e(t,e){var i=t.pendingLanes;if(0===i)return 0;var r=0,s=t.suspendedLanes,n=t.pingedLanes,a=268435455&i;if(0!==a){var o=a&~s;0!==o?r=de(o):0!==(n&=a)&&(r=de(n))}else 0!==(a=i&~s)?r=de(a):0!==n&&(r=de(n));if(0===r)return 0;if(0!==e&&e!==r&&0===(e&s)&&((s=r&-r)>=(n=e&-e)||16===s&&0!==(4194240&n)))return e;if(0!==(4&r)&&(r|=16&i),0!==(e=t.entangledLanes))for(t=t.entanglements,e&=r;0<e;)s=1<<(i=31-oe(e)),r|=t[i],e&=~s;return r}function pe(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;default:return-1}}function fe(t){return 0!==(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function me(){var t=he;return 0===(4194240&(he<<=1))&&(he=64),t}function ge(t){for(var e=[],i=0;31>i;i++)e.push(t);return e}function ye(t,e,i){t.pendingLanes|=e,536870912!==e&&(t.suspendedLanes=0,t.pingedLanes=0),(t=t.eventTimes)[e=31-oe(e)]=i}function be(t,e){var i=t.entangledLanes|=e;for(t=t.entanglements;i;){var r=31-oe(i),s=1<<r;s&e|t[r]&e&&(t[r]|=e),i&=~s}}var ve=0;function we(t){return 1<(t&=-t)?4<t?0!==(268435455&t)?16:536870912:4:1}var ke,xe,Ce,Se,Ae,Ee=!1,ze=[],Ie=null,Pe=null,qe=null,Oe=new Map,Le=new Map,Te=[],Re="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ne(t,e){switch(t){case"focusin":case"focusout":Ie=null;break;case"dragenter":case"dragleave":Pe=null;break;case"mouseover":case"mouseout":qe=null;break;case"pointerover":case"pointerout":Oe.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Le.delete(e.pointerId)}}function Ue(t,e,i,r,s,n){return null===t||t.nativeEvent!==n?(t={blockedOn:e,domEventName:i,eventSystemFlags:r,nativeEvent:n,targetContainers:[s]},null!==e&&(null!==(e=bs(e))&&xe(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,null!==s&&-1===e.indexOf(s)&&e.push(s),t)}function De(t){var e=ys(t.target);if(null!==e){var i=Bt(e);if(null!==i)if(13===(e=i.tag)){if(null!==(e=Gt(i)))return t.blockedOn=e,void Ae(t.priority,(function(){Ce(i)}))}else if(3===e&&i.stateNode.current.memoizedState.isDehydrated)return void(t.blockedOn=3===i.tag?i.stateNode.containerInfo:null)}t.blockedOn=null}function Me(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var i=Xe(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==i)return null!==(e=bs(i))&&xe(e),t.blockedOn=i,!1;var r=new(i=t.nativeEvent).constructor(i.type,i);wt=r,i.target.dispatchEvent(r),wt=null,e.shift()}return!0}function Fe(t,e,i){Me(t)&&i.delete(e)}function je(){Ee=!1,null!==Ie&&Me(Ie)&&(Ie=null),null!==Pe&&Me(Pe)&&(Pe=null),null!==qe&&Me(qe)&&(qe=null),Oe.forEach(Fe),Le.forEach(Fe)}function Ve(t,e){t.blockedOn===e&&(t.blockedOn=null,Ee||(Ee=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,je)))}function Be(t){function e(e){return Ve(e,t)}if(0<ze.length){Ve(ze[0],t);for(var i=1;i<ze.length;i++){var r=ze[i];r.blockedOn===t&&(r.blockedOn=null)}}for(null!==Ie&&Ve(Ie,t),null!==Pe&&Ve(Pe,t),null!==qe&&Ve(qe,t),Oe.forEach(e),Le.forEach(e),i=0;i<Te.length;i++)(r=Te[i]).blockedOn===t&&(r.blockedOn=null);for(;0<Te.length&&null===(i=Te[0]).blockedOn;)De(i),null===i.blockedOn&&Te.shift()}var Ge=w.ReactCurrentBatchConfig,We=!0;function He(t,e,i,r){var s=ve,n=Ge.transition;Ge.transition=null;try{ve=1,Qe(t,e,i,r)}finally{ve=s,Ge.transition=n}}function $e(t,e,i,r){var s=ve,n=Ge.transition;Ge.transition=null;try{ve=4,Qe(t,e,i,r)}finally{ve=s,Ge.transition=n}}function Qe(t,e,i,r){if(We){var s=Xe(t,e,i,r);if(null===s)Gr(t,e,r,Ke,i),Ne(t,r);else if(function(t,e,i,r,s){switch(e){case"focusin":return Ie=Ue(Ie,t,e,i,r,s),!0;case"dragenter":return Pe=Ue(Pe,t,e,i,r,s),!0;case"mouseover":return qe=Ue(qe,t,e,i,r,s),!0;case"pointerover":var n=s.pointerId;return Oe.set(n,Ue(Oe.get(n)||null,t,e,i,r,s)),!0;case"gotpointercapture":return n=s.pointerId,Le.set(n,Ue(Le.get(n)||null,t,e,i,r,s)),!0}return!1}(s,t,e,i,r))r.stopPropagation();else if(Ne(t,r),4&e&&-1<Re.indexOf(t)){for(;null!==s;){var n=bs(s);if(null!==n&&ke(n),null===(n=Xe(t,e,i,r))&&Gr(t,e,r,Ke,i),n===s)break;s=n}null!==s&&r.stopPropagation()}else Gr(t,e,r,null,i)}}var Ke=null;function Xe(t,e,i,r){if(Ke=null,null!==(t=ys(t=kt(r))))if(null===(e=Bt(t)))t=null;else if(13===(i=e.tag)){if(null!==(t=Gt(e)))return t;t=null}else if(3===i){if(e.stateNode.current.memoizedState.isDehydrated)return 3===e.tag?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ke=t,null}function Ye(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Zt()){case te:return 1;case ee:return 4;case ie:case re:return 16;case se:return 536870912;default:return 16}default:return 16}}var Je=null,Ze=null,ti=null;function ei(){if(ti)return ti;var t,e,i=Ze,r=i.length,s="value"in Je?Je.value:Je.textContent,n=s.length;for(t=0;t<r&&i[t]===s[t];t++);var a=r-t;for(e=1;e<=a&&i[r-e]===s[n-e];e++);return ti=s.slice(t,1<e?1-e:void 0)}function ii(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function ri(){return!0}function si(){return!1}function ni(t){function e(e,i,r,s,n){for(var a in this._reactName=e,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=n,this.currentTarget=null,t)t.hasOwnProperty(a)&&(e=t[a],this[a]=e?e(s):s[a]);return this.isDefaultPrevented=(null!=s.defaultPrevented?s.defaultPrevented:!1===s.returnValue)?ri:si,this.isPropagationStopped=si,this}return D(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=ri)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=ri)},persist:function(){},isPersistent:ri}),e}var ai,oi,li,ui={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hi=ni(ui),ci=D({},ui,{view:0,detail:0}),di=ni(ci),_i=D({},ci,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Si,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==li&&(li&&"mousemove"===t.type?(ai=t.screenX-li.screenX,oi=t.screenY-li.screenY):oi=ai=0,li=t),ai)},movementY:function(t){return"movementY"in t?t.movementY:oi}}),pi=ni(_i),fi=ni(D({},_i,{dataTransfer:0})),mi=ni(D({},ci,{relatedTarget:0})),gi=ni(D({},ui,{animationName:0,elapsedTime:0,pseudoElement:0})),yi=D({},ui,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),bi=ni(yi),vi=ni(D({},ui,{data:0})),wi={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ki={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ci(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=xi[t])&&!!e[t]}function Si(){return Ci}var Ai=D({},ci,{key:function(t){if(t.key){var e=wi[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=ii(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?ki[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Si,charCode:function(t){return"keypress"===t.type?ii(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?ii(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),Ei=ni(Ai),zi=ni(D({},_i,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Ii=ni(D({},ci,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Si})),Pi=ni(D({},ui,{propertyName:0,elapsedTime:0,pseudoElement:0})),qi=D({},_i,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Oi=ni(qi),Li=[9,13,27,32],Ti=c&&"CompositionEvent"in window,Ri=null;c&&"documentMode"in document&&(Ri=document.documentMode);var Ni=c&&"TextEvent"in window&&!Ri,Ui=c&&(!Ti||Ri&&8<Ri&&11>=Ri),Di=String.fromCharCode(32),Mi=!1;function Fi(t,e){switch(t){case"keyup":return-1!==Li.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ji(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var Vi=!1;var Bi={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gi(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Bi[t.type]:"textarea"===e}function Wi(t,e,i,r){Et(r),0<(e=Hr(e,"onChange")).length&&(i=new hi("onChange","change",null,i,r),t.push({event:i,listeners:e}))}var Hi=null,$i=null;function Qi(t){Dr(t,0)}function Ki(t){if(Q(vs(t)))return t}function Xi(t,e){if("change"===t)return e}var Yi=!1;if(c){var Ji;if(c){var Zi="oninput"in document;if(!Zi){var tr=document.createElement("div");tr.setAttribute("oninput","return;"),Zi="function"===typeof tr.oninput}Ji=Zi}else Ji=!1;Yi=Ji&&(!document.documentMode||9<document.documentMode)}function er(){Hi&&(Hi.detachEvent("onpropertychange",ir),$i=Hi=null)}function ir(t){if("value"===t.propertyName&&Ki($i)){var e=[];Wi(e,$i,t,kt(t)),Ot(Qi,e)}}function rr(t,e,i){"focusin"===t?(er(),$i=i,(Hi=e).attachEvent("onpropertychange",ir)):"focusout"===t&&er()}function sr(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return Ki($i)}function nr(t,e){if("click"===t)return Ki(e)}function ar(t,e){if("input"===t||"change"===t)return Ki(e)}var or="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e};function lr(t,e){if(or(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var i=Object.keys(t),r=Object.keys(e);if(i.length!==r.length)return!1;for(r=0;r<i.length;r++){var s=i[r];if(!d.call(e,s)||!or(t[s],e[s]))return!1}return!0}function ur(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function hr(t,e){var i,r=ur(t);for(t=0;r;){if(3===r.nodeType){if(i=t+r.textContent.length,t<=e&&i>=e)return{node:r,offset:e-t};t=i}t:{for(;r;){if(r.nextSibling){r=r.nextSibling;break t}r=r.parentNode}r=void 0}r=ur(r)}}function cr(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?cr(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function dr(){for(var t=window,e=K();e instanceof t.HTMLIFrameElement;){try{var i="string"===typeof e.contentWindow.location.href}catch(r){i=!1}if(!i)break;e=K((t=e.contentWindow).document)}return e}function _r(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}function pr(t){var e=dr(),i=t.focusedElem,r=t.selectionRange;if(e!==i&&i&&i.ownerDocument&&cr(i.ownerDocument.documentElement,i)){if(null!==r&&_r(i))if(e=r.start,void 0===(t=r.end)&&(t=e),"selectionStart"in i)i.selectionStart=e,i.selectionEnd=Math.min(t,i.value.length);else if((t=(e=i.ownerDocument||document)&&e.defaultView||window).getSelection){t=t.getSelection();var s=i.textContent.length,n=Math.min(r.start,s);r=void 0===r.end?n:Math.min(r.end,s),!t.extend&&n>r&&(s=r,r=n,n=s),s=hr(i,n);var a=hr(i,r);s&&a&&(1!==t.rangeCount||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&((e=e.createRange()).setStart(s.node,s.offset),t.removeAllRanges(),n>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}for(e=[],t=i;t=t.parentNode;)1===t.nodeType&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for("function"===typeof i.focus&&i.focus(),i=0;i<e.length;i++)(t=e[i]).element.scrollLeft=t.left,t.element.scrollTop=t.top}}var fr=c&&"documentMode"in document&&11>=document.documentMode,mr=null,gr=null,yr=null,br=!1;function vr(t,e,i){var r=i.window===i?i.document:9===i.nodeType?i:i.ownerDocument;br||null==mr||mr!==K(r)||("selectionStart"in(r=mr)&&_r(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&lr(yr,r)||(yr=r,0<(r=Hr(gr,"onSelect")).length&&(e=new hi("onSelect","select",null,e,i),t.push({event:e,listeners:r}),e.target=mr)))}function wr(t,e){var i={};return i[t.toLowerCase()]=e.toLowerCase(),i["Webkit"+t]="webkit"+e,i["Moz"+t]="moz"+e,i}var kr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},xr={},Cr={};function Sr(t){if(xr[t])return xr[t];if(!kr[t])return t;var e,i=kr[t];for(e in i)if(i.hasOwnProperty(e)&&e in Cr)return xr[t]=i[e];return t}c&&(Cr=document.createElement("div").style,"AnimationEvent"in window||(delete kr.animationend.animation,delete kr.animationiteration.animation,delete kr.animationstart.animation),"TransitionEvent"in window||delete kr.transitionend.transition);var Ar=Sr("animationend"),Er=Sr("animationiteration"),zr=Sr("animationstart"),Ir=Sr("transitionend"),Pr=new Map,qr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Or(t,e){Pr.set(t,e),l(e,[t])}for(var Lr=0;Lr<qr.length;Lr++){var Tr=qr[Lr];Or(Tr.toLowerCase(),"on"+(Tr[0].toUpperCase()+Tr.slice(1)))}Or(Ar,"onAnimationEnd"),Or(Er,"onAnimationIteration"),Or(zr,"onAnimationStart"),Or("dblclick","onDoubleClick"),Or("focusin","onFocus"),Or("focusout","onBlur"),Or(Ir,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rr));function Ur(t,e,i){var r=t.type||"unknown-event";t.currentTarget=i,function(t,e,i,r,s,a,o,l,u){if(Vt.apply(this,arguments),Ut){if(!Ut)throw Error(n(198));var h=Dt;Ut=!1,Dt=null,Mt||(Mt=!0,Ft=h)}}(r,e,void 0,t),t.currentTarget=null}function Dr(t,e){e=0!==(4&e);for(var i=0;i<t.length;i++){var r=t[i],s=r.event;r=r.listeners;t:{var n=void 0;if(e)for(var a=r.length-1;0<=a;a--){var o=r[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==n&&s.isPropagationStopped())break t;Ur(s,o,u),n=l}else for(a=0;a<r.length;a++){if(l=(o=r[a]).instance,u=o.currentTarget,o=o.listener,l!==n&&s.isPropagationStopped())break t;Ur(s,o,u),n=l}}}if(Mt)throw t=Ft,Mt=!1,Ft=null,t}function Mr(t,e){var i=e[fs];void 0===i&&(i=e[fs]=new Set);var r=t+"__bubble";i.has(r)||(Br(e,t,2,!1),i.add(r))}function Fr(t,e,i){var r=0;e&&(r|=4),Br(i,t,r,e)}var jr="_reactListening"+Math.random().toString(36).slice(2);function Vr(t){if(!t[jr]){t[jr]=!0,a.forEach((function(e){"selectionchange"!==e&&(Nr.has(e)||Fr(e,!1,t),Fr(e,!0,t))}));var e=9===t.nodeType?t:t.ownerDocument;null===e||e[jr]||(e[jr]=!0,Fr("selectionchange",!1,e))}}function Br(t,e,i,r){switch(Ye(e)){case 1:var s=He;break;case 4:s=$e;break;default:s=Qe}i=s.bind(null,e,i,t),s=void 0,!Tt||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(s=!0),r?void 0!==s?t.addEventListener(e,i,{capture:!0,passive:s}):t.addEventListener(e,i,!0):void 0!==s?t.addEventListener(e,i,{passive:s}):t.addEventListener(e,i,!1)}function Gr(t,e,i,r,s){var n=r;if(0===(1&e)&&0===(2&e)&&null!==r)t:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var o=r.stateNode.containerInfo;if(o===s||8===o.nodeType&&o.parentNode===s)break;if(4===a)for(a=r.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===s||8===l.nodeType&&l.parentNode===s))return;a=a.return}for(;null!==o;){if(null===(a=ys(o)))return;if(5===(l=a.tag)||6===l){r=n=a;continue t}o=o.parentNode}}r=r.return}Ot((function(){var r=n,s=kt(i),a=[];t:{var o=Pr.get(t);if(void 0!==o){var l=hi,u=t;switch(t){case"keypress":if(0===ii(i))break t;case"keydown":case"keyup":l=Ei;break;case"focusin":u="focus",l=mi;break;case"focusout":u="blur",l=mi;break;case"beforeblur":case"afterblur":l=mi;break;case"click":if(2===i.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pi;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Ii;break;case Ar:case Er:case zr:l=gi;break;case Ir:l=Pi;break;case"scroll":l=di;break;case"wheel":l=Oi;break;case"copy":case"cut":case"paste":l=bi;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=zi}var h=0!==(4&e),c=!h&&"scroll"===t,d=h?null!==o?o+"Capture":null:o;h=[];for(var _,p=r;null!==p;){var f=(_=p).stateNode;if(5===_.tag&&null!==f&&(_=f,null!==d&&(null!=(f=Lt(p,d))&&h.push(Wr(p,f,_)))),c)break;p=p.return}0<h.length&&(o=new l(o,u,null,i,s),a.push({event:o,listeners:h}))}}if(0===(7&e)){if(l="mouseout"===t||"pointerout"===t,(!(o="mouseover"===t||"pointerover"===t)||i===wt||!(u=i.relatedTarget||i.fromElement)||!ys(u)&&!u[ps])&&(l||o)&&(o=s.window===s?s:(o=s.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=r,null!==(u=(u=i.relatedTarget||i.toElement)?ys(u):null)&&(u!==(c=Bt(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=r),l!==u)){if(h=pi,f="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==t&&"pointerover"!==t||(h=zi,f="onPointerLeave",d="onPointerEnter",p="pointer"),c=null==l?o:vs(l),_=null==u?o:vs(u),(o=new h(f,p+"leave",l,i,s)).target=c,o.relatedTarget=_,f=null,ys(s)===r&&((h=new h(d,p+"enter",u,i,s)).target=_,h.relatedTarget=c,f=h),c=f,l&&u)t:{for(d=u,p=0,_=h=l;_;_=$r(_))p++;for(_=0,f=d;f;f=$r(f))_++;for(;0<p-_;)h=$r(h),p--;for(;0<_-p;)d=$r(d),_--;for(;p--;){if(h===d||null!==d&&h===d.alternate)break t;h=$r(h),d=$r(d)}h=null}else h=null;null!==l&&Qr(a,o,l,h,!1),null!==u&&null!==c&&Qr(a,c,u,h,!0)}if("select"===(l=(o=r?vs(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var m=Xi;else if(Gi(o))if(Yi)m=ar;else{m=sr;var g=rr}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(m=nr);switch(m&&(m=m(t,r))?Wi(a,m,i,s):(g&&g(t,o,r),"focusout"===t&&(g=o._wrapperState)&&g.controlled&&"number"===o.type&&et(o,"number",o.value)),g=r?vs(r):window,t){case"focusin":(Gi(g)||"true"===g.contentEditable)&&(mr=g,gr=r,yr=null);break;case"focusout":yr=gr=mr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,vr(a,i,s);break;case"selectionchange":if(fr)break;case"keydown":case"keyup":vr(a,i,s)}var y;if(Ti)t:{switch(t){case"compositionstart":var b="onCompositionStart";break t;case"compositionend":b="onCompositionEnd";break t;case"compositionupdate":b="onCompositionUpdate";break t}b=void 0}else Vi?Fi(t,i)&&(b="onCompositionEnd"):"keydown"===t&&229===i.keyCode&&(b="onCompositionStart");b&&(Ui&&"ko"!==i.locale&&(Vi||"onCompositionStart"!==b?"onCompositionEnd"===b&&Vi&&(y=ei()):(Ze="value"in(Je=s)?Je.value:Je.textContent,Vi=!0)),0<(g=Hr(r,b)).length&&(b=new vi(b,t,null,i,s),a.push({event:b,listeners:g}),y?b.data=y:null!==(y=ji(i))&&(b.data=y))),(y=Ni?function(t,e){switch(t){case"compositionend":return ji(e);case"keypress":return 32!==e.which?null:(Mi=!0,Di);case"textInput":return(t=e.data)===Di&&Mi?null:t;default:return null}}(t,i):function(t,e){if(Vi)return"compositionend"===t||!Ti&&Fi(t,e)?(t=ei(),ti=Ze=Je=null,Vi=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Ui&&"ko"!==e.locale?null:e.data}}(t,i))&&(0<(r=Hr(r,"onBeforeInput")).length&&(s=new vi("onBeforeInput","beforeinput",null,i,s),a.push({event:s,listeners:r}),s.data=y))}Dr(a,e)}))}function Wr(t,e,i){return{instance:t,listener:e,currentTarget:i}}function Hr(t,e){for(var i=e+"Capture",r=[];null!==t;){var s=t,n=s.stateNode;5===s.tag&&null!==n&&(s=n,null!=(n=Lt(t,i))&&r.unshift(Wr(t,n,s)),null!=(n=Lt(t,e))&&r.push(Wr(t,n,s))),t=t.return}return r}function $r(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function Qr(t,e,i,r,s){for(var n=e._reactName,a=[];null!==i&&i!==r;){var o=i,l=o.alternate,u=o.stateNode;if(null!==l&&l===r)break;5===o.tag&&null!==u&&(o=u,s?null!=(l=Lt(i,n))&&a.unshift(Wr(i,l,o)):s||null!=(l=Lt(i,n))&&a.push(Wr(i,l,o))),i=i.return}0!==a.length&&t.push({event:e,listeners:a})}var Kr=/\r\n?/g,Xr=/\u0000|\uFFFD/g;function Yr(t){return("string"===typeof t?t:""+t).replace(Kr,"\n").replace(Xr,"")}function Jr(t,e,i){if(e=Yr(e),Yr(t)!==e&&i)throw Error(n(425))}function Zr(){}var ts=null,es=null;function is(t,e){return"textarea"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var rs="function"===typeof setTimeout?setTimeout:void 0,ss="function"===typeof clearTimeout?clearTimeout:void 0,ns="function"===typeof Promise?Promise:void 0,as="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ns?function(t){return ns.resolve(null).then(t).catch(os)}:rs;function os(t){setTimeout((function(){throw t}))}function ls(t,e){var i=e,r=0;do{var s=i.nextSibling;if(t.removeChild(i),s&&8===s.nodeType)if("/$"===(i=s.data)){if(0===r)return t.removeChild(s),void Be(e);r--}else"$"!==i&&"$?"!==i&&"$!"!==i||r++;i=s}while(i);Be(e)}function us(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break;if(8===e){if("$"===(e=t.data)||"$!"===e||"$?"===e)break;if("/$"===e)return null}}return t}function hs(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var i=t.data;if("$"===i||"$!"===i||"$?"===i){if(0===e)return t;e--}else"/$"===i&&e++}t=t.previousSibling}return null}var cs=Math.random().toString(36).slice(2),ds="__reactFiber$"+cs,_s="__reactProps$"+cs,ps="__reactContainer$"+cs,fs="__reactEvents$"+cs,ms="__reactListeners$"+cs,gs="__reactHandles$"+cs;function ys(t){var e=t[ds];if(e)return e;for(var i=t.parentNode;i;){if(e=i[ps]||i[ds]){if(i=e.alternate,null!==e.child||null!==i&&null!==i.child)for(t=hs(t);null!==t;){if(i=t[ds])return i;t=hs(t)}return e}i=(t=i).parentNode}return null}function bs(t){return!(t=t[ds]||t[ps])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function vs(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(n(33))}function ws(t){return t[_s]||null}var ks=[],xs=-1;function Cs(t){return{current:t}}function Ss(t){0>xs||(t.current=ks[xs],ks[xs]=null,xs--)}function As(t,e){xs++,ks[xs]=t.current,t.current=e}var Es={},zs=Cs(Es),Is=Cs(!1),Ps=Es;function qs(t,e){var i=t.type.contextTypes;if(!i)return Es;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s,n={};for(s in i)n[s]=e[s];return r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=n),n}function Os(t){return null!==(t=t.childContextTypes)&&void 0!==t}function Ls(){Ss(Is),Ss(zs)}function Ts(t,e,i){if(zs.current!==Es)throw Error(n(168));As(zs,e),As(Is,i)}function Rs(t,e,i){var r=t.stateNode;if(e=e.childContextTypes,"function"!==typeof r.getChildContext)return i;for(var s in r=r.getChildContext())if(!(s in e))throw Error(n(108,G(t)||"Unknown",s));return D({},i,r)}function Ns(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Es,Ps=zs.current,As(zs,t),As(Is,Is.current),!0}function Us(t,e,i){var r=t.stateNode;if(!r)throw Error(n(169));i?(t=Rs(t,e,Ps),r.__reactInternalMemoizedMergedChildContext=t,Ss(Is),Ss(zs),As(zs,t)):Ss(Is),As(Is,i)}var Ds=null,Ms=!1,Fs=!1;function js(t){null===Ds?Ds=[t]:Ds.push(t)}function Vs(){if(!Fs&&null!==Ds){Fs=!0;var t=0,e=ve;try{var i=Ds;for(ve=1;t<i.length;t++){var r=i[t];do{r=r(!0)}while(null!==r)}Ds=null,Ms=!1}catch(s){throw null!==Ds&&(Ds=Ds.slice(t+1)),Qt(te,Vs),s}finally{ve=e,Fs=!1}}return null}var Bs=[],Gs=0,Ws=null,Hs=0,$s=[],Qs=0,Ks=null,Xs=1,Ys="";function Js(t,e){Bs[Gs++]=Hs,Bs[Gs++]=Ws,Ws=t,Hs=e}function Zs(t,e,i){$s[Qs++]=Xs,$s[Qs++]=Ys,$s[Qs++]=Ks,Ks=t;var r=Xs;t=Ys;var s=32-oe(r)-1;r&=~(1<<s),i+=1;var n=32-oe(e)+s;if(30<n){var a=s-s%5;n=(r&(1<<a)-1).toString(32),r>>=a,s-=a,Xs=1<<32-oe(e)+s|i<<s|r,Ys=n+t}else Xs=1<<n|i<<s|r,Ys=t}function tn(t){null!==t.return&&(Js(t,1),Zs(t,1,0))}function en(t){for(;t===Ws;)Ws=Bs[--Gs],Bs[Gs]=null,Hs=Bs[--Gs],Bs[Gs]=null;for(;t===Ks;)Ks=$s[--Qs],$s[Qs]=null,Ys=$s[--Qs],$s[Qs]=null,Xs=$s[--Qs],$s[Qs]=null}var rn=null,sn=null,nn=!1,an=null;function on(t,e){var i=Ou(5,null,null,0);i.elementType="DELETED",i.stateNode=e,i.return=t,null===(e=t.deletions)?(t.deletions=[i],t.flags|=16):e.push(i)}function ln(t,e){switch(t.tag){case 5:var i=t.type;return null!==(e=1!==e.nodeType||i.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,rn=t,sn=us(e.firstChild),!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,rn=t,sn=null,!0);case 13:return null!==(e=8!==e.nodeType?null:e)&&(i=null!==Ks?{id:Xs,overflow:Ys}:null,t.memoizedState={dehydrated:e,treeContext:i,retryLane:1073741824},(i=Ou(18,null,null,0)).stateNode=e,i.return=t,t.child=i,rn=t,sn=null,!0);default:return!1}}function un(t){return 0!==(1&t.mode)&&0===(128&t.flags)}function hn(t){if(nn){var e=sn;if(e){var i=e;if(!ln(t,e)){if(un(t))throw Error(n(418));e=us(i.nextSibling);var r=rn;e&&ln(t,e)?on(r,i):(t.flags=-4097&t.flags|2,nn=!1,rn=t)}}else{if(un(t))throw Error(n(418));t.flags=-4097&t.flags|2,nn=!1,rn=t}}}function cn(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;rn=t}function dn(t){if(t!==rn)return!1;if(!nn)return cn(t),nn=!0,!1;var e;if((e=3!==t.tag)&&!(e=5!==t.tag)&&(e="head"!==(e=t.type)&&"body"!==e&&!is(t.type,t.memoizedProps)),e&&(e=sn)){if(un(t))throw _n(),Error(n(418));for(;e;)on(t,e),e=us(e.nextSibling)}if(cn(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(n(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var i=t.data;if("/$"===i){if(0===e){sn=us(t.nextSibling);break t}e--}else"$"!==i&&"$!"!==i&&"$?"!==i||e++}t=t.nextSibling}sn=null}}else sn=rn?us(t.stateNode.nextSibling):null;return!0}function _n(){for(var t=sn;t;)t=us(t.nextSibling)}function pn(){sn=rn=null,nn=!1}function fn(t){null===an?an=[t]:an.push(t)}var mn=w.ReactCurrentBatchConfig;function gn(t,e,i){if(null!==(t=i.ref)&&"function"!==typeof t&&"object"!==typeof t){if(i._owner){if(i=i._owner){if(1!==i.tag)throw Error(n(309));var r=i.stateNode}if(!r)throw Error(n(147,t));var s=r,a=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===a?e.ref:(e=function(t){var e=s.refs;null===t?delete e[a]:e[a]=t},e._stringRef=a,e)}if("string"!==typeof t)throw Error(n(284));if(!i._owner)throw Error(n(290,t))}return t}function yn(t,e){throw t=Object.prototype.toString.call(e),Error(n(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function bn(t){return(0,t._init)(t._payload)}function vn(t){function e(e,i){if(t){var r=e.deletions;null===r?(e.deletions=[i],e.flags|=16):r.push(i)}}function i(i,r){if(!t)return null;for(;null!==r;)e(i,r),r=r.sibling;return null}function r(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function s(t,e){return(t=Tu(t,e)).index=0,t.sibling=null,t}function a(e,i,r){return e.index=r,t?null!==(r=e.alternate)?(r=r.index)<i?(e.flags|=2,i):r:(e.flags|=2,i):(e.flags|=1048576,i)}function o(e){return t&&null===e.alternate&&(e.flags|=2),e}function l(t,e,i,r){return null===e||6!==e.tag?((e=Du(i,t.mode,r)).return=t,e):((e=s(e,i)).return=t,e)}function u(t,e,i,r){var n=i.type;return n===C?c(t,e,i.props.children,r,i.key):null!==e&&(e.elementType===n||"object"===typeof n&&null!==n&&n.$$typeof===L&&bn(n)===e.type)?((r=s(e,i.props)).ref=gn(t,e,i),r.return=t,r):((r=Ru(i.type,i.key,i.props,null,t.mode,r)).ref=gn(t,e,i),r.return=t,r)}function h(t,e,i,r){return null===e||4!==e.tag||e.stateNode.containerInfo!==i.containerInfo||e.stateNode.implementation!==i.implementation?((e=Mu(i,t.mode,r)).return=t,e):((e=s(e,i.children||[])).return=t,e)}function c(t,e,i,r,n){return null===e||7!==e.tag?((e=Nu(i,t.mode,r,n)).return=t,e):((e=s(e,i)).return=t,e)}function d(t,e,i){if("string"===typeof e&&""!==e||"number"===typeof e)return(e=Du(""+e,t.mode,i)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case k:return(i=Ru(e.type,e.key,e.props,null,t.mode,i)).ref=gn(t,null,e),i.return=t,i;case x:return(e=Mu(e,t.mode,i)).return=t,e;case L:return d(t,(0,e._init)(e._payload),i)}if(it(e)||N(e))return(e=Nu(e,t.mode,i,null)).return=t,e;yn(t,e)}return null}function _(t,e,i,r){var s=null!==e?e.key:null;if("string"===typeof i&&""!==i||"number"===typeof i)return null!==s?null:l(t,e,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case k:return i.key===s?u(t,e,i,r):null;case x:return i.key===s?h(t,e,i,r):null;case L:return _(t,e,(s=i._init)(i._payload),r)}if(it(i)||N(i))return null!==s?null:c(t,e,i,r,null);yn(t,i)}return null}function p(t,e,i,r,s){if("string"===typeof r&&""!==r||"number"===typeof r)return l(e,t=t.get(i)||null,""+r,s);if("object"===typeof r&&null!==r){switch(r.$$typeof){case k:return u(e,t=t.get(null===r.key?i:r.key)||null,r,s);case x:return h(e,t=t.get(null===r.key?i:r.key)||null,r,s);case L:return p(t,e,i,(0,r._init)(r._payload),s)}if(it(r)||N(r))return c(e,t=t.get(i)||null,r,s,null);yn(e,r)}return null}function f(s,n,o,l){for(var u=null,h=null,c=n,f=n=0,m=null;null!==c&&f<o.length;f++){c.index>f?(m=c,c=null):m=c.sibling;var g=_(s,c,o[f],l);if(null===g){null===c&&(c=m);break}t&&c&&null===g.alternate&&e(s,c),n=a(g,n,f),null===h?u=g:h.sibling=g,h=g,c=m}if(f===o.length)return i(s,c),nn&&Js(s,f),u;if(null===c){for(;f<o.length;f++)null!==(c=d(s,o[f],l))&&(n=a(c,n,f),null===h?u=c:h.sibling=c,h=c);return nn&&Js(s,f),u}for(c=r(s,c);f<o.length;f++)null!==(m=p(c,s,f,o[f],l))&&(t&&null!==m.alternate&&c.delete(null===m.key?f:m.key),n=a(m,n,f),null===h?u=m:h.sibling=m,h=m);return t&&c.forEach((function(t){return e(s,t)})),nn&&Js(s,f),u}function m(s,o,l,u){var h=N(l);if("function"!==typeof h)throw Error(n(150));if(null==(l=h.call(l)))throw Error(n(151));for(var c=h=null,f=o,m=o=0,g=null,y=l.next();null!==f&&!y.done;m++,y=l.next()){f.index>m?(g=f,f=null):g=f.sibling;var b=_(s,f,y.value,u);if(null===b){null===f&&(f=g);break}t&&f&&null===b.alternate&&e(s,f),o=a(b,o,m),null===c?h=b:c.sibling=b,c=b,f=g}if(y.done)return i(s,f),nn&&Js(s,m),h;if(null===f){for(;!y.done;m++,y=l.next())null!==(y=d(s,y.value,u))&&(o=a(y,o,m),null===c?h=y:c.sibling=y,c=y);return nn&&Js(s,m),h}for(f=r(s,f);!y.done;m++,y=l.next())null!==(y=p(f,s,m,y.value,u))&&(t&&null!==y.alternate&&f.delete(null===y.key?m:y.key),o=a(y,o,m),null===c?h=y:c.sibling=y,c=y);return t&&f.forEach((function(t){return e(s,t)})),nn&&Js(s,m),h}return function t(r,n,a,l){if("object"===typeof a&&null!==a&&a.type===C&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case k:t:{for(var u=a.key,h=n;null!==h;){if(h.key===u){if((u=a.type)===C){if(7===h.tag){i(r,h.sibling),(n=s(h,a.props.children)).return=r,r=n;break t}}else if(h.elementType===u||"object"===typeof u&&null!==u&&u.$$typeof===L&&bn(u)===h.type){i(r,h.sibling),(n=s(h,a.props)).ref=gn(r,h,a),n.return=r,r=n;break t}i(r,h);break}e(r,h),h=h.sibling}a.type===C?((n=Nu(a.props.children,r.mode,l,a.key)).return=r,r=n):((l=Ru(a.type,a.key,a.props,null,r.mode,l)).ref=gn(r,n,a),l.return=r,r=l)}return o(r);case x:t:{for(h=a.key;null!==n;){if(n.key===h){if(4===n.tag&&n.stateNode.containerInfo===a.containerInfo&&n.stateNode.implementation===a.implementation){i(r,n.sibling),(n=s(n,a.children||[])).return=r,r=n;break t}i(r,n);break}e(r,n),n=n.sibling}(n=Mu(a,r.mode,l)).return=r,r=n}return o(r);case L:return t(r,n,(h=a._init)(a._payload),l)}if(it(a))return f(r,n,a,l);if(N(a))return m(r,n,a,l);yn(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==n&&6===n.tag?(i(r,n.sibling),(n=s(n,a)).return=r,r=n):(i(r,n),(n=Du(a,r.mode,l)).return=r,r=n),o(r)):i(r,n)}}var wn=vn(!0),kn=vn(!1),xn=Cs(null),Cn=null,Sn=null,An=null;function En(){An=Sn=Cn=null}function zn(t){var e=xn.current;Ss(xn),t._currentValue=e}function In(t,e,i){for(;null!==t;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,null!==r&&(r.childLanes|=e)):null!==r&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===i)break;t=t.return}}function Pn(t,e){Cn=t,An=Sn=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!==(t.lanes&e)&&(vo=!0),t.firstContext=null)}function qn(t){var e=t._currentValue;if(An!==t)if(t={context:t,memoizedValue:e,next:null},null===Sn){if(null===Cn)throw Error(n(308));Sn=t,Cn.dependencies={lanes:0,firstContext:t}}else Sn=Sn.next=t;return e}var On=null;function Ln(t){null===On?On=[t]:On.push(t)}function Tn(t,e,i,r){var s=e.interleaved;return null===s?(i.next=i,Ln(e)):(i.next=s.next,s.next=i),e.interleaved=i,Rn(t,r)}function Rn(t,e){t.lanes|=e;var i=t.alternate;for(null!==i&&(i.lanes|=e),i=t,t=t.return;null!==t;)t.childLanes|=e,null!==(i=t.alternate)&&(i.childLanes|=e),i=t,t=t.return;return 3===i.tag?i.stateNode:null}var Nn=!1;function Un(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Dn(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Mn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Fn(t,e,i){var r=t.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Il)){var s=r.pending;return null===s?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Rn(t,i)}return null===(s=r.interleaved)?(e.next=e,Ln(r)):(e.next=s.next,s.next=e),r.interleaved=e,Rn(t,i)}function jn(t,e,i){if(null!==(e=e.updateQueue)&&(e=e.shared,0!==(4194240&i))){var r=e.lanes;i|=r&=t.pendingLanes,e.lanes=i,be(t,i)}}function Vn(t,e){var i=t.updateQueue,r=t.alternate;if(null!==r&&i===(r=r.updateQueue)){var s=null,n=null;if(null!==(i=i.firstBaseUpdate)){do{var a={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};null===n?s=n=a:n=n.next=a,i=i.next}while(null!==i);null===n?s=n=e:n=n.next=e}else s=n=e;return i={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:n,shared:r.shared,effects:r.effects},void(t.updateQueue=i)}null===(t=i.lastBaseUpdate)?i.firstBaseUpdate=e:t.next=e,i.lastBaseUpdate=e}function Bn(t,e,i,r){var s=t.updateQueue;Nn=!1;var n=s.firstBaseUpdate,a=s.lastBaseUpdate,o=s.shared.pending;if(null!==o){s.shared.pending=null;var l=o,u=l.next;l.next=null,null===a?n=u:a.next=u,a=l;var h=t.alternate;null!==h&&((o=(h=h.updateQueue).lastBaseUpdate)!==a&&(null===o?h.firstBaseUpdate=u:o.next=u,h.lastBaseUpdate=l))}if(null!==n){var c=s.baseState;for(a=0,h=u=l=null,o=n;;){var d=o.lane,_=o.eventTime;if((r&d)===d){null!==h&&(h=h.next={eventTime:_,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});t:{var p=t,f=o;switch(d=e,_=i,f.tag){case 1:if("function"===typeof(p=f.payload)){c=p.call(_,c,d);break t}c=p;break t;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=f.payload)?p.call(_,c,d):p)||void 0===d)break t;c=D({},c,d);break t;case 2:Nn=!0}}null!==o.callback&&0!==o.lane&&(t.flags|=64,null===(d=s.effects)?s.effects=[o]:d.push(o))}else _={eventTime:_,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===h?(u=h=_,l=c):h=h.next=_,a|=d;if(null===(o=o.next)){if(null===(o=s.shared.pending))break;o=(d=o).next,d.next=null,s.lastBaseUpdate=d,s.shared.pending=null}}if(null===h&&(l=c),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=h,null!==(e=s.shared.interleaved)){s=e;do{a|=s.lane,s=s.next}while(s!==e)}else null===n&&(s.shared.lanes=0);Ul|=a,t.lanes=a,t.memoizedState=c}}function Gn(t,e,i){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(null!==s){if(r.callback=null,r=i,"function"!==typeof s)throw Error(n(191,s));s.call(r)}}}var Wn={},Hn=Cs(Wn),$n=Cs(Wn),Qn=Cs(Wn);function Kn(t){if(t===Wn)throw Error(n(174));return t}function Xn(t,e){switch(As(Qn,e),As($n,t),As(Hn,Wn),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ut(null,"");break;default:e=ut(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}Ss(Hn),As(Hn,e)}function Yn(){Ss(Hn),Ss($n),Ss(Qn)}function Jn(t){Kn(Qn.current);var e=Kn(Hn.current),i=ut(e,t.type);e!==i&&(As($n,t),As(Hn,i))}function Zn(t){$n.current===t&&(Ss(Hn),Ss($n))}var ta=Cs(0);function ea(t){for(var e=t;null!==e;){if(13===e.tag){var i=e.memoizedState;if(null!==i&&(null===(i=i.dehydrated)||"$?"===i.data||"$!"===i.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(128&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ia=[];function ra(){for(var t=0;t<ia.length;t++)ia[t]._workInProgressVersionPrimary=null;ia.length=0}var sa=w.ReactCurrentDispatcher,na=w.ReactCurrentBatchConfig,aa=0,oa=null,la=null,ua=null,ha=!1,ca=!1,da=0,_a=0;function pa(){throw Error(n(321))}function fa(t,e){if(null===e)return!1;for(var i=0;i<e.length&&i<t.length;i++)if(!or(t[i],e[i]))return!1;return!0}function ma(t,e,i,r,s,a){if(aa=a,oa=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,sa.current=null===t||null===t.memoizedState?Za:to,t=i(r,s),ca){a=0;do{if(ca=!1,da=0,25<=a)throw Error(n(301));a+=1,ua=la=null,e.updateQueue=null,sa.current=eo,t=i(r,s)}while(ca)}if(sa.current=Ja,e=null!==la&&null!==la.next,aa=0,ua=la=oa=null,ha=!1,e)throw Error(n(300));return t}function ga(){var t=0!==da;return da=0,t}function ya(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ua?oa.memoizedState=ua=t:ua=ua.next=t,ua}function ba(){if(null===la){var t=oa.alternate;t=null!==t?t.memoizedState:null}else t=la.next;var e=null===ua?oa.memoizedState:ua.next;if(null!==e)ua=e,la=t;else{if(null===t)throw Error(n(310));t={memoizedState:(la=t).memoizedState,baseState:la.baseState,baseQueue:la.baseQueue,queue:la.queue,next:null},null===ua?oa.memoizedState=ua=t:ua=ua.next=t}return ua}function va(t,e){return"function"===typeof e?e(t):e}function wa(t){var e=ba(),i=e.queue;if(null===i)throw Error(n(311));i.lastRenderedReducer=t;var r=la,s=r.baseQueue,a=i.pending;if(null!==a){if(null!==s){var o=s.next;s.next=a.next,a.next=o}r.baseQueue=s=a,i.pending=null}if(null!==s){a=s.next,r=r.baseState;var l=o=null,u=null,h=a;do{var c=h.lane;if((aa&c)===c)null!==u&&(u=u.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:t(r,h.action);else{var d={lane:c,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};null===u?(l=u=d,o=r):u=u.next=d,oa.lanes|=c,Ul|=c}h=h.next}while(null!==h&&h!==a);null===u?o=r:u.next=l,or(r,e.memoizedState)||(vo=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,i.lastRenderedState=r}if(null!==(t=i.interleaved)){s=t;do{a=s.lane,oa.lanes|=a,Ul|=a,s=s.next}while(s!==t)}else null===s&&(i.lanes=0);return[e.memoizedState,i.dispatch]}function ka(t){var e=ba(),i=e.queue;if(null===i)throw Error(n(311));i.lastRenderedReducer=t;var r=i.dispatch,s=i.pending,a=e.memoizedState;if(null!==s){i.pending=null;var o=s=s.next;do{a=t(a,o.action),o=o.next}while(o!==s);or(a,e.memoizedState)||(vo=!0),e.memoizedState=a,null===e.baseQueue&&(e.baseState=a),i.lastRenderedState=a}return[a,r]}function xa(){}function Ca(t,e){var i=oa,r=ba(),s=e(),a=!or(r.memoizedState,s);if(a&&(r.memoizedState=s,vo=!0),r=r.queue,Na(Ea.bind(null,i,r,t),[t]),r.getSnapshot!==e||a||null!==ua&&1&ua.memoizedState.tag){if(i.flags|=2048,qa(9,Aa.bind(null,i,r,s,e),void 0,null),null===Pl)throw Error(n(349));0!==(30&aa)||Sa(i,e,s)}return s}function Sa(t,e,i){t.flags|=16384,t={getSnapshot:e,value:i},null===(e=oa.updateQueue)?(e={lastEffect:null,stores:null},oa.updateQueue=e,e.stores=[t]):null===(i=e.stores)?e.stores=[t]:i.push(t)}function Aa(t,e,i,r){e.value=i,e.getSnapshot=r,za(e)&&Ia(t)}function Ea(t,e,i){return i((function(){za(e)&&Ia(t)}))}function za(t){var e=t.getSnapshot;t=t.value;try{var i=e();return!or(t,i)}catch(r){return!0}}function Ia(t){var e=Rn(t,1);null!==e&&ru(e,t,1,-1)}function Pa(t){var e=ya();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:va,lastRenderedState:t},e.queue=t,t=t.dispatch=Qa.bind(null,oa,t),[e.memoizedState,t]}function qa(t,e,i,r){return t={tag:t,create:e,destroy:i,deps:r,next:null},null===(e=oa.updateQueue)?(e={lastEffect:null,stores:null},oa.updateQueue=e,e.lastEffect=t.next=t):null===(i=e.lastEffect)?e.lastEffect=t.next=t:(r=i.next,i.next=t,t.next=r,e.lastEffect=t),t}function Oa(){return ba().memoizedState}function La(t,e,i,r){var s=ya();oa.flags|=t,s.memoizedState=qa(1|e,i,void 0,void 0===r?null:r)}function Ta(t,e,i,r){var s=ba();r=void 0===r?null:r;var n=void 0;if(null!==la){var a=la.memoizedState;if(n=a.destroy,null!==r&&fa(r,a.deps))return void(s.memoizedState=qa(e,i,n,r))}oa.flags|=t,s.memoizedState=qa(1|e,i,n,r)}function Ra(t,e){return La(8390656,8,t,e)}function Na(t,e){return Ta(2048,8,t,e)}function Ua(t,e){return Ta(4,2,t,e)}function Da(t,e){return Ta(4,4,t,e)}function Ma(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function Fa(t,e,i){return i=null!==i&&void 0!==i?i.concat([t]):null,Ta(4,4,Ma.bind(null,e,t),i)}function ja(){}function Va(t,e){var i=ba();e=void 0===e?null:e;var r=i.memoizedState;return null!==r&&null!==e&&fa(e,r[1])?r[0]:(i.memoizedState=[t,e],t)}function Ba(t,e){var i=ba();e=void 0===e?null:e;var r=i.memoizedState;return null!==r&&null!==e&&fa(e,r[1])?r[0]:(t=t(),i.memoizedState=[t,e],t)}function Ga(t,e,i){return 0===(21&aa)?(t.baseState&&(t.baseState=!1,vo=!0),t.memoizedState=i):(or(i,e)||(i=me(),oa.lanes|=i,Ul|=i,t.baseState=!0),e)}function Wa(t,e){var i=ve;ve=0!==i&&4>i?i:4,t(!0);var r=na.transition;na.transition={};try{t(!1),e()}finally{ve=i,na.transition=r}}function Ha(){return ba().memoizedState}function $a(t,e,i){var r=iu(t);if(i={lane:r,action:i,hasEagerState:!1,eagerState:null,next:null},Ka(t))Xa(e,i);else if(null!==(i=Tn(t,e,i,r))){ru(i,t,r,eu()),Ya(i,e,r)}}function Qa(t,e,i){var r=iu(t),s={lane:r,action:i,hasEagerState:!1,eagerState:null,next:null};if(Ka(t))Xa(e,s);else{var n=t.alternate;if(0===t.lanes&&(null===n||0===n.lanes)&&null!==(n=e.lastRenderedReducer))try{var a=e.lastRenderedState,o=n(a,i);if(s.hasEagerState=!0,s.eagerState=o,or(o,a)){var l=e.interleaved;return null===l?(s.next=s,Ln(e)):(s.next=l.next,l.next=s),void(e.interleaved=s)}}catch(u){}null!==(i=Tn(t,e,s,r))&&(ru(i,t,r,s=eu()),Ya(i,e,r))}}function Ka(t){var e=t.alternate;return t===oa||null!==e&&e===oa}function Xa(t,e){ca=ha=!0;var i=t.pending;null===i?e.next=e:(e.next=i.next,i.next=e),t.pending=e}function Ya(t,e,i){if(0!==(4194240&i)){var r=e.lanes;i|=r&=t.pendingLanes,e.lanes=i,be(t,i)}}var Ja={readContext:qn,useCallback:pa,useContext:pa,useEffect:pa,useImperativeHandle:pa,useInsertionEffect:pa,useLayoutEffect:pa,useMemo:pa,useReducer:pa,useRef:pa,useState:pa,useDebugValue:pa,useDeferredValue:pa,useTransition:pa,useMutableSource:pa,useSyncExternalStore:pa,useId:pa,unstable_isNewReconciler:!1},Za={readContext:qn,useCallback:function(t,e){return ya().memoizedState=[t,void 0===e?null:e],t},useContext:qn,useEffect:Ra,useImperativeHandle:function(t,e,i){return i=null!==i&&void 0!==i?i.concat([t]):null,La(4194308,4,Ma.bind(null,e,t),i)},useLayoutEffect:function(t,e){return La(4194308,4,t,e)},useInsertionEffect:function(t,e){return La(4,2,t,e)},useMemo:function(t,e){var i=ya();return e=void 0===e?null:e,t=t(),i.memoizedState=[t,e],t},useReducer:function(t,e,i){var r=ya();return e=void 0!==i?i(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=$a.bind(null,oa,t),[r.memoizedState,t]},useRef:function(t){return t={current:t},ya().memoizedState=t},useState:Pa,useDebugValue:ja,useDeferredValue:function(t){return ya().memoizedState=t},useTransition:function(){var t=Pa(!1),e=t[0];return t=Wa.bind(null,t[1]),ya().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,i){var r=oa,s=ya();if(nn){if(void 0===i)throw Error(n(407));i=i()}else{if(i=e(),null===Pl)throw Error(n(349));0!==(30&aa)||Sa(r,e,i)}s.memoizedState=i;var a={value:i,getSnapshot:e};return s.queue=a,Ra(Ea.bind(null,r,a,t),[t]),r.flags|=2048,qa(9,Aa.bind(null,r,a,i,e),void 0,null),i},useId:function(){var t=ya(),e=Pl.identifierPrefix;if(nn){var i=Ys;e=":"+e+"R"+(i=(Xs&~(1<<32-oe(Xs)-1)).toString(32)+i),0<(i=da++)&&(e+="H"+i.toString(32)),e+=":"}else e=":"+e+"r"+(i=_a++).toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},to={readContext:qn,useCallback:Va,useContext:qn,useEffect:Na,useImperativeHandle:Fa,useInsertionEffect:Ua,useLayoutEffect:Da,useMemo:Ba,useReducer:wa,useRef:Oa,useState:function(){return wa(va)},useDebugValue:ja,useDeferredValue:function(t){return Ga(ba(),la.memoizedState,t)},useTransition:function(){return[wa(va)[0],ba().memoizedState]},useMutableSource:xa,useSyncExternalStore:Ca,useId:Ha,unstable_isNewReconciler:!1},eo={readContext:qn,useCallback:Va,useContext:qn,useEffect:Na,useImperativeHandle:Fa,useInsertionEffect:Ua,useLayoutEffect:Da,useMemo:Ba,useReducer:ka,useRef:Oa,useState:function(){return ka(va)},useDebugValue:ja,useDeferredValue:function(t){var e=ba();return null===la?e.memoizedState=t:Ga(e,la.memoizedState,t)},useTransition:function(){return[ka(va)[0],ba().memoizedState]},useMutableSource:xa,useSyncExternalStore:Ca,useId:Ha,unstable_isNewReconciler:!1};function io(t,e){if(t&&t.defaultProps){for(var i in e=D({},e),t=t.defaultProps)void 0===e[i]&&(e[i]=t[i]);return e}return e}function ro(t,e,i,r){i=null===(i=i(r,e=t.memoizedState))||void 0===i?e:D({},e,i),t.memoizedState=i,0===t.lanes&&(t.updateQueue.baseState=i)}var so={isMounted:function(t){return!!(t=t._reactInternals)&&Bt(t)===t},enqueueSetState:function(t,e,i){t=t._reactInternals;var r=eu(),s=iu(t),n=Mn(r,s);n.payload=e,void 0!==i&&null!==i&&(n.callback=i),null!==(e=Fn(t,n,s))&&(ru(e,t,s,r),jn(e,t,s))},enqueueReplaceState:function(t,e,i){t=t._reactInternals;var r=eu(),s=iu(t),n=Mn(r,s);n.tag=1,n.payload=e,void 0!==i&&null!==i&&(n.callback=i),null!==(e=Fn(t,n,s))&&(ru(e,t,s,r),jn(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var i=eu(),r=iu(t),s=Mn(i,r);s.tag=2,void 0!==e&&null!==e&&(s.callback=e),null!==(e=Fn(t,s,r))&&(ru(e,t,r,i),jn(e,t,r))}};function no(t,e,i,r,s,n,a){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(r,n,a):!e.prototype||!e.prototype.isPureReactComponent||(!lr(i,r)||!lr(s,n))}function ao(t,e,i){var r=!1,s=Es,n=e.contextType;return"object"===typeof n&&null!==n?n=qn(n):(s=Os(e)?Ps:zs.current,n=(r=null!==(r=e.contextTypes)&&void 0!==r)?qs(t,s):Es),e=new e(i,n),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=so,t.stateNode=e,e._reactInternals=t,r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=n),e}function oo(t,e,i,r){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(i,r),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(i,r),e.state!==t&&so.enqueueReplaceState(e,e.state,null)}function lo(t,e,i,r){var s=t.stateNode;s.props=i,s.state=t.memoizedState,s.refs={},Un(t);var n=e.contextType;"object"===typeof n&&null!==n?s.context=qn(n):(n=Os(e)?Ps:zs.current,s.context=qs(t,n)),s.state=t.memoizedState,"function"===typeof(n=e.getDerivedStateFromProps)&&(ro(t,e,n,i),s.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(e=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),e!==s.state&&so.enqueueReplaceState(s,s.state,null),Bn(t,i,s,r),s.state=t.memoizedState),"function"===typeof s.componentDidMount&&(t.flags|=4194308)}function uo(t,e){try{var i="",r=e;do{i+=V(r),r=r.return}while(r);var s=i}catch(n){s="\nError generating stack: "+n.message+"\n"+n.stack}return{value:t,source:e,stack:s,digest:null}}function ho(t,e,i){return{value:t,source:null,stack:null!=i?i:null,digest:null!=e?e:null}}function co(t,e){try{console.error(e.value)}catch(i){setTimeout((function(){throw i}))}}var _o="function"===typeof WeakMap?WeakMap:Map;function po(t,e,i){(i=Mn(-1,i)).tag=3,i.payload={element:null};var r=e.value;return i.callback=function(){Wl||(Wl=!0,Hl=r),co(0,e)},i}function fo(t,e,i){(i=Mn(-1,i)).tag=3;var r=t.type.getDerivedStateFromError;if("function"===typeof r){var s=e.value;i.payload=function(){return r(s)},i.callback=function(){co(0,e)}}var n=t.stateNode;return null!==n&&"function"===typeof n.componentDidCatch&&(i.callback=function(){co(0,e),"function"!==typeof r&&(null===$l?$l=new Set([this]):$l.add(this));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),i}function mo(t,e,i){var r=t.pingCache;if(null===r){r=t.pingCache=new _o;var s=new Set;r.set(e,s)}else void 0===(s=r.get(e))&&(s=new Set,r.set(e,s));s.has(i)||(s.add(i),t=Au.bind(null,t,e,i),e.then(t,t))}function go(t){do{var e;if((e=13===t.tag)&&(e=null===(e=t.memoizedState)||null!==e.dehydrated),e)return t;t=t.return}while(null!==t);return null}function yo(t,e,i,r,s){return 0===(1&t.mode)?(t===e?t.flags|=65536:(t.flags|=128,i.flags|=131072,i.flags&=-52805,1===i.tag&&(null===i.alternate?i.tag=17:((e=Mn(-1,1)).tag=2,Fn(i,e,1))),i.lanes|=1),t):(t.flags|=65536,t.lanes=s,t)}var bo=w.ReactCurrentOwner,vo=!1;function wo(t,e,i,r){e.child=null===t?kn(e,null,i,r):wn(e,t.child,i,r)}function ko(t,e,i,r,s){i=i.render;var n=e.ref;return Pn(e,s),r=ma(t,e,i,r,n,s),i=ga(),null===t||vo?(nn&&i&&tn(e),e.flags|=1,wo(t,e,r,s),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Wo(t,e,s))}function xo(t,e,i,r,s){if(null===t){var n=i.type;return"function"!==typeof n||Lu(n)||void 0!==n.defaultProps||null!==i.compare||void 0!==i.defaultProps?((t=Ru(i.type,null,r,e,e.mode,s)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=n,Co(t,e,n,r,s))}if(n=t.child,0===(t.lanes&s)){var a=n.memoizedProps;if((i=null!==(i=i.compare)?i:lr)(a,r)&&t.ref===e.ref)return Wo(t,e,s)}return e.flags|=1,(t=Tu(n,r)).ref=e.ref,t.return=e,e.child=t}function Co(t,e,i,r,s){if(null!==t){var n=t.memoizedProps;if(lr(n,r)&&t.ref===e.ref){if(vo=!1,e.pendingProps=r=n,0===(t.lanes&s))return e.lanes=t.lanes,Wo(t,e,s);0!==(131072&t.flags)&&(vo=!0)}}return Eo(t,e,i,r,s)}function So(t,e,i){var r=e.pendingProps,s=r.children,n=null!==t?t.memoizedState:null;if("hidden"===r.mode)if(0===(1&e.mode))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},As(Tl,Ll),Ll|=i;else{if(0===(1073741824&i))return t=null!==n?n.baseLanes|i:i,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,As(Tl,Ll),Ll|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==n?n.baseLanes:i,As(Tl,Ll),Ll|=r}else null!==n?(r=n.baseLanes|i,e.memoizedState=null):r=i,As(Tl,Ll),Ll|=r;return wo(t,e,s,i),e.child}function Ao(t,e){var i=e.ref;(null===t&&null!==i||null!==t&&t.ref!==i)&&(e.flags|=512,e.flags|=2097152)}function Eo(t,e,i,r,s){var n=Os(i)?Ps:zs.current;return n=qs(e,n),Pn(e,s),i=ma(t,e,i,r,n,s),r=ga(),null===t||vo?(nn&&r&&tn(e),e.flags|=1,wo(t,e,i,s),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Wo(t,e,s))}function zo(t,e,i,r,s){if(Os(i)){var n=!0;Ns(e)}else n=!1;if(Pn(e,s),null===e.stateNode)Go(t,e),ao(e,i,r),lo(e,i,r,s),r=!0;else if(null===t){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=i.contextType;"object"===typeof u&&null!==u?u=qn(u):u=qs(e,u=Os(i)?Ps:zs.current);var h=i.getDerivedStateFromProps,c="function"===typeof h||"function"===typeof a.getSnapshotBeforeUpdate;c||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==r||l!==u)&&oo(e,a,r,u),Nn=!1;var d=e.memoizedState;a.state=d,Bn(e,r,a,s),l=e.memoizedState,o!==r||d!==l||Is.current||Nn?("function"===typeof h&&(ro(e,i,h,r),l=e.memoizedState),(o=Nn||no(e,i,o,r,d,l,u))?(c||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(e.flags|=4194308)):("function"===typeof a.componentDidMount&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),a.props=r,a.state=l,a.context=u,r=o):("function"===typeof a.componentDidMount&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,Dn(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:io(e.type,o),a.props=u,c=e.pendingProps,d=a.context,"object"===typeof(l=i.contextType)&&null!==l?l=qn(l):l=qs(e,l=Os(i)?Ps:zs.current);var _=i.getDerivedStateFromProps;(h="function"===typeof _||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==c||d!==l)&&oo(e,a,r,l),Nn=!1,d=e.memoizedState,a.state=d,Bn(e,r,a,s);var p=e.memoizedState;o!==c||d!==p||Is.current||Nn?("function"===typeof _&&(ro(e,i,_,r),p=e.memoizedState),(u=Nn||no(e,i,u,r,d,p,l)||!1)?(h||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,p,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof a.componentDidUpdate&&(e.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(e.flags|=1024)):("function"!==typeof a.componentDidUpdate||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),a.props=r,a.state=p,a.context=l,r=u):("function"!==typeof a.componentDidUpdate||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),r=!1)}return Io(t,e,i,r,n,s)}function Io(t,e,i,r,s,n){Ao(t,e);var a=0!==(128&e.flags);if(!r&&!a)return s&&Us(e,i,!1),Wo(t,e,n);r=e.stateNode,bo.current=e;var o=a&&"function"!==typeof i.getDerivedStateFromError?null:r.render();return e.flags|=1,null!==t&&a?(e.child=wn(e,t.child,null,n),e.child=wn(e,null,o,n)):wo(t,e,o,n),e.memoizedState=r.state,s&&Us(e,i,!0),e.child}function Po(t){var e=t.stateNode;e.pendingContext?Ts(0,e.pendingContext,e.pendingContext!==e.context):e.context&&Ts(0,e.context,!1),Xn(t,e.containerInfo)}function qo(t,e,i,r,s){return pn(),fn(s),e.flags|=256,wo(t,e,i,r),e.child}var Oo,Lo,To,Ro,No={dehydrated:null,treeContext:null,retryLane:0};function Uo(t){return{baseLanes:t,cachePool:null,transitions:null}}function Do(t,e,i){var r,s=e.pendingProps,a=ta.current,o=!1,l=0!==(128&e.flags);if((r=l)||(r=(null===t||null!==t.memoizedState)&&0!==(2&a)),r?(o=!0,e.flags&=-129):null!==t&&null===t.memoizedState||(a|=1),As(ta,1&a),null===t)return hn(e),null!==(t=e.memoizedState)&&null!==(t=t.dehydrated)?(0===(1&e.mode)?e.lanes=1:"$!"===t.data?e.lanes=8:e.lanes=1073741824,null):(l=s.children,t=s.fallback,o?(s=e.mode,o=e.child,l={mode:"hidden",children:l},0===(1&s)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Uu(l,s,0,null),t=Nu(t,s,i,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Uo(i),e.memoizedState=No,t):Mo(e,l));if(null!==(a=t.memoizedState)&&null!==(r=a.dehydrated))return function(t,e,i,r,s,a,o){if(i)return 256&e.flags?(e.flags&=-257,Fo(t,e,o,r=ho(Error(n(422))))):null!==e.memoizedState?(e.child=t.child,e.flags|=128,null):(a=r.fallback,s=e.mode,r=Uu({mode:"visible",children:r.children},s,0,null),(a=Nu(a,s,o,null)).flags|=2,r.return=e,a.return=e,r.sibling=a,e.child=r,0!==(1&e.mode)&&wn(e,t.child,null,o),e.child.memoizedState=Uo(o),e.memoizedState=No,a);if(0===(1&e.mode))return Fo(t,e,o,null);if("$!"===s.data){if(r=s.nextSibling&&s.nextSibling.dataset)var l=r.dgst;return r=l,Fo(t,e,o,r=ho(a=Error(n(419)),r,void 0))}if(l=0!==(o&t.childLanes),vo||l){if(null!==(r=Pl)){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}0!==(s=0!==(s&(r.suspendedLanes|o))?0:s)&&s!==a.retryLane&&(a.retryLane=s,Rn(t,s),ru(r,t,s,-1))}return mu(),Fo(t,e,o,r=ho(Error(n(421))))}return"$?"===s.data?(e.flags|=128,e.child=t.child,e=zu.bind(null,t),s._reactRetry=e,null):(t=a.treeContext,sn=us(s.nextSibling),rn=e,nn=!0,an=null,null!==t&&($s[Qs++]=Xs,$s[Qs++]=Ys,$s[Qs++]=Ks,Xs=t.id,Ys=t.overflow,Ks=e),e=Mo(e,r.children),e.flags|=4096,e)}(t,e,l,s,r,a,i);if(o){o=s.fallback,l=e.mode,r=(a=t.child).sibling;var u={mode:"hidden",children:s.children};return 0===(1&l)&&e.child!==a?((s=e.child).childLanes=0,s.pendingProps=u,e.deletions=null):(s=Tu(a,u)).subtreeFlags=14680064&a.subtreeFlags,null!==r?o=Tu(r,o):(o=Nu(o,l,i,null)).flags|=2,o.return=e,s.return=e,s.sibling=o,e.child=s,s=o,o=e.child,l=null===(l=t.child.memoizedState)?Uo(i):{baseLanes:l.baseLanes|i,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=t.childLanes&~i,e.memoizedState=No,s}return t=(o=t.child).sibling,s=Tu(o,{mode:"visible",children:s.children}),0===(1&e.mode)&&(s.lanes=i),s.return=e,s.sibling=null,null!==t&&(null===(i=e.deletions)?(e.deletions=[t],e.flags|=16):i.push(t)),e.child=s,e.memoizedState=null,s}function Mo(t,e){return(e=Uu({mode:"visible",children:e},t.mode,0,null)).return=t,t.child=e}function Fo(t,e,i,r){return null!==r&&fn(r),wn(e,t.child,null,i),(t=Mo(e,e.pendingProps.children)).flags|=2,e.memoizedState=null,t}function jo(t,e,i){t.lanes|=e;var r=t.alternate;null!==r&&(r.lanes|=e),In(t.return,e,i)}function Vo(t,e,i,r,s){var n=t.memoizedState;null===n?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:i,tailMode:s}:(n.isBackwards=e,n.rendering=null,n.renderingStartTime=0,n.last=r,n.tail=i,n.tailMode=s)}function Bo(t,e,i){var r=e.pendingProps,s=r.revealOrder,n=r.tail;if(wo(t,e,r.children,i),0!==(2&(r=ta.current)))r=1&r|2,e.flags|=128;else{if(null!==t&&0!==(128&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&jo(t,i,e);else if(19===t.tag)jo(t,i,e);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(As(ta,r),0===(1&e.mode))e.memoizedState=null;else switch(s){case"forwards":for(i=e.child,s=null;null!==i;)null!==(t=i.alternate)&&null===ea(t)&&(s=i),i=i.sibling;null===(i=s)?(s=e.child,e.child=null):(s=i.sibling,i.sibling=null),Vo(e,!1,s,i,n);break;case"backwards":for(i=null,s=e.child,e.child=null;null!==s;){if(null!==(t=s.alternate)&&null===ea(t)){e.child=s;break}t=s.sibling,s.sibling=i,i=s,s=t}Vo(e,!0,i,null,n);break;case"together":Vo(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Go(t,e){0===(1&e.mode)&&null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Wo(t,e,i){if(null!==t&&(e.dependencies=t.dependencies),Ul|=e.lanes,0===(i&e.childLanes))return null;if(null!==t&&e.child!==t.child)throw Error(n(153));if(null!==e.child){for(i=Tu(t=e.child,t.pendingProps),e.child=i,i.return=e;null!==t.sibling;)t=t.sibling,(i=i.sibling=Tu(t,t.pendingProps)).return=e;i.sibling=null}return e.child}function Ho(t,e){if(!nn)switch(t.tailMode){case"hidden":e=t.tail;for(var i=null;null!==e;)null!==e.alternate&&(i=e),e=e.sibling;null===i?t.tail=null:i.sibling=null;break;case"collapsed":i=t.tail;for(var r=null;null!==i;)null!==i.alternate&&(r=i),i=i.sibling;null===r?e||null===t.tail?t.tail=null:t.tail.sibling=null:r.sibling=null}}function $o(t){var e=null!==t.alternate&&t.alternate.child===t.child,i=0,r=0;if(e)for(var s=t.child;null!==s;)i|=s.lanes|s.childLanes,r|=14680064&s.subtreeFlags,r|=14680064&s.flags,s.return=t,s=s.sibling;else for(s=t.child;null!==s;)i|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=i,e}function Qo(t,e,i){var r=e.pendingProps;switch(en(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $o(e),null;case 1:case 17:return Os(e.type)&&Ls(),$o(e),null;case 3:return r=e.stateNode,Yn(),Ss(Is),Ss(zs),ra(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==t&&null!==t.child||(dn(e)?e.flags|=4:null===t||t.memoizedState.isDehydrated&&0===(256&e.flags)||(e.flags|=1024,null!==an&&(ou(an),an=null))),Lo(t,e),$o(e),null;case 5:Zn(e);var s=Kn(Qn.current);if(i=e.type,null!==t&&null!=e.stateNode)To(t,e,i,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(null===e.stateNode)throw Error(n(166));return $o(e),null}if(t=Kn(Hn.current),dn(e)){r=e.stateNode,i=e.type;var a=e.memoizedProps;switch(r[ds]=e,r[_s]=a,t=0!==(1&e.mode),i){case"dialog":Mr("cancel",r),Mr("close",r);break;case"iframe":case"object":case"embed":Mr("load",r);break;case"video":case"audio":for(s=0;s<Rr.length;s++)Mr(Rr[s],r);break;case"source":Mr("error",r);break;case"img":case"image":case"link":Mr("error",r),Mr("load",r);break;case"details":Mr("toggle",r);break;case"input":Y(r,a),Mr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Mr("invalid",r);break;case"textarea":nt(r,a),Mr("invalid",r)}for(var l in bt(i,a),s=null,a)if(a.hasOwnProperty(l)){var u=a[l];"children"===l?"string"===typeof u?r.textContent!==u&&(!0!==a.suppressHydrationWarning&&Jr(r.textContent,u,t),s=["children",u]):"number"===typeof u&&r.textContent!==""+u&&(!0!==a.suppressHydrationWarning&&Jr(r.textContent,u,t),s=["children",""+u]):o.hasOwnProperty(l)&&null!=u&&"onScroll"===l&&Mr("scroll",r)}switch(i){case"input":$(r),tt(r,a,!0);break;case"textarea":$(r),ot(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=Zr)}r=s,e.updateQueue=r,null!==r&&(e.flags|=4)}else{l=9===s.nodeType?s:s.ownerDocument,"http://www.w3.org/1999/xhtml"===t&&(t=lt(i)),"http://www.w3.org/1999/xhtml"===t?"script"===i?((t=l.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"===typeof r.is?t=l.createElement(i,{is:r.is}):(t=l.createElement(i),"select"===i&&(l=t,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):t=l.createElementNS(t,i),t[ds]=e,t[_s]=r,Oo(t,e,!1,!1),e.stateNode=t;t:{switch(l=vt(i,r),i){case"dialog":Mr("cancel",t),Mr("close",t),s=r;break;case"iframe":case"object":case"embed":Mr("load",t),s=r;break;case"video":case"audio":for(s=0;s<Rr.length;s++)Mr(Rr[s],t);s=r;break;case"source":Mr("error",t),s=r;break;case"img":case"image":case"link":Mr("error",t),Mr("load",t),s=r;break;case"details":Mr("toggle",t),s=r;break;case"input":Y(t,r),s=X(t,r),Mr("invalid",t);break;case"option":default:s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=D({},r,{value:void 0}),Mr("invalid",t);break;case"textarea":nt(t,r),s=st(t,r),Mr("invalid",t)}for(a in bt(i,s),u=s)if(u.hasOwnProperty(a)){var h=u[a];"style"===a?gt(t,h):"dangerouslySetInnerHTML"===a?null!=(h=h?h.__html:void 0)&&dt(t,h):"children"===a?"string"===typeof h?("textarea"!==i||""!==h)&&_t(t,h):"number"===typeof h&&_t(t,""+h):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(o.hasOwnProperty(a)?null!=h&&"onScroll"===a&&Mr("scroll",t):null!=h&&v(t,a,h,l))}switch(i){case"input":$(t),tt(t,r,!1);break;case"textarea":$(t),ot(t);break;case"option":null!=r.value&&t.setAttribute("value",""+W(r.value));break;case"select":t.multiple=!!r.multiple,null!=(a=r.value)?rt(t,!!r.multiple,a,!1):null!=r.defaultValue&&rt(t,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof s.onClick&&(t.onclick=Zr)}switch(i){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break t;case"img":r=!0;break t;default:r=!1}}r&&(e.flags|=4)}null!==e.ref&&(e.flags|=512,e.flags|=2097152)}return $o(e),null;case 6:if(t&&null!=e.stateNode)Ro(t,e,t.memoizedProps,r);else{if("string"!==typeof r&&null===e.stateNode)throw Error(n(166));if(i=Kn(Qn.current),Kn(Hn.current),dn(e)){if(r=e.stateNode,i=e.memoizedProps,r[ds]=e,(a=r.nodeValue!==i)&&null!==(t=rn))switch(t.tag){case 3:Jr(r.nodeValue,i,0!==(1&t.mode));break;case 5:!0!==t.memoizedProps.suppressHydrationWarning&&Jr(r.nodeValue,i,0!==(1&t.mode))}a&&(e.flags|=4)}else(r=(9===i.nodeType?i:i.ownerDocument).createTextNode(r))[ds]=e,e.stateNode=r}return $o(e),null;case 13:if(Ss(ta),r=e.memoizedState,null===t||null!==t.memoizedState&&null!==t.memoizedState.dehydrated){if(nn&&null!==sn&&0!==(1&e.mode)&&0===(128&e.flags))_n(),pn(),e.flags|=98560,a=!1;else if(a=dn(e),null!==r&&null!==r.dehydrated){if(null===t){if(!a)throw Error(n(318));if(!(a=null!==(a=e.memoizedState)?a.dehydrated:null))throw Error(n(317));a[ds]=e}else pn(),0===(128&e.flags)&&(e.memoizedState=null),e.flags|=4;$o(e),a=!1}else null!==an&&(ou(an),an=null),a=!0;if(!a)return 65536&e.flags?e:null}return 0!==(128&e.flags)?(e.lanes=i,e):((r=null!==r)!==(null!==t&&null!==t.memoizedState)&&r&&(e.child.flags|=8192,0!==(1&e.mode)&&(null===t||0!==(1&ta.current)?0===Rl&&(Rl=3):mu())),null!==e.updateQueue&&(e.flags|=4),$o(e),null);case 4:return Yn(),Lo(t,e),null===t&&Vr(e.stateNode.containerInfo),$o(e),null;case 10:return zn(e.type._context),$o(e),null;case 19:if(Ss(ta),null===(a=e.memoizedState))return $o(e),null;if(r=0!==(128&e.flags),null===(l=a.rendering))if(r)Ho(a,!1);else{if(0!==Rl||null!==t&&0!==(128&t.flags))for(t=e.child;null!==t;){if(null!==(l=ea(t))){for(e.flags|=128,Ho(a,!1),null!==(r=l.updateQueue)&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=i,i=e.child;null!==i;)t=r,(a=i).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,t=l.dependencies,a.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),i=i.sibling;return As(ta,1&ta.current|2),e.child}t=t.sibling}null!==a.tail&&Jt()>Bl&&(e.flags|=128,r=!0,Ho(a,!1),e.lanes=4194304)}else{if(!r)if(null!==(t=ea(l))){if(e.flags|=128,r=!0,null!==(i=t.updateQueue)&&(e.updateQueue=i,e.flags|=4),Ho(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!nn)return $o(e),null}else 2*Jt()-a.renderingStartTime>Bl&&1073741824!==i&&(e.flags|=128,r=!0,Ho(a,!1),e.lanes=4194304);a.isBackwards?(l.sibling=e.child,e.child=l):(null!==(i=a.last)?i.sibling=l:e.child=l,a.last=l)}return null!==a.tail?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Jt(),e.sibling=null,i=ta.current,As(ta,r?1&i|2:1&i),e):($o(e),null);case 22:case 23:return du(),r=null!==e.memoizedState,null!==t&&null!==t.memoizedState!==r&&(e.flags|=8192),r&&0!==(1&e.mode)?0!==(1073741824&Ll)&&($o(e),6&e.subtreeFlags&&(e.flags|=8192)):$o(e),null;case 24:case 25:return null}throw Error(n(156,e.tag))}function Ko(t,e){switch(en(e),e.tag){case 1:return Os(e.type)&&Ls(),65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 3:return Yn(),Ss(Is),Ss(zs),ra(),0!==(65536&(t=e.flags))&&0===(128&t)?(e.flags=-65537&t|128,e):null;case 5:return Zn(e),null;case 13:if(Ss(ta),null!==(t=e.memoizedState)&&null!==t.dehydrated){if(null===e.alternate)throw Error(n(340));pn()}return 65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 19:return Ss(ta),null;case 4:return Yn(),null;case 10:return zn(e.type._context),null;case 22:case 23:return du(),null;default:return null}}Oo=function(t,e){for(var i=e.child;null!==i;){if(5===i.tag||6===i.tag)t.appendChild(i.stateNode);else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===e)break;for(;null===i.sibling;){if(null===i.return||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},Lo=function(){},To=function(t,e,i,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Kn(Hn.current);var n,a=null;switch(i){case"input":s=X(t,s),r=X(t,r),a=[];break;case"select":s=D({},s,{value:void 0}),r=D({},r,{value:void 0}),a=[];break;case"textarea":s=st(t,s),r=st(t,r),a=[];break;default:"function"!==typeof s.onClick&&"function"===typeof r.onClick&&(t.onclick=Zr)}for(h in bt(i,r),i=null,s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&null!=s[h])if("style"===h){var l=s[h];for(n in l)l.hasOwnProperty(n)&&(i||(i={}),i[n]="")}else"dangerouslySetInnerHTML"!==h&&"children"!==h&&"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&"autoFocus"!==h&&(o.hasOwnProperty(h)?a||(a=[]):(a=a||[]).push(h,null));for(h in r){var u=r[h];if(l=null!=s?s[h]:void 0,r.hasOwnProperty(h)&&u!==l&&(null!=u||null!=l))if("style"===h)if(l){for(n in l)!l.hasOwnProperty(n)||u&&u.hasOwnProperty(n)||(i||(i={}),i[n]="");for(n in u)u.hasOwnProperty(n)&&l[n]!==u[n]&&(i||(i={}),i[n]=u[n])}else i||(a||(a=[]),a.push(h,i)),i=u;else"dangerouslySetInnerHTML"===h?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(a=a||[]).push(h,u)):"children"===h?"string"!==typeof u&&"number"!==typeof u||(a=a||[]).push(h,""+u):"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&(o.hasOwnProperty(h)?(null!=u&&"onScroll"===h&&Mr("scroll",t),a||l===u||(a=[])):(a=a||[]).push(h,u))}i&&(a=a||[]).push("style",i);var h=a;(e.updateQueue=h)&&(e.flags|=4)}},Ro=function(t,e,i,r){i!==r&&(e.flags|=4)};var Xo=!1,Yo=!1,Jo="function"===typeof WeakSet?WeakSet:Set,Zo=null;function tl(t,e){var i=t.ref;if(null!==i)if("function"===typeof i)try{i(null)}catch(r){Su(t,e,r)}else i.current=null}function el(t,e,i){try{i()}catch(r){Su(t,e,r)}}var il=!1;function rl(t,e,i){var r=e.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var s=r=r.next;do{if((s.tag&t)===t){var n=s.destroy;s.destroy=void 0,void 0!==n&&el(e,i,n)}s=s.next}while(s!==r)}}function sl(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var i=e=e.next;do{if((i.tag&t)===t){var r=i.create;i.destroy=r()}i=i.next}while(i!==e)}}function nl(t){var e=t.ref;if(null!==e){var i=t.stateNode;t.tag,t=i,"function"===typeof e?e(t):e.current=t}}function al(t){var e=t.alternate;null!==e&&(t.alternate=null,al(e)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&(null!==(e=t.stateNode)&&(delete e[ds],delete e[_s],delete e[fs],delete e[ms],delete e[gs])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function ol(t){return 5===t.tag||3===t.tag||4===t.tag}function ll(t){t:for(;;){for(;null===t.sibling;){if(null===t.return||ol(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;5!==t.tag&&6!==t.tag&&18!==t.tag;){if(2&t.flags)continue t;if(null===t.child||4===t.tag)continue t;t.child.return=t,t=t.child}if(!(2&t.flags))return t.stateNode}}function ul(t,e,i){var r=t.tag;if(5===r||6===r)t=t.stateNode,e?8===i.nodeType?i.parentNode.insertBefore(t,e):i.insertBefore(t,e):(8===i.nodeType?(e=i.parentNode).insertBefore(t,i):(e=i).appendChild(t),null!==(i=i._reactRootContainer)&&void 0!==i||null!==e.onclick||(e.onclick=Zr));else if(4!==r&&null!==(t=t.child))for(ul(t,e,i),t=t.sibling;null!==t;)ul(t,e,i),t=t.sibling}function hl(t,e,i){var r=t.tag;if(5===r||6===r)t=t.stateNode,e?i.insertBefore(t,e):i.appendChild(t);else if(4!==r&&null!==(t=t.child))for(hl(t,e,i),t=t.sibling;null!==t;)hl(t,e,i),t=t.sibling}var cl=null,dl=!1;function _l(t,e,i){for(i=i.child;null!==i;)pl(t,e,i),i=i.sibling}function pl(t,e,i){if(ae&&"function"===typeof ae.onCommitFiberUnmount)try{ae.onCommitFiberUnmount(ne,i)}catch(h){}switch(i.tag){case 5:Yo||tl(i,e);case 6:var r=cl,s=dl;cl=null,_l(t,e,i),dl=s,null!==(cl=r)&&(dl?(t=cl,i=i.stateNode,8===t.nodeType?t.parentNode.removeChild(i):t.removeChild(i)):cl.removeChild(i.stateNode));break;case 18:null!==cl&&(dl?(t=cl,i=i.stateNode,8===t.nodeType?ls(t.parentNode,i):1===t.nodeType&&ls(t,i),Be(t)):ls(cl,i.stateNode));break;case 4:r=cl,s=dl,cl=i.stateNode.containerInfo,dl=!0,_l(t,e,i),cl=r,dl=s;break;case 0:case 11:case 14:case 15:if(!Yo&&(null!==(r=i.updateQueue)&&null!==(r=r.lastEffect))){s=r=r.next;do{var n=s,a=n.destroy;n=n.tag,void 0!==a&&(0!==(2&n)||0!==(4&n))&&el(i,e,a),s=s.next}while(s!==r)}_l(t,e,i);break;case 1:if(!Yo&&(tl(i,e),"function"===typeof(r=i.stateNode).componentWillUnmount))try{r.props=i.memoizedProps,r.state=i.memoizedState,r.componentWillUnmount()}catch(h){Su(i,e,h)}_l(t,e,i);break;case 21:_l(t,e,i);break;case 22:1&i.mode?(Yo=(r=Yo)||null!==i.memoizedState,_l(t,e,i),Yo=r):_l(t,e,i);break;default:_l(t,e,i)}}function fl(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var i=t.stateNode;null===i&&(i=t.stateNode=new Jo),e.forEach((function(e){var r=Iu.bind(null,t,e);i.has(e)||(i.add(e),e.then(r,r))}))}}function ml(t,e){var i=e.deletions;if(null!==i)for(var r=0;r<i.length;r++){var s=i[r];try{var a=t,o=e,l=o;t:for(;null!==l;){switch(l.tag){case 5:cl=l.stateNode,dl=!1;break t;case 3:case 4:cl=l.stateNode.containerInfo,dl=!0;break t}l=l.return}if(null===cl)throw Error(n(160));pl(a,o,s),cl=null,dl=!1;var u=s.alternate;null!==u&&(u.return=null),s.return=null}catch(h){Su(s,e,h)}}if(12854&e.subtreeFlags)for(e=e.child;null!==e;)gl(e,t),e=e.sibling}function gl(t,e){var i=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ml(e,t),yl(t),4&r){try{rl(3,t,t.return),sl(3,t)}catch(m){Su(t,t.return,m)}try{rl(5,t,t.return)}catch(m){Su(t,t.return,m)}}break;case 1:ml(e,t),yl(t),512&r&&null!==i&&tl(i,i.return);break;case 5:if(ml(e,t),yl(t),512&r&&null!==i&&tl(i,i.return),32&t.flags){var s=t.stateNode;try{_t(s,"")}catch(m){Su(t,t.return,m)}}if(4&r&&null!=(s=t.stateNode)){var a=t.memoizedProps,o=null!==i?i.memoizedProps:a,l=t.type,u=t.updateQueue;if(t.updateQueue=null,null!==u)try{"input"===l&&"radio"===a.type&&null!=a.name&&J(s,a),vt(l,o);var h=vt(l,a);for(o=0;o<u.length;o+=2){var c=u[o],d=u[o+1];"style"===c?gt(s,d):"dangerouslySetInnerHTML"===c?dt(s,d):"children"===c?_t(s,d):v(s,c,d,h)}switch(l){case"input":Z(s,a);break;case"textarea":at(s,a);break;case"select":var _=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var p=a.value;null!=p?rt(s,!!a.multiple,p,!1):_!==!!a.multiple&&(null!=a.defaultValue?rt(s,!!a.multiple,a.defaultValue,!0):rt(s,!!a.multiple,a.multiple?[]:"",!1))}s[_s]=a}catch(m){Su(t,t.return,m)}}break;case 6:if(ml(e,t),yl(t),4&r){if(null===t.stateNode)throw Error(n(162));s=t.stateNode,a=t.memoizedProps;try{s.nodeValue=a}catch(m){Su(t,t.return,m)}}break;case 3:if(ml(e,t),yl(t),4&r&&null!==i&&i.memoizedState.isDehydrated)try{Be(e.containerInfo)}catch(m){Su(t,t.return,m)}break;case 4:default:ml(e,t),yl(t);break;case 13:ml(e,t),yl(t),8192&(s=t.child).flags&&(a=null!==s.memoizedState,s.stateNode.isHidden=a,!a||null!==s.alternate&&null!==s.alternate.memoizedState||(Vl=Jt())),4&r&&fl(t);break;case 22:if(c=null!==i&&null!==i.memoizedState,1&t.mode?(Yo=(h=Yo)||c,ml(e,t),Yo=h):ml(e,t),yl(t),8192&r){if(h=null!==t.memoizedState,(t.stateNode.isHidden=h)&&!c&&0!==(1&t.mode))for(Zo=t,c=t.child;null!==c;){for(d=Zo=c;null!==Zo;){switch(p=(_=Zo).child,_.tag){case 0:case 11:case 14:case 15:rl(4,_,_.return);break;case 1:tl(_,_.return);var f=_.stateNode;if("function"===typeof f.componentWillUnmount){r=_,i=_.return;try{e=r,f.props=e.memoizedProps,f.state=e.memoizedState,f.componentWillUnmount()}catch(m){Su(r,i,m)}}break;case 5:tl(_,_.return);break;case 22:if(null!==_.memoizedState){kl(d);continue}}null!==p?(p.return=_,Zo=p):kl(d)}c=c.sibling}t:for(c=null,d=t;;){if(5===d.tag){if(null===c){c=d;try{s=d.stateNode,h?"function"===typeof(a=s.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=d.stateNode,o=void 0!==(u=d.memoizedProps.style)&&null!==u&&u.hasOwnProperty("display")?u.display:null,l.style.display=mt("display",o))}catch(m){Su(t,t.return,m)}}}else if(6===d.tag){if(null===c)try{d.stateNode.nodeValue=h?"":d.memoizedProps}catch(m){Su(t,t.return,m)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===t)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===t)break t;for(;null===d.sibling;){if(null===d.return||d.return===t)break t;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ml(e,t),yl(t),4&r&&fl(t);case 21:}}function yl(t){var e=t.flags;if(2&e){try{t:{for(var i=t.return;null!==i;){if(ol(i)){var r=i;break t}i=i.return}throw Error(n(160))}switch(r.tag){case 5:var s=r.stateNode;32&r.flags&&(_t(s,""),r.flags&=-33),hl(t,ll(t),s);break;case 3:case 4:var a=r.stateNode.containerInfo;ul(t,ll(t),a);break;default:throw Error(n(161))}}catch(o){Su(t,t.return,o)}t.flags&=-3}4096&e&&(t.flags&=-4097)}function bl(t,e,i){Zo=t,vl(t,e,i)}function vl(t,e,i){for(var r=0!==(1&t.mode);null!==Zo;){var s=Zo,n=s.child;if(22===s.tag&&r){var a=null!==s.memoizedState||Xo;if(!a){var o=s.alternate,l=null!==o&&null!==o.memoizedState||Yo;o=Xo;var u=Yo;if(Xo=a,(Yo=l)&&!u)for(Zo=s;null!==Zo;)l=(a=Zo).child,22===a.tag&&null!==a.memoizedState?xl(s):null!==l?(l.return=a,Zo=l):xl(s);for(;null!==n;)Zo=n,vl(n,e,i),n=n.sibling;Zo=s,Xo=o,Yo=u}wl(t)}else 0!==(8772&s.subtreeFlags)&&null!==n?(n.return=s,Zo=n):wl(t)}}function wl(t){for(;null!==Zo;){var e=Zo;if(0!==(8772&e.flags)){var i=e.alternate;try{if(0!==(8772&e.flags))switch(e.tag){case 0:case 11:case 15:Yo||sl(5,e);break;case 1:var r=e.stateNode;if(4&e.flags&&!Yo)if(null===i)r.componentDidMount();else{var s=e.elementType===e.type?i.memoizedProps:io(e.type,i.memoizedProps);r.componentDidUpdate(s,i.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;null!==a&&Gn(e,a,r);break;case 3:var o=e.updateQueue;if(null!==o){if(i=null,null!==e.child)switch(e.child.tag){case 5:case 1:i=e.child.stateNode}Gn(e,o,i)}break;case 5:var l=e.stateNode;if(null===i&&4&e.flags){i=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&i.focus();break;case"img":u.src&&(i.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===e.memoizedState){var h=e.alternate;if(null!==h){var c=h.memoizedState;if(null!==c){var d=c.dehydrated;null!==d&&Be(d)}}}break;default:throw Error(n(163))}Yo||512&e.flags&&nl(e)}catch(_){Su(e,e.return,_)}}if(e===t){Zo=null;break}if(null!==(i=e.sibling)){i.return=e.return,Zo=i;break}Zo=e.return}}function kl(t){for(;null!==Zo;){var e=Zo;if(e===t){Zo=null;break}var i=e.sibling;if(null!==i){i.return=e.return,Zo=i;break}Zo=e.return}}function xl(t){for(;null!==Zo;){var e=Zo;try{switch(e.tag){case 0:case 11:case 15:var i=e.return;try{sl(4,e)}catch(l){Su(e,i,l)}break;case 1:var r=e.stateNode;if("function"===typeof r.componentDidMount){var s=e.return;try{r.componentDidMount()}catch(l){Su(e,s,l)}}var n=e.return;try{nl(e)}catch(l){Su(e,n,l)}break;case 5:var a=e.return;try{nl(e)}catch(l){Su(e,a,l)}}}catch(l){Su(e,e.return,l)}if(e===t){Zo=null;break}var o=e.sibling;if(null!==o){o.return=e.return,Zo=o;break}Zo=e.return}}var Cl,Sl=Math.ceil,Al=w.ReactCurrentDispatcher,El=w.ReactCurrentOwner,zl=w.ReactCurrentBatchConfig,Il=0,Pl=null,ql=null,Ol=0,Ll=0,Tl=Cs(0),Rl=0,Nl=null,Ul=0,Dl=0,Ml=0,Fl=null,jl=null,Vl=0,Bl=1/0,Gl=null,Wl=!1,Hl=null,$l=null,Ql=!1,Kl=null,Xl=0,Yl=0,Jl=null,Zl=-1,tu=0;function eu(){return 0!==(6&Il)?Jt():-1!==Zl?Zl:Zl=Jt()}function iu(t){return 0===(1&t.mode)?1:0!==(2&Il)&&0!==Ol?Ol&-Ol:null!==mn.transition?(0===tu&&(tu=me()),tu):0!==(t=ve)?t:t=void 0===(t=window.event)?16:Ye(t.type)}function ru(t,e,i,r){if(50<Yl)throw Yl=0,Jl=null,Error(n(185));ye(t,i,r),0!==(2&Il)&&t===Pl||(t===Pl&&(0===(2&Il)&&(Dl|=i),4===Rl&&lu(t,Ol)),su(t,r),1===i&&0===Il&&0===(1&e.mode)&&(Bl=Jt()+500,Ms&&Vs()))}function su(t,e){var i=t.callbackNode;!function(t,e){for(var i=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,n=t.pendingLanes;0<n;){var a=31-oe(n),o=1<<a,l=s[a];-1===l?0!==(o&i)&&0===(o&r)||(s[a]=pe(o,e)):l<=e&&(t.expiredLanes|=o),n&=~o}}(t,e);var r=_e(t,t===Pl?Ol:0);if(0===r)null!==i&&Kt(i),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(null!=i&&Kt(i),1===e)0===t.tag?function(t){Ms=!0,js(t)}(uu.bind(null,t)):js(uu.bind(null,t)),as((function(){0===(6&Il)&&Vs()})),i=null;else{switch(we(r)){case 1:i=te;break;case 4:i=ee;break;case 16:default:i=ie;break;case 536870912:i=se}i=Pu(i,nu.bind(null,t))}t.callbackPriority=e,t.callbackNode=i}}function nu(t,e){if(Zl=-1,tu=0,0!==(6&Il))throw Error(n(327));var i=t.callbackNode;if(xu()&&t.callbackNode!==i)return null;var r=_e(t,t===Pl?Ol:0);if(0===r)return null;if(0!==(30&r)||0!==(r&t.expiredLanes)||e)e=gu(t,r);else{e=r;var s=Il;Il|=2;var a=fu();for(Pl===t&&Ol===e||(Gl=null,Bl=Jt()+500,_u(t,e));;)try{bu();break}catch(h){pu(t,h)}En(),Al.current=a,Il=s,null!==ql?e=0:(Pl=null,Ol=0,e=Rl)}if(0!==e){if(2===e&&(0!==(s=fe(t))&&(r=s,e=au(t,s))),1===e)throw i=Nl,_u(t,0),lu(t,r),su(t,Jt()),i;if(6===e)lu(t,r);else{if(s=t.current.alternate,0===(30&r)&&!function(t){for(var e=t;;){if(16384&e.flags){var i=e.updateQueue;if(null!==i&&null!==(i=i.stores))for(var r=0;r<i.length;r++){var s=i[r],n=s.getSnapshot;s=s.value;try{if(!or(n(),s))return!1}catch(o){return!1}}}if(i=e.child,16384&e.subtreeFlags&&null!==i)i.return=e,e=i;else{if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}(s)&&(2===(e=gu(t,r))&&(0!==(a=fe(t))&&(r=a,e=au(t,a))),1===e))throw i=Nl,_u(t,0),lu(t,r),su(t,Jt()),i;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(n(345));case 2:case 5:ku(t,jl,Gl);break;case 3:if(lu(t,r),(130023424&r)===r&&10<(e=Vl+500-Jt())){if(0!==_e(t,0))break;if(((s=t.suspendedLanes)&r)!==r){eu(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=rs(ku.bind(null,t,jl,Gl),e);break}ku(t,jl,Gl);break;case 4:if(lu(t,r),(4194240&r)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-oe(r);a=1<<o,(o=e[o])>s&&(s=o),r&=~a}if(r=s,10<(r=(120>(r=Jt()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Sl(r/1960))-r)){t.timeoutHandle=rs(ku.bind(null,t,jl,Gl),r);break}ku(t,jl,Gl);break;default:throw Error(n(329))}}}return su(t,Jt()),t.callbackNode===i?nu.bind(null,t):null}function au(t,e){var i=Fl;return t.current.memoizedState.isDehydrated&&(_u(t,e).flags|=256),2!==(t=gu(t,e))&&(e=jl,jl=i,null!==e&&ou(e)),t}function ou(t){null===jl?jl=t:jl.push.apply(jl,t)}function lu(t,e){for(e&=~Ml,e&=~Dl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var i=31-oe(e),r=1<<i;t[i]=-1,e&=~r}}function uu(t){if(0!==(6&Il))throw Error(n(327));xu();var e=_e(t,0);if(0===(1&e))return su(t,Jt()),null;var i=gu(t,e);if(0!==t.tag&&2===i){var r=fe(t);0!==r&&(e=r,i=au(t,r))}if(1===i)throw i=Nl,_u(t,0),lu(t,e),su(t,Jt()),i;if(6===i)throw Error(n(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ku(t,jl,Gl),su(t,Jt()),null}function hu(t,e){var i=Il;Il|=1;try{return t(e)}finally{0===(Il=i)&&(Bl=Jt()+500,Ms&&Vs())}}function cu(t){null!==Kl&&0===Kl.tag&&0===(6&Il)&&xu();var e=Il;Il|=1;var i=zl.transition,r=ve;try{if(zl.transition=null,ve=1,t)return t()}finally{ve=r,zl.transition=i,0===(6&(Il=e))&&Vs()}}function du(){Ll=Tl.current,Ss(Tl)}function _u(t,e){t.finishedWork=null,t.finishedLanes=0;var i=t.timeoutHandle;if(-1!==i&&(t.timeoutHandle=-1,ss(i)),null!==ql)for(i=ql.return;null!==i;){var r=i;switch(en(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ls();break;case 3:Yn(),Ss(Is),Ss(zs),ra();break;case 5:Zn(r);break;case 4:Yn();break;case 13:case 19:Ss(ta);break;case 10:zn(r.type._context);break;case 22:case 23:du()}i=i.return}if(Pl=t,ql=t=Tu(t.current,null),Ol=Ll=e,Rl=0,Nl=null,Ml=Dl=Ul=0,jl=Fl=null,null!==On){for(e=0;e<On.length;e++)if(null!==(r=(i=On[e]).interleaved)){i.interleaved=null;var s=r.next,n=i.pending;if(null!==n){var a=n.next;n.next=s,r.next=a}i.pending=r}On=null}return t}function pu(t,e){for(;;){var i=ql;try{if(En(),sa.current=Ja,ha){for(var r=oa.memoizedState;null!==r;){var s=r.queue;null!==s&&(s.pending=null),r=r.next}ha=!1}if(aa=0,ua=la=oa=null,ca=!1,da=0,El.current=null,null===i||null===i.return){Rl=1,Nl=e,ql=null;break}t:{var a=t,o=i.return,l=i,u=e;if(e=Ol,l.flags|=32768,null!==u&&"object"===typeof u&&"function"===typeof u.then){var h=u,c=l,d=c.tag;if(0===(1&c.mode)&&(0===d||11===d||15===d)){var _=c.alternate;_?(c.updateQueue=_.updateQueue,c.memoizedState=_.memoizedState,c.lanes=_.lanes):(c.updateQueue=null,c.memoizedState=null)}var p=go(o);if(null!==p){p.flags&=-257,yo(p,o,l,0,e),1&p.mode&&mo(a,h,e),u=h;var f=(e=p).updateQueue;if(null===f){var m=new Set;m.add(u),e.updateQueue=m}else f.add(u);break t}if(0===(1&e)){mo(a,h,e),mu();break t}u=Error(n(426))}else if(nn&&1&l.mode){var g=go(o);if(null!==g){0===(65536&g.flags)&&(g.flags|=256),yo(g,o,l,0,e),fn(uo(u,l));break t}}a=u=uo(u,l),4!==Rl&&(Rl=2),null===Fl?Fl=[a]:Fl.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e,Vn(a,po(0,u,e));break t;case 1:l=u;var y=a.type,b=a.stateNode;if(0===(128&a.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===$l||!$l.has(b)))){a.flags|=65536,e&=-e,a.lanes|=e,Vn(a,fo(a,l,e));break t}}a=a.return}while(null!==a)}wu(i)}catch(v){e=v,ql===i&&null!==i&&(ql=i=i.return);continue}break}}function fu(){var t=Al.current;return Al.current=Ja,null===t?Ja:t}function mu(){0!==Rl&&3!==Rl&&2!==Rl||(Rl=4),null===Pl||0===(268435455&Ul)&&0===(268435455&Dl)||lu(Pl,Ol)}function gu(t,e){var i=Il;Il|=2;var r=fu();for(Pl===t&&Ol===e||(Gl=null,_u(t,e));;)try{yu();break}catch(s){pu(t,s)}if(En(),Il=i,Al.current=r,null!==ql)throw Error(n(261));return Pl=null,Ol=0,Rl}function yu(){for(;null!==ql;)vu(ql)}function bu(){for(;null!==ql&&!Xt();)vu(ql)}function vu(t){var e=Cl(t.alternate,t,Ll);t.memoizedProps=t.pendingProps,null===e?wu(t):ql=e,El.current=null}function wu(t){var e=t;do{var i=e.alternate;if(t=e.return,0===(32768&e.flags)){if(null!==(i=Qo(i,e,Ll)))return void(ql=i)}else{if(null!==(i=Ko(i,e)))return i.flags&=32767,void(ql=i);if(null===t)return Rl=6,void(ql=null);t.flags|=32768,t.subtreeFlags=0,t.deletions=null}if(null!==(e=e.sibling))return void(ql=e);ql=e=t}while(null!==e);0===Rl&&(Rl=5)}function ku(t,e,i){var r=ve,s=zl.transition;try{zl.transition=null,ve=1,function(t,e,i,r){do{xu()}while(null!==Kl);if(0!==(6&Il))throw Error(n(327));i=t.finishedWork;var s=t.finishedLanes;if(null===i)return null;if(t.finishedWork=null,t.finishedLanes=0,i===t.current)throw Error(n(177));t.callbackNode=null,t.callbackPriority=0;var a=i.lanes|i.childLanes;if(function(t,e){var i=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<i;){var s=31-oe(i),n=1<<s;e[s]=0,r[s]=-1,t[s]=-1,i&=~n}}(t,a),t===Pl&&(ql=Pl=null,Ol=0),0===(2064&i.subtreeFlags)&&0===(2064&i.flags)||Ql||(Ql=!0,Pu(ie,(function(){return xu(),null}))),a=0!==(15990&i.flags),0!==(15990&i.subtreeFlags)||a){a=zl.transition,zl.transition=null;var o=ve;ve=1;var l=Il;Il|=4,El.current=null,function(t,e){if(ts=We,_r(t=dr())){if("selectionStart"in t)var i={start:t.selectionStart,end:t.selectionEnd};else t:{var r=(i=(i=t.ownerDocument)&&i.defaultView||window).getSelection&&i.getSelection();if(r&&0!==r.rangeCount){i=r.anchorNode;var s=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{i.nodeType,a.nodeType}catch(w){i=null;break t}var o=0,l=-1,u=-1,h=0,c=0,d=t,_=null;e:for(;;){for(var p;d!==i||0!==s&&3!==d.nodeType||(l=o+s),d!==a||0!==r&&3!==d.nodeType||(u=o+r),3===d.nodeType&&(o+=d.nodeValue.length),null!==(p=d.firstChild);)_=d,d=p;for(;;){if(d===t)break e;if(_===i&&++h===s&&(l=o),_===a&&++c===r&&(u=o),null!==(p=d.nextSibling))break;_=(d=_).parentNode}d=p}i=-1===l||-1===u?null:{start:l,end:u}}else i=null}i=i||{start:0,end:0}}else i=null;for(es={focusedElem:t,selectionRange:i},We=!1,Zo=e;null!==Zo;)if(t=(e=Zo).child,0!==(1028&e.subtreeFlags)&&null!==t)t.return=e,Zo=t;else for(;null!==Zo;){e=Zo;try{var f=e.alternate;if(0!==(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var m=f.memoizedProps,g=f.memoizedState,y=e.stateNode,b=y.getSnapshotBeforeUpdate(e.elementType===e.type?m:io(e.type,m),g);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var v=e.stateNode.containerInfo;1===v.nodeType?v.textContent="":9===v.nodeType&&v.documentElement&&v.removeChild(v.documentElement);break;default:throw Error(n(163))}}catch(w){Su(e,e.return,w)}if(null!==(t=e.sibling)){t.return=e.return,Zo=t;break}Zo=e.return}f=il,il=!1}(t,i),gl(i,t),pr(es),We=!!ts,es=ts=null,t.current=i,bl(i,t,s),Yt(),Il=l,ve=o,zl.transition=a}else t.current=i;if(Ql&&(Ql=!1,Kl=t,Xl=s),a=t.pendingLanes,0===a&&($l=null),function(t){if(ae&&"function"===typeof ae.onCommitFiberRoot)try{ae.onCommitFiberRoot(ne,t,void 0,128===(128&t.current.flags))}catch(e){}}(i.stateNode),su(t,Jt()),null!==e)for(r=t.onRecoverableError,i=0;i<e.length;i++)s=e[i],r(s.value,{componentStack:s.stack,digest:s.digest});if(Wl)throw Wl=!1,t=Hl,Hl=null,t;0!==(1&Xl)&&0!==t.tag&&xu(),a=t.pendingLanes,0!==(1&a)?t===Jl?Yl++:(Yl=0,Jl=t):Yl=0,Vs()}(t,e,i,r)}finally{zl.transition=s,ve=r}return null}function xu(){if(null!==Kl){var t=we(Xl),e=zl.transition,i=ve;try{if(zl.transition=null,ve=16>t?16:t,null===Kl)var r=!1;else{if(t=Kl,Kl=null,Xl=0,0!==(6&Il))throw Error(n(331));var s=Il;for(Il|=4,Zo=t.current;null!==Zo;){var a=Zo,o=a.child;if(0!==(16&Zo.flags)){var l=a.deletions;if(null!==l){for(var u=0;u<l.length;u++){var h=l[u];for(Zo=h;null!==Zo;){var c=Zo;switch(c.tag){case 0:case 11:case 15:rl(8,c,a)}var d=c.child;if(null!==d)d.return=c,Zo=d;else for(;null!==Zo;){var _=(c=Zo).sibling,p=c.return;if(al(c),c===h){Zo=null;break}if(null!==_){_.return=p,Zo=_;break}Zo=p}}}var f=a.alternate;if(null!==f){var m=f.child;if(null!==m){f.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(null!==m)}}Zo=a}}if(0!==(2064&a.subtreeFlags)&&null!==o)o.return=a,Zo=o;else t:for(;null!==Zo;){if(0!==(2048&(a=Zo).flags))switch(a.tag){case 0:case 11:case 15:rl(9,a,a.return)}var y=a.sibling;if(null!==y){y.return=a.return,Zo=y;break t}Zo=a.return}}var b=t.current;for(Zo=b;null!==Zo;){var v=(o=Zo).child;if(0!==(2064&o.subtreeFlags)&&null!==v)v.return=o,Zo=v;else t:for(o=b;null!==Zo;){if(0!==(2048&(l=Zo).flags))try{switch(l.tag){case 0:case 11:case 15:sl(9,l)}}catch(k){Su(l,l.return,k)}if(l===o){Zo=null;break t}var w=l.sibling;if(null!==w){w.return=l.return,Zo=w;break t}Zo=l.return}}if(Il=s,Vs(),ae&&"function"===typeof ae.onPostCommitFiberRoot)try{ae.onPostCommitFiberRoot(ne,t)}catch(k){}r=!0}return r}finally{ve=i,zl.transition=e}}return!1}function Cu(t,e,i){t=Fn(t,e=po(0,e=uo(i,e),1),1),e=eu(),null!==t&&(ye(t,1,e),su(t,e))}function Su(t,e,i){if(3===t.tag)Cu(t,t,i);else for(;null!==e;){if(3===e.tag){Cu(e,t,i);break}if(1===e.tag){var r=e.stateNode;if("function"===typeof e.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===$l||!$l.has(r))){e=Fn(e,t=fo(e,t=uo(i,t),1),1),t=eu(),null!==e&&(ye(e,1,t),su(e,t));break}}e=e.return}}function Au(t,e,i){var r=t.pingCache;null!==r&&r.delete(e),e=eu(),t.pingedLanes|=t.suspendedLanes&i,Pl===t&&(Ol&i)===i&&(4===Rl||3===Rl&&(130023424&Ol)===Ol&&500>Jt()-Vl?_u(t,0):Ml|=i),su(t,e)}function Eu(t,e){0===e&&(0===(1&t.mode)?e=1:(e=ce,0===(130023424&(ce<<=1))&&(ce=4194304)));var i=eu();null!==(t=Rn(t,e))&&(ye(t,e,i),su(t,i))}function zu(t){var e=t.memoizedState,i=0;null!==e&&(i=e.retryLane),Eu(t,i)}function Iu(t,e){var i=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;null!==s&&(i=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(n(314))}null!==r&&r.delete(e),Eu(t,i)}function Pu(t,e){return Qt(t,e)}function qu(t,e,i,r){this.tag=t,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ou(t,e,i,r){return new qu(t,e,i,r)}function Lu(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Tu(t,e){var i=t.alternate;return null===i?((i=Ou(t.tag,e,t.key,t.mode)).elementType=t.elementType,i.type=t.type,i.stateNode=t.stateNode,i.alternate=t,t.alternate=i):(i.pendingProps=e,i.type=t.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=14680064&t.flags,i.childLanes=t.childLanes,i.lanes=t.lanes,i.child=t.child,i.memoizedProps=t.memoizedProps,i.memoizedState=t.memoizedState,i.updateQueue=t.updateQueue,e=t.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},i.sibling=t.sibling,i.index=t.index,i.ref=t.ref,i}function Ru(t,e,i,r,s,a){var o=2;if(r=t,"function"===typeof t)Lu(t)&&(o=1);else if("string"===typeof t)o=5;else t:switch(t){case C:return Nu(i.children,s,a,e);case S:o=8,s|=8;break;case A:return(t=Ou(12,i,e,2|s)).elementType=A,t.lanes=a,t;case P:return(t=Ou(13,i,e,s)).elementType=P,t.lanes=a,t;case q:return(t=Ou(19,i,e,s)).elementType=q,t.lanes=a,t;case T:return Uu(i,s,a,e);default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case E:o=10;break t;case z:o=9;break t;case I:o=11;break t;case O:o=14;break t;case L:o=16,r=null;break t}throw Error(n(130,null==t?t:typeof t,""))}return(e=Ou(o,i,e,s)).elementType=t,e.type=r,e.lanes=a,e}function Nu(t,e,i,r){return(t=Ou(7,t,r,e)).lanes=i,t}function Uu(t,e,i,r){return(t=Ou(22,t,r,e)).elementType=T,t.lanes=i,t.stateNode={isHidden:!1},t}function Du(t,e,i){return(t=Ou(6,t,null,e)).lanes=i,t}function Mu(t,e,i){return(e=Ou(4,null!==t.children?t.children:[],t.key,e)).lanes=i,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Fu(t,e,i,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ge(0),this.expirationTimes=ge(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ge(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function ju(t,e,i,r,s,n,a,o,l){return t=new Fu(t,e,i,o,l),1===e?(e=1,!0===n&&(e|=8)):e=0,n=Ou(3,null,null,e),t.current=n,n.stateNode=t,n.memoizedState={element:r,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},Un(n),t}function Vu(t){if(!t)return Es;t:{if(Bt(t=t._reactInternals)!==t||1!==t.tag)throw Error(n(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if(Os(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(null!==e);throw Error(n(171))}if(1===t.tag){var i=t.type;if(Os(i))return Rs(t,i,e)}return e}function Bu(t,e,i,r,s,n,a,o,l){return(t=ju(i,r,!0,t,0,n,0,o,l)).context=Vu(null),i=t.current,(n=Mn(r=eu(),s=iu(i))).callback=void 0!==e&&null!==e?e:null,Fn(i,n,s),t.current.lanes=s,ye(t,s,r),su(t,r),t}function Gu(t,e,i,r){var s=e.current,n=eu(),a=iu(s);return i=Vu(i),null===e.context?e.context=i:e.pendingContext=i,(e=Mn(n,a)).payload={element:t},null!==(r=void 0===r?null:r)&&(e.callback=r),null!==(t=Fn(s,e,a))&&(ru(t,s,a,n),jn(t,s,a)),a}function Wu(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function Hu(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var i=t.retryLane;t.retryLane=0!==i&&i<e?i:e}}function $u(t,e){Hu(t,e),(t=t.alternate)&&Hu(t,e)}Cl=function(t,e,i){if(null!==t)if(t.memoizedProps!==e.pendingProps||Is.current)vo=!0;else{if(0===(t.lanes&i)&&0===(128&e.flags))return vo=!1,function(t,e,i){switch(e.tag){case 3:Po(e),pn();break;case 5:Jn(e);break;case 1:Os(e.type)&&Ns(e);break;case 4:Xn(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;As(xn,r._currentValue),r._currentValue=s;break;case 13:if(null!==(r=e.memoizedState))return null!==r.dehydrated?(As(ta,1&ta.current),e.flags|=128,null):0!==(i&e.child.childLanes)?Do(t,e,i):(As(ta,1&ta.current),null!==(t=Wo(t,e,i))?t.sibling:null);As(ta,1&ta.current);break;case 19:if(r=0!==(i&e.childLanes),0!==(128&t.flags)){if(r)return Bo(t,e,i);e.flags|=128}if(null!==(s=e.memoizedState)&&(s.rendering=null,s.tail=null,s.lastEffect=null),As(ta,ta.current),r)break;return null;case 22:case 23:return e.lanes=0,So(t,e,i)}return Wo(t,e,i)}(t,e,i);vo=0!==(131072&t.flags)}else vo=!1,nn&&0!==(1048576&e.flags)&&Zs(e,Hs,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Go(t,e),t=e.pendingProps;var s=qs(e,zs.current);Pn(e,i),s=ma(null,e,r,t,s,i);var a=ga();return e.flags|=1,"object"===typeof s&&null!==s&&"function"===typeof s.render&&void 0===s.$$typeof?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Os(r)?(a=!0,Ns(e)):a=!1,e.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,Un(e),s.updater=so,e.stateNode=s,s._reactInternals=e,lo(e,r,t,i),e=Io(null,e,r,!0,a,i)):(e.tag=0,nn&&a&&tn(e),wo(null,e,s,i),e=e.child),e;case 16:r=e.elementType;t:{switch(Go(t,e),t=e.pendingProps,r=(s=r._init)(r._payload),e.type=r,s=e.tag=function(t){if("function"===typeof t)return Lu(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===I)return 11;if(t===O)return 14}return 2}(r),t=io(r,t),s){case 0:e=Eo(null,e,r,t,i);break t;case 1:e=zo(null,e,r,t,i);break t;case 11:e=ko(null,e,r,t,i);break t;case 14:e=xo(null,e,r,io(r.type,t),i);break t}throw Error(n(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,Eo(t,e,r,s=e.elementType===r?s:io(r,s),i);case 1:return r=e.type,s=e.pendingProps,zo(t,e,r,s=e.elementType===r?s:io(r,s),i);case 3:t:{if(Po(e),null===t)throw Error(n(387));r=e.pendingProps,s=(a=e.memoizedState).element,Dn(t,e),Bn(e,r,null,i);var o=e.memoizedState;if(r=o.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=a,e.memoizedState=a,256&e.flags){e=qo(t,e,r,i,s=uo(Error(n(423)),e));break t}if(r!==s){e=qo(t,e,r,i,s=uo(Error(n(424)),e));break t}for(sn=us(e.stateNode.containerInfo.firstChild),rn=e,nn=!0,an=null,i=kn(e,null,r,i),e.child=i;i;)i.flags=-3&i.flags|4096,i=i.sibling}else{if(pn(),r===s){e=Wo(t,e,i);break t}wo(t,e,r,i)}e=e.child}return e;case 5:return Jn(e),null===t&&hn(e),r=e.type,s=e.pendingProps,a=null!==t?t.memoizedProps:null,o=s.children,is(r,s)?o=null:null!==a&&is(r,a)&&(e.flags|=32),Ao(t,e),wo(t,e,o,i),e.child;case 6:return null===t&&hn(e),null;case 13:return Do(t,e,i);case 4:return Xn(e,e.stateNode.containerInfo),r=e.pendingProps,null===t?e.child=wn(e,null,r,i):wo(t,e,r,i),e.child;case 11:return r=e.type,s=e.pendingProps,ko(t,e,r,s=e.elementType===r?s:io(r,s),i);case 7:return wo(t,e,e.pendingProps,i),e.child;case 8:case 12:return wo(t,e,e.pendingProps.children,i),e.child;case 10:t:{if(r=e.type._context,s=e.pendingProps,a=e.memoizedProps,o=s.value,As(xn,r._currentValue),r._currentValue=o,null!==a)if(or(a.value,o)){if(a.children===s.children&&!Is.current){e=Wo(t,e,i);break t}}else for(null!==(a=e.child)&&(a.return=e);null!==a;){var l=a.dependencies;if(null!==l){o=a.child;for(var u=l.firstContext;null!==u;){if(u.context===r){if(1===a.tag){(u=Mn(-1,i&-i)).tag=2;var h=a.updateQueue;if(null!==h){var c=(h=h.shared).pending;null===c?u.next=u:(u.next=c.next,c.next=u),h.pending=u}}a.lanes|=i,null!==(u=a.alternate)&&(u.lanes|=i),In(a.return,i,e),l.lanes|=i;break}u=u.next}}else if(10===a.tag)o=a.type===e.type?null:a.child;else if(18===a.tag){if(null===(o=a.return))throw Error(n(341));o.lanes|=i,null!==(l=o.alternate)&&(l.lanes|=i),In(o,i,e),o=a.sibling}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===e){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}wo(t,e,s.children,i),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Pn(e,i),r=r(s=qn(s)),e.flags|=1,wo(t,e,r,i),e.child;case 14:return s=io(r=e.type,e.pendingProps),xo(t,e,r,s=io(r.type,s),i);case 15:return Co(t,e,e.type,e.pendingProps,i);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:io(r,s),Go(t,e),e.tag=1,Os(r)?(t=!0,Ns(e)):t=!1,Pn(e,i),ao(e,r,s),lo(e,r,s,i),Io(null,e,r,!0,t,i);case 19:return Bo(t,e,i);case 22:return So(t,e,i)}throw Error(n(156,e.tag))};var Qu="function"===typeof reportError?reportError:function(t){console.error(t)};function Ku(t){this._internalRoot=t}function Xu(t){this._internalRoot=t}function Yu(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)}function Ju(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function Zu(){}function th(t,e,i,r,s){var n=i._reactRootContainer;if(n){var a=n;if("function"===typeof s){var o=s;s=function(){var t=Wu(a);o.call(t)}}Gu(e,a,t,s)}else a=function(t,e,i,r,s){if(s){if("function"===typeof r){var n=r;r=function(){var t=Wu(a);n.call(t)}}var a=Bu(e,r,t,0,null,!1,0,"",Zu);return t._reactRootContainer=a,t[ps]=a.current,Vr(8===t.nodeType?t.parentNode:t),cu(),a}for(;s=t.lastChild;)t.removeChild(s);if("function"===typeof r){var o=r;r=function(){var t=Wu(l);o.call(t)}}var l=ju(t,0,!1,null,0,!1,0,"",Zu);return t._reactRootContainer=l,t[ps]=l.current,Vr(8===t.nodeType?t.parentNode:t),cu((function(){Gu(e,l,i,r)})),l}(i,e,t,s,r);return Wu(a)}Xu.prototype.render=Ku.prototype.render=function(t){var e=this._internalRoot;if(null===e)throw Error(n(409));Gu(t,e,null,null)},Xu.prototype.unmount=Ku.prototype.unmount=function(){var t=this._internalRoot;if(null!==t){this._internalRoot=null;var e=t.containerInfo;cu((function(){Gu(null,t,null,null)})),e[ps]=null}},Xu.prototype.unstable_scheduleHydration=function(t){if(t){var e=Se();t={blockedOn:null,target:t,priority:e};for(var i=0;i<Te.length&&0!==e&&e<Te[i].priority;i++);Te.splice(i,0,t),0===i&&De(t)}},ke=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var i=de(e.pendingLanes);0!==i&&(be(e,1|i),su(e,Jt()),0===(6&Il)&&(Bl=Jt()+500,Vs()))}break;case 13:cu((function(){var e=Rn(t,1);if(null!==e){var i=eu();ru(e,t,1,i)}})),$u(t,1)}},xe=function(t){if(13===t.tag){var e=Rn(t,134217728);if(null!==e)ru(e,t,134217728,eu());$u(t,134217728)}},Ce=function(t){if(13===t.tag){var e=iu(t),i=Rn(t,e);if(null!==i)ru(i,t,e,eu());$u(t,e)}},Se=function(){return ve},Ae=function(t,e){var i=ve;try{return ve=t,e()}finally{ve=i}},xt=function(t,e,i){switch(e){case"input":if(Z(t,i),e=i.name,"radio"===i.type&&null!=e){for(i=t;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<i.length;e++){var r=i[e];if(r!==t&&r.form===t.form){var s=ws(r);if(!s)throw Error(n(90));Q(r),Z(r,s)}}}break;case"textarea":at(t,i);break;case"select":null!=(e=i.value)&&rt(t,!!i.multiple,e,!1)}},It=hu,Pt=cu;var eh={usingClientEntryPoint:!1,Events:[bs,vs,ws,Et,zt,hu]},ih={findFiberByHostInstance:ys,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},rh={bundleType:ih.bundleType,version:ih.version,rendererPackageName:ih.rendererPackageName,rendererConfig:ih.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=Ht(t))?null:t.stateNode},findFiberByHostInstance:ih.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var sh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sh.isDisabled&&sh.supportsFiber)try{ne=sh.inject(rh),ae=sh}catch(ct){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eh,e.createPortal=function(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yu(e))throw Error(n(200));return function(t,e,i){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:x,key:null==r?null:""+r,children:t,containerInfo:e,implementation:i}}(t,e,null,i)},e.createRoot=function(t,e){if(!Yu(t))throw Error(n(299));var i=!1,r="",s=Qu;return null!==e&&void 0!==e&&(!0===e.unstable_strictMode&&(i=!0),void 0!==e.identifierPrefix&&(r=e.identifierPrefix),void 0!==e.onRecoverableError&&(s=e.onRecoverableError)),e=ju(t,1,!1,null,0,i,0,r,s),t[ps]=e.current,Vr(8===t.nodeType?t.parentNode:t),new Ku(e)},e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"===typeof t.render)throw Error(n(188));throw t=Object.keys(t).join(","),Error(n(268,t))}return t=null===(t=Ht(e))?null:t.stateNode},e.flushSync=function(t){return cu(t)},e.hydrate=function(t,e,i){if(!Ju(e))throw Error(n(200));return th(null,t,e,!0,i)},e.hydrateRoot=function(t,e,i){if(!Yu(t))throw Error(n(405));var r=null!=i&&i.hydratedSources||null,s=!1,a="",o=Qu;if(null!==i&&void 0!==i&&(!0===i.unstable_strictMode&&(s=!0),void 0!==i.identifierPrefix&&(a=i.identifierPrefix),void 0!==i.onRecoverableError&&(o=i.onRecoverableError)),e=Bu(e,null,t,1,null!=i?i:null,s,0,a,o),t[ps]=e.current,Vr(t),r)for(t=0;t<r.length;t++)s=(s=(i=r[t])._getVersion)(i._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[i,s]:e.mutableSourceEagerHydrationData.push(i,s);return new Xu(e)},e.render=function(t,e,i){if(!Ju(e))throw Error(n(200));return th(null,t,e,!1,i)},e.unmountComponentAtNode=function(t){if(!Ju(t))throw Error(n(40));return!!t._reactRootContainer&&(cu((function(){th(null,null,t,!1,(function(){t._reactRootContainer=null,t[ps]=null}))})),!0)},e.unstable_batchedUpdates=hu,e.unstable_renderSubtreeIntoContainer=function(t,e,i,r){if(!Ju(i))throw Error(n(200));if(null==t||void 0===t._reactInternals)throw Error(n(38));return th(t,e,i,!1,r)},e.version="18.3.1-next-f1338f8080-20240426"},391:(t,e,i)=>{"use strict";var r=i(950);e.createRoot=r.createRoot,e.hydrateRoot=r.hydrateRoot},950:(t,e,i)=>{"use strict";!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),t.exports=i(730)},153:(t,e,i)=>{"use strict";var r=i(43),s=Symbol.for("react.element"),n=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function u(t,e,i){var r,n={},u=null,h=null;for(r in void 0!==i&&(u=""+i),void 0!==e.key&&(u=""+e.key),void 0!==e.ref&&(h=e.ref),e)a.call(e,r)&&!l.hasOwnProperty(r)&&(n[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps)void 0===n[r]&&(n[r]=e[r]);return{$$typeof:s,type:t,key:u,ref:h,props:n,_owner:o.current}}e.jsx=u,e.jsxs=u},202:(t,e)=>{"use strict";var i=Symbol.for("react.element"),r=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),_=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,m={};function g(t,e,i){this.props=t,this.context=e,this.refs=m,this.updater=i||p}function y(){}function b(t,e,i){this.props=t,this.context=e,this.refs=m,this.updater=i||p}g.prototype.isReactComponent={},g.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},g.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},y.prototype=g.prototype;var v=b.prototype=new y;v.constructor=b,f(v,g.prototype),v.isPureReactComponent=!0;var w=Array.isArray,k=Object.prototype.hasOwnProperty,x={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function S(t,e,r){var s,n={},a=null,o=null;if(null!=e)for(s in void 0!==e.ref&&(o=e.ref),void 0!==e.key&&(a=""+e.key),e)k.call(e,s)&&!C.hasOwnProperty(s)&&(n[s]=e[s]);var l=arguments.length-2;if(1===l)n.children=r;else if(1<l){for(var u=Array(l),h=0;h<l;h++)u[h]=arguments[h+2];n.children=u}if(t&&t.defaultProps)for(s in l=t.defaultProps)void 0===n[s]&&(n[s]=l[s]);return{$$typeof:i,type:t,key:a,ref:o,props:n,_owner:x.current}}function A(t){return"object"===typeof t&&null!==t&&t.$$typeof===i}var E=/\/+/g;function z(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function I(t,e,s,n,a){var o=typeof t;"undefined"!==o&&"boolean"!==o||(t=null);var l=!1;if(null===t)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case i:case r:l=!0}}if(l)return a=a(l=t),t=""===n?"."+z(l,0):n,w(a)?(s="",null!=t&&(s=t.replace(E,"$&/")+"/"),I(a,e,s,"",(function(t){return t}))):null!=a&&(A(a)&&(a=function(t,e){return{$$typeof:i,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(a,s+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(E,"$&/")+"/")+t)),e.push(a)),1;if(l=0,n=""===n?".":n+":",w(t))for(var u=0;u<t.length;u++){var h=n+z(o=t[u],u);l+=I(o,e,s,h,a)}else if(h=function(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=_&&t[_]||t["@@iterator"])?t:null}(t),"function"===typeof h)for(t=h.call(t),u=0;!(o=t.next()).done;)l+=I(o=o.value,e,s,h=n+z(o,u++),a);else if("object"===o)throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function P(t,e,i){if(null==t)return t;var r=[],s=0;return I(t,r,"","",(function(t){return e.call(i,t,s++)})),r}function q(t){if(-1===t._status){var e=t._result;(e=e()).then((function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)}),(function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)})),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var O={current:null},L={transition:null},T={ReactCurrentDispatcher:O,ReactCurrentBatchConfig:L,ReactCurrentOwner:x};function R(){throw Error("act(...) is not supported in production builds of React.")}e.Children={map:P,forEach:function(t,e,i){P(t,(function(){e.apply(this,arguments)}),i)},count:function(t){var e=0;return P(t,(function(){e++})),e},toArray:function(t){return P(t,(function(t){return t}))||[]},only:function(t){if(!A(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},e.Component=g,e.Fragment=s,e.Profiler=a,e.PureComponent=b,e.StrictMode=n,e.Suspense=h,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=T,e.act=R,e.cloneElement=function(t,e,r){if(null===t||void 0===t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=f({},t.props),n=t.key,a=t.ref,o=t._owner;if(null!=e){if(void 0!==e.ref&&(a=e.ref,o=x.current),void 0!==e.key&&(n=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)k.call(e,u)&&!C.hasOwnProperty(u)&&(s[u]=void 0===e[u]&&void 0!==l?l[u]:e[u])}var u=arguments.length-2;if(1===u)s.children=r;else if(1<u){l=Array(u);for(var h=0;h<u;h++)l[h]=arguments[h+2];s.children=l}return{$$typeof:i,type:t.type,key:n,ref:a,props:s,_owner:o}},e.createContext=function(t){return(t={$$typeof:l,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:t},t.Consumer=t},e.createElement=S,e.createFactory=function(t){var e=S.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:u,render:t}},e.isValidElement=A,e.lazy=function(t){return{$$typeof:d,_payload:{_status:-1,_result:t},_init:q}},e.memo=function(t,e){return{$$typeof:c,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=L.transition;L.transition={};try{t()}finally{L.transition=e}},e.unstable_act=R,e.useCallback=function(t,e){return O.current.useCallback(t,e)},e.useContext=function(t){return O.current.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t){return O.current.useDeferredValue(t)},e.useEffect=function(t,e){return O.current.useEffect(t,e)},e.useId=function(){return O.current.useId()},e.useImperativeHandle=function(t,e,i){return O.current.useImperativeHandle(t,e,i)},e.useInsertionEffect=function(t,e){return O.current.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return O.current.useLayoutEffect(t,e)},e.useMemo=function(t,e){return O.current.useMemo(t,e)},e.useReducer=function(t,e,i){return O.current.useReducer(t,e,i)},e.useRef=function(t){return O.current.useRef(t)},e.useState=function(t){return O.current.useState(t)},e.useSyncExternalStore=function(t,e,i){return O.current.useSyncExternalStore(t,e,i)},e.useTransition=function(){return O.current.useTransition()},e.version="18.3.1"},43:(t,e,i)=>{"use strict";t.exports=i(202)},579:(t,e,i)=>{"use strict";t.exports=i(153)},234:(t,e)=>{"use strict";function i(t,e){var i=t.length;t.push(e);t:for(;0<i;){var r=i-1>>>1,s=t[r];if(!(0<n(s,e)))break t;t[r]=e,t[i]=s,i=r}}function r(t){return 0===t.length?null:t[0]}function s(t){if(0===t.length)return null;var e=t[0],i=t.pop();if(i!==e){t[0]=i;t:for(var r=0,s=t.length,a=s>>>1;r<a;){var o=2*(r+1)-1,l=t[o],u=o+1,h=t[u];if(0>n(l,i))u<s&&0>n(h,l)?(t[r]=h,t[u]=i,r=u):(t[r]=l,t[o]=i,r=o);else{if(!(u<s&&0>n(h,i)))break t;t[r]=h,t[u]=i,r=u}}}return e}function n(t,e){var i=t.sortIndex-e.sortIndex;return 0!==i?i:t.id-e.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var u=[],h=[],c=1,d=null,_=3,p=!1,f=!1,m=!1,g="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function v(t){for(var e=r(h);null!==e;){if(null===e.callback)s(h);else{if(!(e.startTime<=t))break;s(h),e.sortIndex=e.expirationTime,i(u,e)}e=r(h)}}function w(t){if(m=!1,v(t),!f)if(null!==r(u))f=!0,L(k);else{var e=r(h);null!==e&&T(w,e.startTime-t)}}function k(t,i){f=!1,m&&(m=!1,y(A),A=-1),p=!0;var n=_;try{for(v(i),d=r(u);null!==d&&(!(d.expirationTime>i)||t&&!I());){var a=d.callback;if("function"===typeof a){d.callback=null,_=d.priorityLevel;var o=a(d.expirationTime<=i);i=e.unstable_now(),"function"===typeof o?d.callback=o:d===r(u)&&s(u),v(i)}else s(u);d=r(u)}if(null!==d)var l=!0;else{var c=r(h);null!==c&&T(w,c.startTime-i),l=!1}return l}finally{d=null,_=n,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var x,C=!1,S=null,A=-1,E=5,z=-1;function I(){return!(e.unstable_now()-z<E)}function P(){if(null!==S){var t=e.unstable_now();z=t;var i=!0;try{i=S(!0,t)}finally{i?x():(C=!1,S=null)}}else C=!1}if("function"===typeof b)x=function(){b(P)};else if("undefined"!==typeof MessageChannel){var q=new MessageChannel,O=q.port2;q.port1.onmessage=P,x=function(){O.postMessage(null)}}else x=function(){g(P,0)};function L(t){S=t,C||(C=!0,x())}function T(t,i){A=g((function(){t(e.unstable_now())}),i)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){f||p||(f=!0,L(k))},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return _},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(t){switch(_){case 1:case 2:case 3:var e=3;break;default:e=_}var i=_;_=e;try{return t()}finally{_=i}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var i=_;_=t;try{return e()}finally{_=i}},e.unstable_scheduleCallback=function(t,s,n){var a=e.unstable_now();switch("object"===typeof n&&null!==n?n="number"===typeof(n=n.delay)&&0<n?a+n:a:n=a,t){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return t={id:c++,callback:s,priorityLevel:t,startTime:n,expirationTime:o=n+o,sortIndex:-1},n>a?(t.sortIndex=n,i(h,t),null===r(u)&&t===r(h)&&(m?(y(A),A=-1):m=!0,T(w,n-a))):(t.sortIndex=o,i(u,t),f||p||(f=!0,L(k))),t},e.unstable_shouldYield=I,e.unstable_wrapCallback=function(t){var e=_;return function(){var i=_;_=e;try{return t.apply(this,arguments)}finally{_=i}}}},853:(t,e,i)=>{"use strict";t.exports=i(234)},479:(t,e,i)=>{"use strict";t=i.hmd(t);var r="Fixed (0);Lowest Prio (1);SMI (2);Reserved (3);NMI (4);INIT (5);Reserved (6);ExtINT (7)".split(";"),s=["physical","logical"];function n(t){this.cpu=t,this.timer_divider=this.apic_id=0,this.timer_divider_shift=1,this.timer_current_count=this.timer_initial_count=0,this.next_tick=Y.microtick(),this.lvt_error=this.lvt_int1=this.lvt_int0=this.lvt_perf_counter=this.lvt_timer=IOAPIC_CONFIG_MASKED,this.icr1=this.icr0=this.tpr=0,this.irr=new Int32Array(8),this.isr=new Int32Array(8),this.tmr=new Int32Array(8),this.spurious_vector=254,this.destination_format=-1,this.read_error=this.error=this.local_destination=0,t.io.mmap_register(4276092928,1048576,(t=>{dbg_log("Unsupported read8 from apic: "+h(t>>>0),LOG_APIC);var e=3&t;return this.read32(-4&t)>>8*e&255}),((t,e)=>{dbg_log("Unsupported write8 from apic: "+h(t)+" <- "+h(e),LOG_APIC),dbg_trace(),dbg_assert(!1)}),(t=>this.read32(t)),((t,e)=>this.write32(t,e)))}n.prototype.read32=function(t){switch(t=t-4276092928|0){case 32:return dbg_log("APIC read id",LOG_APIC),this.apic_id;case 48:return dbg_log("APIC read version",LOG_APIC),327700;case 128:return this.tpr;case 208:return dbg_log("Read local destination",LOG_APIC),this.local_destination;case 224:return dbg_log("Read destination format",LOG_APIC),this.destination_format;case 240:return this.spurious_vector;case 256:case 272:case 288:case 304:case 320:case 336:case 352:case 368:return t=t-256>>4,dbg_log("Read isr "+t+": "+h(this.isr[t]>>>0,8),LOG_APIC),this.isr[t];case 384:case 400:case 416:case 432:case 448:case 464:case 480:case 496:return t=t-384>>4,dbg_log("Read tmr "+t+": "+h(this.tmr[t]>>>0,8),LOG_APIC),this.tmr[t];case 512:case 528:case 544:case 560:case 576:case 592:case 608:case 624:return t=t-512>>4,dbg_log("Read irr "+t+": "+h(this.irr[t]>>>0,8),LOG_APIC),this.irr[t];case 640:return dbg_log("Read error: "+h(this.read_error>>>0,8),LOG_APIC),this.read_error;case 768:return this.icr0;case 784:return dbg_log("APIC read icr1",LOG_APIC),this.icr1;case 800:return dbg_log("read timer lvt",LOG_APIC),this.lvt_timer;case 832:return dbg_log("read lvt perf counter",LOG_APIC),this.lvt_perf_counter;case 848:return dbg_log("read lvt int0",LOG_APIC),this.lvt_int0;case 864:return dbg_log("read lvt int1",LOG_APIC),this.lvt_int1;case 880:return dbg_log("read lvt error",LOG_APIC),this.lvt_error;case 992:return dbg_log("read timer divider",LOG_APIC),this.timer_divider;case 896:return dbg_log("read timer initial count",LOG_APIC),this.timer_initial_count;case 912:return dbg_log("read timer current count: "+h(this.timer_current_count>>>0,8),LOG_APIC),this.timer_current_count;default:return dbg_log("APIC read "+h(t),LOG_APIC),dbg_assert(!1),0}},n.prototype.write32=function(t,e){switch(t=t-4276092928|0){case 48:dbg_log("APIC write version: "+h(e>>>0,8)+", ignored",LOG_APIC);break;case 128:this.tpr=255&e,this.check_vector();break;case 176:-1!==(e=this.highest_isr())?(this.register_clear_bit(this.isr,e),this.register_get_bit(this.tmr,e)&&this.cpu.devices.ioapic.remote_eoi(e),this.check_vector()):dbg_log("Bad eoi: No isr set",LOG_APIC);break;case 208:dbg_log("Set local destination: "+h(e>>>0,8),LOG_APIC),this.local_destination=4278190080&e;break;case 224:dbg_log("Set destination format: "+h(e>>>0,8),LOG_APIC),this.destination_format=16777215|e;break;case 240:dbg_log("Set spurious vector: "+h(e>>>0,8),LOG_APIC),this.spurious_vector=e;break;case 640:dbg_log("Write error: "+h(e>>>0,8),LOG_APIC),this.read_error=this.error,this.error=0;break;case 768:t=255&e;var i=e>>8&7,n=e>>11&1,a=e>>15&1,o=e>>18&3,l=this.icr1>>>24;dbg_log("APIC write icr0: "+h(e,8)+" vector="+h(t,2)+" destination_mode="+s[n]+" delivery_mode="+r[i]+" destination_shorthand="+["no","self","all with self","all without self"][o],LOG_APIC),this.icr0=-4097&e,0===o?this.route(t,i,a,l,n):1===o?this.deliver(t,IOAPIC_DELIVERY_FIXED,a):2===o?this.deliver(t,i,a):3!==o&&dbg_assert(!1);break;case 784:dbg_log("APIC write icr1: "+h(e>>>0,8),LOG_APIC),this.icr1=e;break;case 800:dbg_log("timer lvt: "+h(e>>>0,8),LOG_APIC),this.lvt_timer=e;break;case 832:dbg_log("lvt perf counter: "+h(e>>>0,8),LOG_APIC),this.lvt_perf_counter=e;break;case 848:dbg_log("lvt int0: "+h(e>>>0,8),LOG_APIC),this.lvt_int0=e;break;case 864:dbg_log("lvt int1: "+h(e>>>0,8),LOG_APIC),this.lvt_int1=e;break;case 880:dbg_log("lvt error: "+h(e>>>0,8),LOG_APIC),this.lvt_error=e;break;case 992:dbg_log("timer divider: "+h(e>>>0,8),LOG_APIC),this.timer_divider=e,e=3&e|(8&e)>>1,this.timer_divider_shift=7===e?0:e+1;break;case 896:dbg_log("timer initial: "+h(e>>>0,8),LOG_APIC),this.timer_initial_count=e>>>0,this.timer_current_count=e>>>0,this.next_tick=Y.microtick(),this.timer_active=!0;break;case 912:dbg_log("timer current: "+h(e>>>0,8),LOG_APIC),dbg_assert(!1,"read-only register");break;default:dbg_log("APIC write32 "+h(t)+" <- "+h(e>>>0,8),LOG_APIC),dbg_assert(!1)}},n.prototype.timer=function(t){if(0===this.timer_current_count)return 100;let e=APIC_TIMER_FREQ/(1<<this.timer_divider_shift);return t=(t-this.next_tick)*e>>>0,this.next_tick+=t/e,this.timer_current_count-=t,0>=this.timer_current_count&&(131072===(t=393216&this.lvt_timer)?(this.timer_current_count%=this.timer_initial_count,0>=this.timer_current_count&&(this.timer_current_count+=this.timer_initial_count),dbg_assert(0!==this.timer_current_count),0==(this.lvt_timer&IOAPIC_CONFIG_MASKED)&&this.deliver(255&this.lvt_timer,IOAPIC_DELIVERY_FIXED,!1)):0===t&&(this.timer_current_count=0,dbg_log("APIC timer one shot end",LOG_APIC),0==(this.lvt_timer&IOAPIC_CONFIG_MASKED)&&this.deliver(255&this.lvt_timer,IOAPIC_DELIVERY_FIXED,!1))),Math.max(0,this.timer_current_count/e)},n.prototype.route=function(t,e,i){this.deliver(t,e,i)},n.prototype.deliver=function(t,e,i){e!==IOAPIC_DELIVERY_INIT&&e!==IOAPIC_DELIVERY_NMI&&((16>t||255===t)&&dbg_assert(!1,"TODO: Invalid vector"),this.register_get_bit(this.irr,t)?dbg_log("Not delivered: irr already set, vector="+h(t,2),LOG_APIC):(this.register_set_bit(this.irr,t),i?this.register_set_bit(this.tmr,t):this.register_clear_bit(this.tmr,t),this.check_vector()))},n.prototype.highest_irr=function(){var t=this.register_get_highest_bit(this.irr);return dbg_assert(255!==t),dbg_assert(16<=t||-1===t),t},n.prototype.highest_isr=function(){var t=this.register_get_highest_bit(this.isr);return dbg_assert(255!==t),dbg_assert(16<=t||-1===t),t},n.prototype.check_vector=function(){var t=this.highest_irr();-1!==t&&(this.highest_isr()>=t||(240&t)<=(240&this.tpr)||this.cpu.handle_irqs())},n.prototype.acknowledge_irq=function(){var t=this.highest_irr();-1===t||this.highest_isr()>=t||(240&t)<=(240&this.tpr)||(this.register_clear_bit(this.irr,t),this.register_set_bit(this.isr,t),this.cpu.pic_call_irq(t),this.check_vector())},n.prototype.get_state=function(){var t=[];return t[0]=this.apic_id,t[1]=this.timer_divider,t[2]=this.timer_divider_shift,t[3]=this.timer_initial_count,t[4]=this.timer_current_count,t[5]=this.next_tick,t[6]=this.lvt_timer,t[7]=this.lvt_perf_counter,t[8]=this.lvt_int0,t[9]=this.lvt_int1,t[10]=this.lvt_error,t[11]=this.tpr,t[12]=this.icr0,t[13]=this.icr1,t[14]=this.irr,t[15]=this.isr,t[16]=this.tmr,t[17]=this.spurious_vector,t[18]=this.destination_format,t[19]=this.local_destination,t[20]=this.error,t[21]=this.read_error,t},n.prototype.set_state=function(t){this.apic_id=t[0],this.timer_divider=t[1],this.timer_divider_shift=t[2],this.timer_initial_count=t[3],this.timer_current_count=t[4],this.next_tick=t[5],this.lvt_timer=t[6],this.lvt_perf_counter=t[7],this.lvt_int0=t[8],this.lvt_int1=t[9],this.lvt_error=t[10],this.tpr=t[11],this.icr0=t[12],this.icr1=t[13],this.irr=t[14],this.isr=t[15],this.tmr=t[16],this.spurious_vector=t[17],this.destination_format=t[18],this.local_destination=t[19],this.error=t[20],this.read_error=t[21]},n.prototype.register_get_bit=function(t,e){return dbg_assert(0<=e&&256>e),t[e>>5]>>(31&e)&1},n.prototype.register_set_bit=function(t,e){dbg_assert(0<=e&&256>e),t[e>>5]|=1<<(31&e)},n.prototype.register_clear_bit=function(t,e){dbg_assert(0<=e&&256>e),t[e>>5]&=~(1<<(31&e))},n.prototype.register_get_highest_bit=function(t){for(var e=7;0<=e;e--){var i=t[e];if(i)return v86util.int_log2(i>>>0)|e<<5}return-1};var a=a||{};a.exportSymbol=function(){},a.exportProperty=function(){};var o=o||{};function l(t,e){return t=t?t.toString(16):"","0x"+o.pad0(t.toUpperCase(),e||1)}if(o.pads=function(t,e){return(t||0===t?t+"":"").padEnd(e," ")},o.pad0=function(t,e){return(t||0===t?t+"":"").padStart(e,"0")},o.zeros=function(t){return Array(t).fill(0)},o.range=function(t){return Array.from(Array(t).keys())},o.view=function(t,e,i,r){return new Proxy({},{get:function(s,n){let a=(s=new t(e.buffer,i,r))[n];return"function"==typeof a?a.bind(s):(/^\d+$/.test(n),a)},set:function(s,n,a){return/^\d+$/.test(n),new t(e.buffer,i,r)[n]=a,!0}})},"undefined"!=typeof crypto&&crypto.getRandomValues){let Ot=new Int32Array(1);o.get_rand_int=function(){return crypto.getRandomValues(Ot),Ot[0]}}function u(t){var e,i,r=new Uint8Array(t);this.length=0,this.push=function(e){this.length!==t&&this.length++,r[i]=e,i=i+1&t-1},this.shift=function(){if(this.length){var i=r[e];return e=e+1&t-1,this.length--,i}return-1},this.peek=function(){return this.length?r[e]:-1},this.clear=function(){this.length=i=e=0},this.clear()}function c(t){this.size=t,this.data=new Float32Array(t),this.length=this.end=this.start=0}function d(t){this.data=[],this.index=0,this.size=t}function _(t){this.cpu=t,this.channel_page=new Uint8Array(8),this.channel_pagehi=new Uint8Array(8),this.channel_addr=new Uint16Array(8),this.channel_addr_init=new Uint16Array(8),this.channel_count=new Uint16Array(8),this.channel_count_init=new Uint16Array(8),this.channel_mask=new Uint8Array(8),this.channel_mode=new Uint8Array(8),this.unmask_listeners=[],this.lsb_msb_flipflop=0,(t=t.io).register_write(0,this,this.port_addr_write.bind(this,0)),t.register_write(2,this,this.port_addr_write.bind(this,1)),t.register_write(4,this,this.port_addr_write.bind(this,2)),t.register_write(6,this,this.port_addr_write.bind(this,3)),t.register_write(1,this,this.port_count_write.bind(this,0)),t.register_write(3,this,this.port_count_write.bind(this,1)),t.register_write(5,this,this.port_count_write.bind(this,2)),t.register_write(7,this,this.port_count_write.bind(this,3)),t.register_read(0,this,this.port_addr_read.bind(this,0)),t.register_read(2,this,this.port_addr_read.bind(this,1)),t.register_read(4,this,this.port_addr_read.bind(this,2)),t.register_read(6,this,this.port_addr_read.bind(this,3)),t.register_read(1,this,this.port_count_read.bind(this,0)),t.register_read(3,this,this.port_count_read.bind(this,1)),t.register_read(5,this,this.port_count_read.bind(this,2)),t.register_read(7,this,this.port_count_read.bind(this,3)),t.register_write(192,this,this.port_addr_write.bind(this,4)),t.register_write(196,this,this.port_addr_write.bind(this,5)),t.register_write(200,this,this.port_addr_write.bind(this,6)),t.register_write(204,this,this.port_addr_write.bind(this,7)),t.register_write(194,this,this.port_count_write.bind(this,4)),t.register_write(198,this,this.port_count_write.bind(this,5)),t.register_write(202,this,this.port_count_write.bind(this,6)),t.register_write(206,this,this.port_count_write.bind(this,7)),t.register_read(192,this,this.port_addr_read.bind(this,4)),t.register_read(196,this,this.port_addr_read.bind(this,5)),t.register_read(200,this,this.port_addr_read.bind(this,6)),t.register_read(204,this,this.port_addr_read.bind(this,7)),t.register_read(194,this,this.port_count_read.bind(this,4)),t.register_read(198,this,this.port_count_read.bind(this,5)),t.register_read(202,this,this.port_count_read.bind(this,6)),t.register_read(206,this,this.port_count_read.bind(this,7)),t.register_write(135,this,this.port_page_write.bind(this,0)),t.register_write(131,this,this.port_page_write.bind(this,1)),t.register_write(129,this,this.port_page_write.bind(this,2)),t.register_write(130,this,this.port_page_write.bind(this,3)),t.register_write(143,this,this.port_page_write.bind(this,4)),t.register_write(139,this,this.port_page_write.bind(this,5)),t.register_write(137,this,this.port_page_write.bind(this,6)),t.register_write(138,this,this.port_page_write.bind(this,7)),t.register_read(135,this,this.port_page_read.bind(this,0)),t.register_read(131,this,this.port_page_read.bind(this,1)),t.register_read(129,this,this.port_page_read.bind(this,2)),t.register_read(130,this,this.port_page_read.bind(this,3)),t.register_read(143,this,this.port_page_read.bind(this,4)),t.register_read(139,this,this.port_page_read.bind(this,5)),t.register_read(137,this,this.port_page_read.bind(this,6)),t.register_read(138,this,this.port_page_read.bind(this,7)),t.register_write(1159,this,this.port_pagehi_write.bind(this,0)),t.register_write(1155,this,this.port_pagehi_write.bind(this,1)),t.register_write(1153,this,this.port_pagehi_write.bind(this,2)),t.register_write(1154,this,this.port_pagehi_write.bind(this,3)),t.register_write(1163,this,this.port_pagehi_write.bind(this,5)),t.register_write(1161,this,this.port_pagehi_write.bind(this,6)),t.register_write(1162,this,this.port_pagehi_write.bind(this,7)),t.register_read(1159,this,this.port_pagehi_read.bind(this,0)),t.register_read(1155,this,this.port_pagehi_read.bind(this,1)),t.register_read(1153,this,this.port_pagehi_read.bind(this,2)),t.register_read(1154,this,this.port_pagehi_read.bind(this,3)),t.register_read(1163,this,this.port_pagehi_read.bind(this,5)),t.register_read(1161,this,this.port_pagehi_read.bind(this,6)),t.register_read(1162,this,this.port_pagehi_read.bind(this,7)),t.register_write(10,this,this.port_singlemask_write.bind(this,0)),t.register_write(212,this,this.port_singlemask_write.bind(this,4)),t.register_write(15,this,this.port_multimask_write.bind(this,0)),t.register_write(222,this,this.port_multimask_write.bind(this,4)),t.register_read(15,this,this.port_multimask_read.bind(this,0)),t.register_read(222,this,this.port_multimask_read.bind(this,4)),t.register_write(11,this,this.port_mode_write.bind(this,0)),t.register_write(214,this,this.port_mode_write.bind(this,4)),t.register_write(12,this,this.portC_write),t.register_write(216,this,this.portC_write)}function p(t){this.cpu=t,this.cmos_index=0,this.cmos_data=new Uint8Array(128),this.last_update=this.rtc_time=Date.now(),this.next_interrupt_alarm=this.next_interrupt=0,this.periodic_interrupt=!1,this.periodic_interrupt_time=.9765625,this.cmos_a=38,this.cmos_b=2,this.nmi_disabled=this.cmos_c=0,t.io.register_write(112,this,(function(t){this.cmos_index=127&t,this.nmi_disabled=t>>7})),t.io.register_write(113,this,this.cmos_port_write),t.io.register_read(113,this,this.cmos_port_read)}function f(t,e,i){if(this.io=t.io,this.cpu=t,this.dma=t.devices.dma,this.bytes_expecting=0,this.receiving_command=new Uint8Array(10),this.receiving_index=0,this.next_command=null,this.response_data=new Uint8Array(10),this.response_length=this.response_index=0,this.fda_image=e,this.fdb_image=i,this.last_head=this.last_cylinder=this.drive=this.status_reg2=this.status_reg1=this.status_reg0=0,this.last_sector=1,this.dor=0,e){var r={163840:{type:1,tracks:40,sectors:8,heads:1},184320:{type:1,tracks:40,sectors:9,heads:1},204800:{type:1,tracks:40,sectors:10,heads:1},327680:{type:1,tracks:40,sectors:8,heads:2},368640:{type:1,tracks:40,sectors:9,heads:2},409600:{type:1,tracks:40,sectors:10,heads:2},737280:{type:3,tracks:80,sectors:9,heads:2},1228800:{type:2,tracks:80,sectors:15,heads:2},1474560:{type:4,tracks:80,sectors:18,heads:2},1763328:{type:5,tracks:82,sectors:21,heads:2},2949120:{type:5,tracks:80,sectors:36,heads:2},512:{type:1,tracks:1,sectors:1,heads:1}};let s=e.byteLength;(i=r[s])||(s=1474560<e.byteLength?2949120:1474560,i=r[s],e.byteLength),t.devices.rtc.cmos_write(16,i.type<<4),t=i.sectors,e=i.heads,i=i.tracks,this.sectors_per_track=t,this.number_of_heads=e,this.number_of_cylinders=i}else t.devices.rtc.cmos_write(16,64),this.number_of_cylinders=this.number_of_heads=this.sectors_per_track=0;this.io.register_read(1008,this,this.port3F0_read),this.io.register_read(1010,this,this.port3F2_read),this.io.register_read(1012,this,this.port3F4_read),this.io.register_read(1013,this,this.port3F5_read),this.io.register_read(1015,this,this.port3F7_read),this.io.register_write(1010,this,this.port3F2_write),this.io.register_write(1013,this,this.port3F5_write)}function m(t,e,i,r,s,n){this.master=new g(this,t,e,r,s,0,n),this.slave=new g(this,t,i,!1,s,1,n),this.current_interface=this.master,this.cpu=t,0===s?(this.ata_port=496,this.irq=14,this.pci_id=240):1===s&&(this.ata_port=368,this.irq=15,this.pci_id=248),this.ata_port_high=516|this.ata_port,this.master_port=46080,this.pci_space=[134,128,16,112,5,0,160,2,0,128,1,1,0,0,0,0,255&this.ata_port|1,this.ata_port>>8,0,0,255&this.ata_port_high|1,this.ata_port_high>>8,0,0,0,0,0,0,0,0,0,0,255&this.master_port|1,this.master_port>>8,0,0,0,0,0,0,0,0,0,0,67,16,212,130,0,0,0,0,0,0,0,0,0,0,0,0,this.irq,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.pci_bars=[{size:8},{size:4},void 0,void 0,{size:16}],this.name="ide"+s,this.device_control=2,t.io.register_read(7|this.ata_port,this,(function(){return this.cpu.device_lower_irq(this.irq),this.read_status()})),t.io.register_read(2|this.ata_port_high,this,this.read_status),t.io.register_write(2|this.ata_port_high,this,this.write_control),t.io.register_read(0|this.ata_port,this,(function(){return this.current_interface.read_data(1)}),(function(){return this.current_interface.read_data(2)}),(function(){return this.current_interface.read_data(4)})),t.io.register_read(1|this.ata_port,this,(function(){return l(255&this.current_interface.error),this.current_interface,this.slave,255&this.current_interface.error})),t.io.register_read(2|this.ata_port,this,(function(){return l(255&this.current_interface.bytecount),255&this.current_interface.bytecount})),t.io.register_read(3|this.ata_port,this,(function(){return l(255&this.current_interface.sector),255&this.current_interface.sector})),t.io.register_read(4|this.ata_port,this,(function(){return l(255&this.current_interface.cylinder_low),255&this.current_interface.cylinder_low})),t.io.register_read(5|this.ata_port,this,(function(){return l(255&this.current_interface.cylinder_high),255&this.current_interface.cylinder_high})),t.io.register_read(6|this.ata_port,this,(function(){return 255&this.current_interface.drive_head})),t.io.register_write(0|this.ata_port,this,(function(t){this.current_interface.write_data_port8(t)}),(function(t){this.current_interface.write_data_port16(t)}),(function(t){this.current_interface.write_data_port32(t)})),t.io.register_write(1|this.ata_port,this,(function(t){l(t),this.master.lba_count=65535&(this.master.lba_count<<8|t),this.slave.lba_count=65535&(this.slave.lba_count<<8|t)})),t.io.register_write(2|this.ata_port,this,(function(t){l(t),this.master.bytecount=65535&(this.master.bytecount<<8|t),this.slave.bytecount=65535&(this.slave.bytecount<<8|t)})),t.io.register_write(3|this.ata_port,this,(function(t){l(t),this.master.sector=65535&(this.master.sector<<8|t),this.slave.sector=65535&(this.slave.sector<<8|t)})),t.io.register_write(4|this.ata_port,this,(function(t){l(t),this.master.cylinder_low=65535&(this.master.cylinder_low<<8|t),this.slave.cylinder_low=65535&(this.slave.cylinder_low<<8|t)})),t.io.register_write(5|this.ata_port,this,(function(t){l(t),this.master.cylinder_high=65535&(this.master.cylinder_high<<8|t),this.slave.cylinder_high=65535&(this.slave.cylinder_high<<8|t)})),t.io.register_write(6|this.ata_port,this,(function(t){var e=16&t;l(t,2),this.current_interface=e?this.slave:this.master,this.master.drive_head=t,this.slave.drive_head=t,this.master.is_lba=this.slave.is_lba=t>>6&1,this.master.head=this.slave.head=15&t})),this.dma_command=this.dma_status=this.prdt_addr=0,t.io.register_write(7|this.ata_port,this,(function(t){this.cpu.device_lower_irq(this.irq),this.current_interface.ata_command(t)})),t.io.register_read(4|this.master_port,this,void 0,void 0,this.dma_read_addr),t.io.register_write(4|this.master_port,this,void 0,void 0,this.dma_set_addr),t.io.register_read(this.master_port,this,this.dma_read_command8,void 0,this.dma_read_command),t.io.register_write(this.master_port,this,this.dma_write_command8,void 0,this.dma_write_command),t.io.register_read(2|this.master_port,this,this.dma_read_status),t.io.register_write(2|this.master_port,this,this.dma_write_status),t.io.register_read(8|this.master_port,this,(function(){return 0})),t.io.register_read(10|this.master_port,this,(function(){return 0})),t.devices.pci.register_device(this)}function g(t,e,i,r,s,n,a){this.device=t,this.bus=a,this.nr=s,this.cpu=e,this.buffer=i,this.sector_size=r?2048:512,this.is_atapi=r,this.cylinder_count=this.sectors_per_track=this.head_count=this.sector_count=0,this.buffer&&(this.sector_count=this.buffer.byteLength/this.sector_size,this.sector_count!==(0|this.sector_count)&&(this.sector_count=Math.ceil(this.sector_count)),r?(this.head_count=1,this.sectors_per_track=0):(this.head_count=16,this.sectors_per_track=63),this.cylinder_count=this.sector_count/this.head_count/this.sectors_per_track,this.cylinder_count!==(0|this.cylinder_count)&&(this.cylinder_count=Math.floor(this.cylinder_count)),(t=e.devices.rtc).cmos_write(57,t.cmos_read(57)|1<<4*this.nr),t.cmos_write(18,15&t.cmos_read(18)|240),t.cmos_write(27,255&this.cylinder_count),t.cmos_write(28,this.cylinder_count>>8&255),t.cmos_write(29,255&this.head_count),t.cmos_write(30,255),t.cmos_write(31,255),t.cmos_write(32,200),t.cmos_write(33,255&this.cylinder_count),t.cmos_write(34,this.cylinder_count>>8&255),t.cmos_write(35,255&this.sectors_per_track)),this.stats={sectors_read:0,sectors_written:0,bytes_read:0,bytes_written:0,loading:!1},this.buffer=i,this.drive_head=this.head=this.cylinder_high=this.cylinder_low=this.lba_count=this.sector=this.bytecount=this.is_lba=0,this.status=80,this.sectors_per_drq=128,this.data_pointer=this.error=0,this.data=new Uint8Array(65536),this.data16=new Uint16Array(this.data.buffer),this.data32=new Int32Array(this.data.buffer),this.data_end=this.data_length=0,this.current_atapi_command=this.current_command=-1,this.last_io_id=this.write_dest=0,this.in_progress_io_ids=new Set,this.cancelled_io_ids=new Set,Object.seal(this)}function y(t){this.ports=[],this.cpu=t;for(var e=0;65536>e;e++)this.ports[e]=this.create_empty_entry();var i=t.memory_size[0];for(e=0;e<<17<i;e++)t.memory_map_read8[e]=t.memory_map_write8[e]=void 0,t.memory_map_read32[e]=t.memory_map_write32[e]=void 0;this.mmap_register(i,4294967296-i,(function(t){return l(t>>>0,8),255}),(function(t,e){l(t>>>0,8),l(e,2)}),(function(t){return l(t>>>0,8),-1}),(function(t,e){l(t>>>0,8),l(e>>>0,8)}))}!function(){if("function"==typeof Math.clz32)o.int_log2_byte=function(t){return 31-Math.clz32(t)},o.int_log2=function(t){return 31-Math.clz32(t)};else{for(var t=new Int8Array(256),e=0,i=-2;256>e;e++)e&e-1||i++,t[e]=i;o.int_log2_byte=function(e){return t[e]},o.int_log2=function(e){var i=(e>>>=0)>>>16;if(i){var r=i>>>8;return r?24+t[r]:16+t[i]}return(r=e>>>8)?8+t[r]:t[e]}}}(),c.prototype.push=function(t){this.length===this.size?this.start=this.start+1&this.size-1:this.length++,this.data[this.end]=t,this.end=this.end+1&this.size-1},c.prototype.shift=function(){if(this.length){var t=this.data[this.start];return this.start=this.start+1&this.size-1,this.length--,t}},c.prototype.shift_block=function(t){var e=new Float32Array(t);t>this.length&&(t=this.length);var i=this.start+t,r=this.data.subarray(this.start,i);return e.set(r),i>=this.size&&(i-=this.size,e.set(this.data.subarray(0,i),r.length)),this.start=i,this.length-=t,e},c.prototype.peek=function(){if(this.length)return this.data[this.start]},c.prototype.clear=function(){this.length=this.end=this.start=0},d.prototype.add=function(t){this.data[this.index]=t,this.index=(this.index+1)%this.size},d.prototype.toArray=function(){return[].slice.call(this.data,this.index).concat([].slice.call(this.data,0,this.index))},d.prototype.clear=function(){this.data=[],this.index=0},d.prototype.set=function(t){this.data=t,this.index=0},o.Bitmap=function(t){"number"==typeof t?this.view=new Uint8Array(t+7>>3):t instanceof ArrayBuffer&&(this.view=new Uint8Array(t))},o.Bitmap.prototype.set=function(t,e){let i=t>>3;t=1<<(7&t),this.view[i]=e?this.view[i]|t:this.view[i]&~t},o.Bitmap.prototype.get=function(t){return this.view[t>>3]>>(7&t)&1},o.Bitmap.prototype.get_buffer=function(){return this.view.buffer},o.load_file="undefined"==typeof XMLHttpRequest?function(t,e){let r=i(919);e.range?r.open(t,"r",((t,i)=>{if(t)throw t;t=e.range.length;var s=Buffer.allocUnsafe(t);r.read(i,s,0,t,e.range.start,(t=>{if(t)throw t;e.done&&e.done(new Uint8Array(s)),r.close(i,(t=>{if(t)throw t}))}))})):r.readFile(t,{encoding:e.as_json?"utf-8":null},(function(i,r){i?console.log("Could not read file:",t,i):(i=r,i=e.as_json?JSON.parse(i):new Uint8Array(i).buffer,e.done(i))}))}:function t(e,i,r){function s(){let s=r||0;setTimeout((()=>{t(e,i,s+1)}),1e3*([1,1,2,3,5,8,13,21][s]||34))}var n=new XMLHttpRequest;if(n.open(i.method||"get",e,!0),n.responseType=i.as_json?"json":"arraybuffer",i.headers)for(var a=Object.keys(i.headers),o=0;o<a.length;o++){var l=a[o];n.setRequestHeader(l,i.headers[l])}i.range&&(a=i.range.start,n.setRequestHeader("Range","bytes="+a+"-"+(a+i.range.length-1)),n.onreadystatechange=function(){200===n.status&&n.abort()}),n.onload=function(){4===n.readyState&&(200!==n.status&&206!==n.status?(console.error("Loading the image "+e+" failed (status %d)",n.status),500<=n.status&&600>n.status&&s()):n.response&&i.done&&i.done(n.response,n))},n.onerror=function(t){console.error("Loading the image "+e+" failed",t),s()},i.progress&&(n.onprogress=function(t){i.progress(t)}),n.send(null)},o.read_sized_string_from_mem=function(t,e,i){return String.fromCharCode(...new Uint8Array(t.buffer,e>>>0,i>>>0))},_.prototype.get_state=function(){return[this.channel_page,this.channel_pagehi,this.channel_addr,this.channel_addr_init,this.channel_count,this.channel_count_init,this.channel_mask,this.channel_mode,this.lsb_msb_flipflop]},_.prototype.set_state=function(t){this.channel_page=t[0],this.channel_pagehi=t[1],this.channel_addr=t[2],this.channel_addr_init=t[3],this.channel_count=t[4],this.channel_count_init=t[5],this.channel_mask=t[6],this.channel_mode=t[7],this.lsb_msb_flipflop=t[8]},_.prototype.port_count_write=function(t,e){l(e),this.channel_count[t]=this.flipflop_get(this.channel_count[t],e,!1),this.channel_count_init[t]=this.flipflop_get(this.channel_count_init[t],e,!0)},_.prototype.port_count_read=function(t){return l(this.channel_count[t]),this.flipflop_read(this.channel_count[t])},_.prototype.port_addr_write=function(t,e){l(e),this.channel_addr[t]=this.flipflop_get(this.channel_addr[t],e,!1),this.channel_addr_init[t]=this.flipflop_get(this.channel_addr_init[t],e,!0)},_.prototype.port_addr_read=function(t){return l(this.channel_addr[t]),this.flipflop_read(this.channel_addr[t])},_.prototype.port_pagehi_write=function(t,e){l(e),this.channel_pagehi[t]=e},_.prototype.port_pagehi_read=function(t){return this.channel_pagehi[t]},_.prototype.port_page_write=function(t,e){l(e),this.channel_page[t]=e},_.prototype.port_page_read=function(t){return this.channel_page[t]},_.prototype.port_singlemask_write=function(t,e){t=(3&e)+t,e=4&e?1:0,this.update_mask(t,e)},_.prototype.port_multimask_write=function(t,e){l(e);for(var i=0;4>i;i++)this.update_mask(t+i,e&1<<i)},_.prototype.port_multimask_read=function(t){var e=0|this.channel_mask[t+0];return e|=this.channel_mask[t+1]<<1,e|=this.channel_mask[t+2]<<2,l(e|=this.channel_mask[t+3]<<3),e},_.prototype.port_mode_write=function(t,e){t=(3&e)+t,l(e),this.channel_mode[t]=e},_.prototype.portC_write=function(){this.lsb_msb_flipflop=0},_.prototype.on_unmask=function(t,e){this.unmask_listeners.push({fn:t,this_value:e})},_.prototype.update_mask=function(t,e){if(this.channel_mask[t]!==e&&(this.channel_mask[t]=e,!e))for(e=0;e<this.unmask_listeners.length;e++)this.unmask_listeners[e].fn.call(this.unmask_listeners[e].this_value,t)},_.prototype.do_read=function(t,e,i,r,s){var n=this.count_get_8bit(r),a=this.address_get_8bit(r);if(l(a),l(n),i<n&&(l(i),l(n)),e+n>t.byteLength)s(!0);else{var o=this.cpu;this.channel_addr[r]+=n,t.get(e,n,(function(t){o.write_blob(t,a),s(!1)}))}},_.prototype.do_write=function(t,e,i,r,s){var n=this.channel_count[r]+1&65535,a=5<=r?2:1,o=n*a,u=this.address_get_8bit(r),h=!1,c=!1,d=16&this.channel_mode[r];l(u),l(o),i<o?(n=Math.floor(i/a),o=n*a,h=!0):i>o&&(c=!0),e+o>t.byteLength?s(!0):(this.channel_addr[r]+=n,this.channel_count[r]-=n,!h&&d&&(this.channel_addr[r]=this.channel_addr_init[r],this.channel_count[r]=this.channel_count_init[r]),t.set(e,this.cpu.mem8.subarray(u,u+o),(()=>{c&&d?this.do_write(t,e+o,i-o,r,s):s(!1)})))},_.prototype.address_get_8bit=function(t){var e=this.channel_addr[t];return 5<=t&&(e<<=1),(e=65535&e|this.channel_page[t]<<16)|this.channel_pagehi[t]<<24},_.prototype.count_get_8bit=function(t){var e=this.channel_count[t]+1;return 5<=t&&(e*=2),e},_.prototype.flipflop_get=function(t,e,i){return i||(this.lsb_msb_flipflop^=1),this.lsb_msb_flipflop?-256&t|e:-65281&t|e<<8},_.prototype.flipflop_read=function(t){return(this.lsb_msb_flipflop^=1)?255&t:t>>8&255},p.prototype.get_state=function(){var t=[];return t[0]=this.cmos_index,t[1]=this.cmos_data,t[2]=this.rtc_time,t[3]=this.last_update,t[4]=this.next_interrupt,t[5]=this.next_interrupt_alarm,t[6]=this.periodic_interrupt,t[7]=this.periodic_interrupt_time,t[8]=this.cmos_a,t[9]=this.cmos_b,t[10]=this.cmos_c,t[11]=this.nmi_disabled,t},p.prototype.set_state=function(t){this.cmos_index=t[0],this.cmos_data=t[1],this.rtc_time=t[2],this.last_update=t[3],this.next_interrupt=t[4],this.next_interrupt_alarm=t[5],this.periodic_interrupt=t[6],this.periodic_interrupt_time=t[7],this.cmos_a=t[8],this.cmos_b=t[9],this.cmos_c=t[10],this.nmi_disabled=t[11]},p.prototype.timer=function(t){t=Date.now(),this.rtc_time+=t-this.last_update,this.last_update=t,this.periodic_interrupt&&this.next_interrupt<t?(this.cpu.device_raise_irq(8),this.cmos_c|=192,this.next_interrupt+=this.periodic_interrupt_time*Math.ceil((t-this.next_interrupt)/this.periodic_interrupt_time)):this.next_interrupt_alarm&&this.next_interrupt_alarm<t&&(this.cpu.device_raise_irq(8),this.cmos_c|=160,this.next_interrupt_alarm=0);let e=100;return this.periodic_interrupt&&this.next_interrupt&&(e=Math.min(e,Math.max(0,this.next_interrupt-t))),this.next_interrupt_alarm&&(e=Math.min(e,Math.max(0,this.next_interrupt_alarm-t))),e},p.prototype.bcd_pack=function(t){for(var e,i=0,r=0;t;)r|=(e=t%10)<<4*i,i++,t=(t-e)/10;return r},p.prototype.bcd_unpack=function(t){return(15&t)+10*(t>>4&15)},p.prototype.encode_time=function(t){return 4&this.cmos_b?t:this.bcd_pack(t)},p.prototype.decode_time=function(t){return 4&this.cmos_b?t:this.bcd_unpack(t)},p.prototype.cmos_port_read=function(){var t=this.cmos_index;switch(t){case 0:return this.encode_time(new Date(this.rtc_time).getUTCSeconds());case 2:return this.encode_time(new Date(this.rtc_time).getUTCMinutes());case 4:return this.encode_time(new Date(this.rtc_time).getUTCHours());case 7:return this.encode_time(new Date(this.rtc_time).getUTCDate());case 8:return this.encode_time(new Date(this.rtc_time).getUTCMonth()+1);case 9:return this.encode_time(new Date(this.rtc_time).getUTCFullYear()%100);case 10:return 999<=Y.microtick()%1e3?128|this.cmos_a:this.cmos_a;case 11:return this.cmos_b;case 12:return this.cpu.device_lower_irq(8),t=this.cmos_c,this.cmos_c&=-241,t;case 13:return 0;case 50:return this.encode_time(new Date(this.rtc_time).getUTCFullYear()/100|0);default:return l(t),this.cmos_data[this.cmos_index]}},p.prototype.cmos_port_write=function(t){switch(this.cmos_index){case 10:this.cmos_a=127&t,this.periodic_interrupt_time=1e3/(32768>>(15&this.cmos_a)-1),l(this.cmos_a,2),this.periodic_interrupt_time;break;case 11:if(this.cmos_b=t,64&this.cmos_b&&(this.next_interrupt=Date.now()),32&this.cmos_b){t=new Date;let e=this.decode_time(this.cmos_data[1]),i=this.decode_time(this.cmos_data[3]),r=this.decode_time(this.cmos_data[5]),s=new Date(Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),r,i,e));this.next_interrupt_alarm=+s}this.cmos_b,l(this.cmos_b,2);break;case 1:case 3:case 5:this.cmos_write(this.cmos_index,t);break;default:l(this.cmos_index),l(t)}this.periodic_interrupt=64==(64&this.cmos_b)&&0<(15&this.cmos_a)},p.prototype.cmos_read=function(t){return this.cmos_data[t]},p.prototype.cmos_write=function(t,e){l(t),l(e),this.cmos_data[t]=e},f.prototype.get_state=function(){var t=[];return t[0]=this.bytes_expecting,t[1]=this.receiving_command,t[2]=this.receiving_index,t[4]=this.response_data,t[5]=this.response_index,t[6]=this.response_length,t[8]=this.status_reg0,t[9]=this.status_reg1,t[10]=this.status_reg2,t[11]=this.drive,t[12]=this.last_cylinder,t[13]=this.last_head,t[14]=this.last_sector,t[15]=this.dor,t[16]=this.sectors_per_track,t[17]=this.number_of_heads,t[18]=this.number_of_cylinders,t},f.prototype.set_state=function(t){this.bytes_expecting=t[0],this.receiving_command=t[1],this.receiving_index=t[2],this.next_command=t[3],this.response_data=t[4],this.response_index=t[5],this.response_length=t[6],this.status_reg0=t[8],this.status_reg1=t[9],this.status_reg2=t[10],this.drive=t[11],this.last_cylinder=t[12],this.last_head=t[13],this.last_sector=t[14],this.dor=t[15],this.sectors_per_track=t[16],this.number_of_heads=t[17],this.number_of_cylinders=t[18]},f.prototype.port3F0_read=function(){return 0},f.prototype.port3F4_read=function(){var t=128;return this.response_index<this.response_length&&(t|=80),0==(8&this.dor)&&(t|=32),t},f.prototype.port3F7_read=function(){return 0},f.prototype.port3F5_read=function(){return this.response_index<this.response_length?(this.response_data[this.response_index],this.cpu.device_lower_irq(6),this.response_data[this.response_index++]):255},f.prototype.port3F5_write=function(t){if(this.fda_image)if(l(t),0<this.bytes_expecting)this.receiving_command[this.receiving_index++]=t,this.bytes_expecting--,0===this.bytes_expecting&&this.next_command.call(this,this.receiving_command);else{switch(t){case 3:this.next_command=this.fix_drive_data,this.bytes_expecting=2;break;case 4:this.next_command=this.check_drive_status,this.bytes_expecting=1;break;case 5:case 69:case 197:this.next_command=function(t){this.do_sector(!0,t)},this.bytes_expecting=8;break;case 230:this.next_command=function(t){this.do_sector(!1,t)},this.bytes_expecting=8;break;case 7:this.next_command=this.calibrate,this.bytes_expecting=1;break;case 8:this.check_interrupt_status();break;case 74:this.next_command=this.read_sector_id,this.bytes_expecting=1;break;case 15:this.bytes_expecting=2,this.next_command=this.seek;break;case 14:this.response_data[0]=128,this.response_index=0,this.response_length=1,this.bytes_expecting=0;break;default:l(t)}this.receiving_index=0}},f.prototype.port3F2_read=function(){return this.dor},f.prototype.port3F2_write=function(t){4==(4&t)&&0==(4&this.dor)&&this.cpu.device_raise_irq(6),l(t>>4),l(t),this.dor=t},f.prototype.check_drive_status=function(){this.response_index=0,this.response_length=1,this.response_data[0]=32},f.prototype.seek=function(t){this.last_cylinder=t[1],this.last_head=t[0]>>2&1,this.raise_irq()},f.prototype.calibrate=function(){this.raise_irq()},f.prototype.check_interrupt_status=function(){this.response_index=0,this.response_length=2,this.response_data[0]=32,this.response_data[1]=this.last_cylinder},f.prototype.do_sector=function(t,e){var i=e[2],r=e[1],s=e[3],n=128<<e[4],a=e[5]-e[3]+1,o=((i+this.number_of_heads*r)*this.sectors_per_track+s-1)*n;l(o),l(a*n),e[4],this.fda_image&&(t?this.dma.do_write(this.fda_image,o,a*n,2,this.done.bind(this,e,r,i,s)):this.dma.do_read(this.fda_image,o,a*n,2,this.done.bind(this,e,r,i,s)))},f.prototype.done=function(t,e,i,r,s){s||(++r>this.sectors_per_track&&(r=1,++i>=this.number_of_heads&&(i=0,e++)),this.last_cylinder=e,this.last_head=i,this.last_sector=r,this.response_index=0,this.response_length=7,this.response_data[0]=i<<2|32,this.response_data[1]=0,this.response_data[2]=0,this.response_data[3]=e,this.response_data[4]=i,this.response_data[5]=r,this.response_data[6]=t[4],this.raise_irq())},f.prototype.fix_drive_data=function(t){},f.prototype.read_sector_id=function(t){this.response_index=0,this.response_length=7,this.response_data[0]=0,this.response_data[1]=0,this.response_data[2]=0,this.response_data[3]=0,this.response_data[4]=0,this.response_data[5]=0,this.response_data[6]=0,this.raise_irq()},f.prototype.raise_irq=function(){8&this.dor&&this.cpu.device_raise_irq(6)},m.prototype.read_status=function(){if(this.current_interface.buffer){var t=this.current_interface.status;return l(t,2),t}return 0},m.prototype.write_control=function(t){l(t,2),4&t&&(this.cpu.device_lower_irq(this.irq),this.master.device_reset(),this.slave.device_reset()),this.device_control=t},m.prototype.dma_read_addr=function(){return l(this.prdt_addr,8),this.prdt_addr},m.prototype.dma_set_addr=function(t){l(t,8),this.prdt_addr=t},m.prototype.dma_read_status=function(){return l(this.dma_status),this.dma_status},m.prototype.dma_write_status=function(t){l(t),this.dma_status&=~(6&t)},m.prototype.dma_read_command=function(){return this.dma_read_command8()|this.dma_read_status()<<16},m.prototype.dma_read_command8=function(){return l(this.dma_command),this.dma_command},m.prototype.dma_write_command=function(t){l(t),this.dma_write_command8(255&t),this.dma_write_status(t>>16&255)},m.prototype.dma_write_command8=function(t){l(t);let e=this.dma_command;if(this.dma_command=9&t,(1&e)!=(1&t))if(0==(1&t))this.dma_status&=-2;else switch(this.dma_status|=1,this.current_interface.current_command){case 37:case 200:this.current_interface.do_ata_read_sectors_dma();break;case 202:case 53:this.current_interface.do_ata_write_sectors_dma();break;case 160:this.current_interface.do_atapi_dma();break;default:l(this.current_interface.current_command)}},m.prototype.push_irq=function(){0==(2&this.device_control)&&(this.dma_status|=4,this.cpu.device_raise_irq(this.irq))},m.prototype.get_state=function(){var t=[];return t[0]=this.master,t[1]=this.slave,t[2]=this.ata_port,t[3]=this.irq,t[4]=this.pci_id,t[5]=this.ata_port_high,t[6]=this.master_port,t[7]=this.name,t[8]=this.device_control,t[9]=this.prdt_addr,t[10]=this.dma_status,t[11]=this.current_interface===this.master,t[12]=this.dma_command,t},m.prototype.set_state=function(t){this.master.set_state(t[0]),this.slave.set_state(t[1]),this.ata_port=t[2],this.irq=t[3],this.pci_id=t[4],this.ata_port_high=t[5],this.master_port=t[6],this.name=t[7],this.device_control=t[8],this.prdt_addr=t[9],this.dma_status=t[10],this.current_interface=t[11]?this.master:this.slave,this.dma_command=t[12]},g.prototype.device_reset=function(){this.is_atapi?(this.status=0,this.sector=this.error=this.bytecount=1,this.cylinder_low=20,this.cylinder_high=235):(this.status=81,this.sector=this.error=this.bytecount=1,this.cylinder_high=this.cylinder_low=0),this.cancel_io_operations()},g.prototype.push_irq=function(){this.device.push_irq()},g.prototype.ata_command=function(t){if(l(t),this.drive_head,this.buffer)switch(this.current_command=t,this.error=0,t){case 8:this.data_length=this.data_end=this.data_pointer=0,this.device_reset(),this.push_irq();break;case 16:this.status=80,this.cylinder_low=0,this.push_irq();break;case 248:this.status=80,t=this.sector_count-1,this.sector=255&t,this.cylinder_low=t>>8&255,this.cylinder_high=t>>16&255,this.drive_head=240&this.drive_head|t>>24&15,this.push_irq();break;case 39:this.status=80,t=this.sector_count-1,this.sector=255&t,this.cylinder_low=t>>8&255,this.cylinder_high=t>>16&255,this.sector|=t>>24<<8&65280,this.push_irq();break;case 32:case 36:case 41:case 196:this.ata_read_sectors(t);break;case 48:case 52:case 57:case 197:this.ata_write_sectors(t);break;case 144:this.push_irq(),this.error=257,this.status=80;break;case 145:case 64:case 224:case 225:case 231:case 234:case 222:case 245:this.status=80,this.push_irq();break;case 160:this.is_atapi&&(this.status=88,this.data_allocate(12),this.data_end=12,this.bytecount=1,this.push_irq());break;case 161:this.is_atapi?(this.create_identify_packet(),this.status=88,this.cylinder_low=20,this.cylinder_high=235):this.status=65,this.push_irq();break;case 198:l(255&this.bytecount),this.sectors_per_drq=255&this.bytecount,this.status=80,this.push_irq();break;case 37:case 200:this.ata_read_sectors_dma(t);break;case 53:case 202:this.ata_write_sectors_dma(t);break;case 218:this.status=65,this.error=4,this.push_irq();break;case 236:if(this.is_atapi){this.status=65,this.error=4,this.push_irq();break}this.create_identify_packet(),this.status=88,this.push_irq();break;case 239:l(255&this.bytecount),this.status=80,this.push_irq();break;case 249:this.status=65,this.error=4;break;default:l(t),this.status=65,this.error=4}else this.error=4,this.status=65,this.push_irq()},g.prototype.atapi_handle=function(){switch(l(this.data[0]),this.drive_head,this.data_pointer=0,this.current_atapi_command=this.data[0],this.current_atapi_command){case 0:case 30:case 81:this.data_allocate(0),this.data_end=this.data_length,this.status=80;break;case 3:this.data_allocate(this.data[4]),this.data_end=this.data_length,this.status=88,this.data[0]=240,this.data[2]=5,this.data[7]=8;break;case 18:var t=this.data[4];this.status=88,l(this.data[1],2),this.data.set([5,128,1,49,31,0,0,0,83,79,78,89,32,32,32,32,67,68,45,82,79,77,32,67,68,85,45,49,48,48,48,32,49,46,49,97]),this.data_end=this.data_length=Math.min(36,t);break;case 26:this.data_allocate(this.data[4]),this.data_end=this.data_length,this.status=88;break;case 37:t=this.sector_count-1,this.data_set(new Uint8Array([t>>24&255,t>>16&255,t>>8&255,255&t,0,0,this.sector_size>>8&255,255&this.sector_size])),this.data_end=this.data_length,this.status=88;break;case 40:1&this.lba_count?this.atapi_read_dma(this.data):this.atapi_read(this.data);break;case 66:t=this.data[8],this.data_allocate(Math.min(8,t)),this.data_end=this.data_length,this.status=88;break;case 67:t=this.data[8]|this.data[7]<<8;var e=this.data[9]>>6;this.data_allocate(t),this.data_end=this.data_length,l(e,2),this.data[1],l(this.data[6]),0===e?(t=this.sector_count,this.data.set(new Uint8Array([0,18,1,1,0,20,1,0,0,0,0,0,0,22,170,0,t>>24,t>>16&255,t>>8&255,255&t]))):1===e&&this.data.set(new Uint8Array([0,10,1,1,0,0,0,0,0,0,0,0])),this.status=88;break;case 70:t=this.data[8]|this.data[7]<<8,t=Math.min(t,32),this.data_allocate(t),this.data_end=this.data_length,this.data[0]=t-4>>24&255,this.data[1]=t-4>>16&255,this.data[2]=t-4>>8&255,this.data[3]=t-4&255,this.data[6]=8,this.data[10]=3,this.status=88;break;case 82:l(this.data[0]),this.status=81,this.data_length=0,this.error=80;break;case 90:t=this.data[8]|this.data[7]<<8,l(e=this.data[2]),42===e&&this.data_allocate(Math.min(30,t)),this.data_end=this.data_length,this.status=88;break;case 189:this.data_allocate(this.data[9]|this.data[8]<<8),this.data_end=this.data_length,this.data[5]=1,this.status=88;break;case 74:default:this.status=81,this.data_length=0,this.error=80,l(this.data[0]);break;case 190:l(this.data[0]),this.data_allocate(0),this.data_end=this.data_length,this.status=80}this.bytecount=-8&this.bytecount|2,0==(128&this.status)&&this.push_irq(),0==(128&this.status)&&0===this.data_length&&(this.bytecount|=1,this.status&=-9)},g.prototype.do_write=function(){this.status=80;var t=this.data.subarray(0,this.data_length);this.ata_advance(this.current_command,this.data_length/512),this.push_irq(),this.buffer.set(this.write_dest,t,(function(){})),this.report_write(this.data_length)},g.prototype.atapi_read=function(t){var e=t[2]<<24|t[3]<<16|t[4]<<8|t[5],i=t[7]<<8|t[8];t=t[1];var r=i*this.sector_size,s=e*this.sector_size;l(e),l(i),l(r),l(t),this.data_length=0;var n=this.cylinder_high<<8&65280|255&this.cylinder_low;l(this.cylinder_high,2),l(this.cylinder_low,2),this.cylinder_low=this.cylinder_high=0,65535===n&&n--,n>r&&(n=r),s>=this.buffer.byteLength?(l(s+r),l(this.buffer.byteLength),this.status=255,this.push_irq()):0===r?(this.status=80,this.data_pointer=0):(r=Math.min(r,this.buffer.byteLength-s),this.status=208,this.report_read_start(),this.read_buffer(s,r,(t=>{this.data_set(t),this.status=88,this.bytecount=-8&this.bytecount|2,this.push_irq(),this.data_end=n&=-4,this.data_end>this.data_length&&(this.data_end=this.data_length),this.cylinder_low=255&this.data_end,this.cylinder_high=this.data_end>>8&255,this.report_read_end(r)})))},g.prototype.atapi_read_dma=function(t){var e=t[2]<<24|t[3]<<16|t[4]<<8|t[5],i=t[7]<<8|t[8];t=t[1];var r=i*this.sector_size,s=e*this.sector_size;l(e),l(i),l(r),l(t),s>=this.buffer.byteLength?(l(s+r),l(this.buffer.byteLength),this.status=255,this.push_irq()):(this.status=208,this.report_read_start(),this.read_buffer(s,r,(t=>{this.report_read_end(r),this.status=88,this.bytecount=-8&this.bytecount|2,this.data_set(t),this.do_atapi_dma()})))},g.prototype.do_atapi_dma=function(){if(0==(1&this.device.dma_status));else if(0==(8&this.status));else{this.data_length;var t=this.device.prdt_addr,e=0,i=this.data;do{var r=this.cpu.read32s(t),s=this.cpu.read16(t+4),n=128&this.cpu.read8(t+7);if(s||(s=65536),l(r),l(s),l(this.data_length),this.cpu.write_blob(i.subarray(e,Math.min(e+s,this.data_length)),r),t+=8,(e+=s)>=this.data_length&&!n){l(e),l(this.data_length),l(this.current_command);break}}while(!n);this.status=80,this.device.dma_status&=-2,this.bytecount=-8&this.bytecount|3,this.push_irq()}},g.prototype.read_data=function(t){if(this.data_pointer<this.data_end){l(this.data_pointer);var e=1===t?this.data[this.data_pointer]:2===t?this.data16[this.data_pointer>>>1]:this.data32[this.data_pointer>>>2];return this.data_pointer+=t,0==(this.data_pointer&(0==(4095&this.data_end)?4095:255))&&(l(this.data[this.data_pointer],2),l(this.data_pointer),l(this.data_length)),this.data_pointer>=this.data_end&&this.read_end(),e}return this.data_pointer+=t,0},g.prototype.read_end=function(){if(l(this.current_command),l(this.data_pointer),l(this.data_end),l(this.data_length),160===this.current_command)if(this.data_end===this.data_length)this.status=80,this.bytecount=-8&this.bytecount|3,this.push_irq();else{this.status=88,this.bytecount=-8&this.bytecount|2,this.push_irq();var t=this.cylinder_high<<8&65280|255&this.cylinder_low;this.data_end+t>this.data_length?(this.cylinder_low=this.data_length-this.data_end&255,this.cylinder_high=this.data_length-this.data_end>>8&255,this.data_end=this.data_length):this.data_end+=t,l(this.data_end)}else this.error=0,this.data_pointer>=this.data_length?this.status=80:(t=196===this.current_command||41===this.current_command?Math.min(this.sectors_per_drq,(this.data_length-this.data_end)/512):1,this.ata_advance(this.current_command,t),this.data_end+=512*t,this.status=88),this.push_irq()},g.prototype.write_data_port=function(t,e){this.data_pointer>=this.data_end?(l(t),l(this.data_end),l(this.data_pointer)):((0==(this.data_pointer+e&(0==(4095&this.data_end)?4095:255))||20>this.data_end)&&(l(t>>>0),l(this.data_end),l(this.data_pointer)),1===e?this.data[this.data_pointer++]=t:2===e?(this.data16[this.data_pointer>>>1]=t,this.data_pointer+=2):(this.data32[this.data_pointer>>>2]=t,this.data_pointer+=4),this.data_pointer===this.data_end&&this.write_end())},g.prototype.write_data_port8=function(t){this.write_data_port(t,1)},g.prototype.write_data_port16=function(t){this.write_data_port(t,2)},g.prototype.write_data_port32=function(t){this.write_data_port(t,4)},g.prototype.write_end=function(){160===this.current_command?this.atapi_handle():(l(this.data_pointer),l(this.data_length),this.data_pointer>=this.data_length?this.do_write():(l(this.current_command),this.status=88,this.data_end+=512,this.push_irq()))},g.prototype.ata_advance=function(t,e){this.bytecount,this.bytecount-=e,36===t||41===t||52===t||57===t||37===t||53===t?(t=e+this.get_lba48(),this.sector=255&t|t>>16&65280,this.cylinder_low=t>>8&255,this.cylinder_high=t>>16&255):this.is_lba?(t=e+this.get_lba28(),this.sector=255&t,this.cylinder_low=t>>8&255,this.cylinder_high=t>>16&255,this.head=-16&this.head|15&t):(e=(t=e+this.get_chs())/(this.head_count*this.sectors_per_track)|0,this.cylinder_low=255&e,this.cylinder_high=e>>8&255,this.head=(t/this.sectors_per_track|0)%this.head_count&15,this.sector=t%this.sectors_per_track+1&255,this.get_chs())},g.prototype.ata_read_sectors=function(t){var e=36===t||41===t,i=this.get_count(e);e=this.get_lba(e);var r=32===t||36===t,s=i*this.sector_size,n=e*this.sector_size;l(t),this.is_lba,l(e),l(i),l(s),n+s>this.buffer.byteLength?(this.status=255,this.push_irq()):(this.status=192,this.report_read_start(),this.read_buffer(n,s,(e=>{this.data_set(e),this.status=88,this.data_end=r?512:Math.min(s,512*this.sectors_per_drq),this.ata_advance(t,r?1:Math.min(i,this.sectors_per_track)),this.push_irq(),this.report_read_end(s)})))},g.prototype.ata_read_sectors_dma=function(t){var e=37===t;t=this.get_count(e),e=this.get_lba(e);var i=t*this.sector_size,r=e*this.sector_size;l(e),l(t),l(i),r+i>this.buffer.byteLength?(this.status=255,this.push_irq()):(this.status=88,this.device.dma_status|=1)},g.prototype.do_ata_read_sectors_dma=function(){var t=37===this.current_command,e=this.get_count(t);t=this.get_lba(t);var i=e*this.sector_size;t*=this.sector_size,this.report_read_start(),this.device.prdt_addr,this.read_buffer(t,i,(t=>{var r=this.device.prdt_addr,s=0;do{var n=this.cpu.read32s(r),a=this.cpu.read16(r+4),o=128&this.cpu.read8(r+7);a||(a=65536),l(n),l(a),this.cpu.write_blob(t.subarray(s,s+a),n),s+=a,r+=8}while(!o);this.ata_advance(this.current_command,e),this.status=80,this.device.dma_status&=-2,this.current_command=-1,this.push_irq(),this.report_read_end(i)}))},g.prototype.ata_write_sectors=function(t){var e=52===t||57===t,i=this.get_count(e);e=this.get_lba(e),t=48===t||52===t;var r=i*this.sector_size,s=e*this.sector_size;l(e),this.is_lba,l(i),l(r),s+r>this.buffer.byteLength?(this.status=255,this.push_irq()):(this.status=88,this.data_allocate_noclear(r),this.data_end=t?512:Math.min(r,512*this.sectors_per_drq),this.write_dest=s)},g.prototype.ata_write_sectors_dma=function(t){var e=53===t;t=this.get_count(e),e=this.get_lba(e);var i=t*this.sector_size,r=e*this.sector_size;l(e),l(t),l(i),r+i>this.buffer.byteLength?(this.status=255,this.push_irq()):(this.status=88,this.device.dma_status|=1)},g.prototype.do_ata_write_sectors_dma=function(){var t=53===this.current_command,e=this.get_count(t),i=this.get_lba(t);t=e*this.sector_size,i*=this.sector_size;var r=this.device.prdt_addr,s=0;l(r,8);let n=new Uint8Array(t);do{var a=this.cpu.read32s(r),o=this.cpu.read16(r+4),u=128&this.cpu.read8(r+7);o||(o=65536),l(a),l(o),a=this.cpu.mem8.subarray(a,a+o),n.set(a,s),s+=o,r+=8}while(!u);this.buffer.set(i,n,(()=>{this.ata_advance(this.current_command,e),this.status=80,this.push_irq(),this.device.dma_status&=-2,this.current_command=-1})),this.report_write(t)},g.prototype.get_chs=function(){var t=255&this.cylinder_low|this.cylinder_high<<8&65280,e=this.head,i=255&this.sector;return(t*this.head_count+e)*this.sectors_per_track+i-1},g.prototype.get_lba28=function(){return 255&this.sector|this.cylinder_low<<8&65280|this.cylinder_high<<16&16711680|(15&this.head)<<24},g.prototype.get_lba48=function(){return(255&this.sector|this.cylinder_low<<8&65280|this.cylinder_high<<16&16711680|this.sector>>8<<24&4278190080)>>>0},g.prototype.get_lba=function(t){return t?this.get_lba48():this.is_lba?this.get_lba28():this.get_chs()},g.prototype.get_count=function(t){return t?0===(t=this.bytecount)&&(t=65536):0===(t=255&this.bytecount)&&(t=256),t},g.prototype.create_identify_packet=function(){if(16&this.drive_head)this.data_allocate(0);else{for(var t=0;512>t;t++)this.data[t]=0;t=Math.min(16383,this.cylinder_count),this.data_set([64,this.is_atapi?133:0,t,t>>8,0,0,this.head_count,this.head_count>>8,this.sectors_per_track/512,this.sectors_per_track/512>>8,0,2,this.sectors_per_track,this.sectors_per_track>>8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,2,4,0,0,0,0,0,0,0,0,0,56,118,32,54,68,72,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,128,0,1,0,0,2,0,0,0,2,0,2,7,0,t,t>>8,this.head_count,this.head_count>>8,this.sectors_per_track,0,255&this.sector_count,this.sector_count>>8&255,this.sector_count>>16&255,this.sector_count>>24&255,0,0,255&this.sector_count,this.sector_count>>8&255,this.sector_count>>16&255,this.sector_count>>24&255,0,0,160===this.current_command?0:7,160===this.current_command?0:4,0,0,30,0,30,0,30,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,126,0,0,0,0,0,0,116,0,64,0,64,0,116,0,64,0,0,0,0,0,0,0,0,0,0,1,96,0,0,0,0,0,0,0,0,0,0,0,0,255&this.sector_count,this.sector_count>>8&255,this.sector_count>>16&255,this.sector_count>>24&255]),this.data_end=this.data_length=512}},g.prototype.data_allocate=function(t){this.data_allocate_noclear(t);for(var e=0;e<t+3>>2;e++)this.data32[e]=0},g.prototype.data_allocate_noclear=function(t){this.data.length<t&&(this.data=new Uint8Array(t+3&-4),this.data16=new Uint16Array(this.data.buffer),this.data32=new Int32Array(this.data.buffer)),this.data_length=t,this.data_pointer=0},g.prototype.data_set=function(t){this.data_allocate_noclear(t.length),this.data.set(t)},g.prototype.report_read_start=function(){this.stats.loading=!0,this.bus.send("ide-read-start")},g.prototype.report_read_end=function(t){this.stats.loading=!1;var e=t/this.sector_size|0;this.stats.sectors_read+=e,this.stats.bytes_read+=t,this.bus.send("ide-read-end",[this.nr,t,e])},g.prototype.report_write=function(t){var e=t/this.sector_size|0;this.stats.sectors_written+=e,this.stats.bytes_written+=t,this.bus.send("ide-write-end",[this.nr,t,e])},g.prototype.read_buffer=function(t,e,i){let r=this.last_io_id++;this.in_progress_io_ids.add(r),this.buffer.get(t,e,(t=>{this.cancelled_io_ids.delete(r)?this.in_progress_io_ids.has(r):(this.in_progress_io_ids.delete(r),i(t))}))},g.prototype.cancel_io_operations=function(){for(let t of this.in_progress_io_ids)this.cancelled_io_ids.add(t);this.in_progress_io_ids.clear()},g.prototype.get_state=function(){var t=[];return t[0]=this.bytecount,t[1]=this.cylinder_count,t[2]=this.cylinder_high,t[3]=this.cylinder_low,t[4]=this.data_pointer,t[5]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=this.drive_head,t[10]=this.error,t[11]=this.head,t[12]=this.head_count,t[13]=this.is_atapi,t[14]=this.is_lba,t[15]=this.lba_count,t[16]=this.data,t[17]=this.data_length,t[18]=this.sector,t[19]=this.sector_count,t[20]=this.sector_size,t[21]=this.sectors_per_drq,t[22]=this.sectors_per_track,t[23]=this.status,t[24]=this.write_dest,t[25]=this.current_command,t[26]=this.data_end,t[27]=this.current_atapi_command,t[28]=this.buffer,t},g.prototype.set_state=function(t){this.bytecount=t[0],this.cylinder_count=t[1],this.cylinder_high=t[2],this.cylinder_low=t[3],this.data_pointer=t[4],this.drive_head=t[9],this.error=t[10],this.head=t[11],this.head_count=t[12],this.is_atapi=t[13],this.is_lba=t[14],this.lba_count=t[15],this.data=t[16],this.data_length=t[17],this.sector=t[18],this.sector_count=t[19],this.sector_size=t[20],this.sectors_per_drq=t[21],this.sectors_per_track=t[22],this.status=t[23],this.write_dest=t[24],this.current_command=t[25],this.data_end=t[26],this.current_atapi_command=t[27],this.data16=new Uint16Array(this.data.buffer),this.data32=new Int32Array(this.data.buffer),this.buffer&&this.buffer.set_state(t[28])},y.prototype.create_empty_entry=function(){return{read8:this.empty_port_read8,read16:this.empty_port_read16,read32:this.empty_port_read32,write8:this.empty_port_write,write16:this.empty_port_write,write32:this.empty_port_write,device:void 0}},y.prototype.empty_port_read8=function(){return 255},y.prototype.empty_port_read16=function(){return 65535},y.prototype.empty_port_read32=function(){return-1},y.prototype.empty_port_write=function(){},y.prototype.register_read=function(t,e,i,r,s){i&&(this.ports[t].read8=i),r&&(this.ports[t].read16=r),s&&(this.ports[t].read32=s),this.ports[t].device=e},y.prototype.register_write=function(t,e,i,r,s){i&&(this.ports[t].write8=i),r&&(this.ports[t].write16=r),s&&(this.ports[t].write32=s),this.ports[t].device=e},y.prototype.register_read_consecutive=function(t,e,i,r,s,n){function a(){return i.call(this)|r.call(this)<<8}s&&n?(this.register_read(t,e,i,a,(function(){return i.call(this)|r.call(this)<<8|s.call(this)<<16|n.call(this)<<24})),this.register_read(t+1,e,r),this.register_read(t+2,e,s,(function(){return s.call(this)|n.call(this)<<8})),this.register_read(t+3,e,n)):(this.register_read(t,e,i,a),this.register_read(t+1,e,r))},y.prototype.register_write_consecutive=function(t,e,i,r,s,n){function a(t){i.call(this,255&t),r.call(this,t>>8&255)}s&&n?(this.register_write(t,e,i,a,(function(t){i.call(this,255&t),r.call(this,t>>8&255),s.call(this,t>>16&255),n.call(this,t>>>24)})),this.register_write(t+1,e,r),this.register_write(t+2,e,s,(function(t){s.call(this,255&t),n.call(this,t>>8&255)})),this.register_write(t+3,e,n)):(this.register_write(t,e,i,a),this.register_write(t+1,e,r))},y.prototype.mmap_read32_shim=function(t){var e=this.cpu.memory_map_read8[t>>>17];return e(t)|e(t+1)<<8|e(t+2)<<16|e(t+3)<<24},y.prototype.mmap_write32_shim=function(t,e){var i=this.cpu.memory_map_write8[t>>>17];i(t,255&e),i(t+1,e>>8&255),i(t+2,e>>16&255),i(t+3,e>>>24)},y.prototype.mmap_register=function(t,e,i,r,s,n){for(l(t>>>0,8),l(e,8),s||(s=this.mmap_read32_shim.bind(this)),n||(n=this.mmap_write32_shim.bind(this)),t>>>=17;0<e;t++)this.cpu.memory_map_read8[t]=i,this.cpu.memory_map_write8[t]=r,this.cpu.memory_map_read32[t]=s,this.cpu.memory_map_write32[t]=n,e-=131072},y.prototype.port_write8=function(t,e){var i=this.ports[t];return i.write8===this.empty_port_write&&(l(t,4),l(e,2),this.get_port_description(t)),i.write8.call(i.device,e)},y.prototype.port_write16=function(t,e){var i=this.ports[t];return i.write16===this.empty_port_write&&(l(t,4),l(e,4),this.get_port_description(t)),i.write16.call(i.device,e)},y.prototype.port_write32=function(t,e){var i=this.ports[t];return i.write32===this.empty_port_write&&(l(t,4),l(e>>>0,8),this.get_port_description(t)),i.write32.call(i.device,e)},y.prototype.port_read8=function(t){var e=this.ports[t];return e.read8===this.empty_port_read8&&(l(t,4),this.get_port_description(t)),e=e.read8.call(e.device),l(t),e},y.prototype.port_read16=function(t){var e=this.ports[t];return e.read16===this.empty_port_read16&&(l(t,4),this.get_port_description(t)),e=e.read16.call(e.device),l(t),e},y.prototype.port_read32=function(t){var e=this.ports[t];return e.read32===this.empty_port_read32&&(l(t,4),this.get_port_description(t)),e.read32.call(e.device)};var b={4:"PORT_DMA_ADDR_2",5:"PORT_DMA_CNT_2",10:"PORT_DMA1_MASK_REG",11:"PORT_DMA1_MODE_REG",12:"PORT_DMA1_CLEAR_FF_REG",13:"PORT_DMA1_MASTER_CLEAR",32:"PORT_PIC1_CMD",33:"PORT_PIC1_DATA",64:"PORT_PIT_COUNTER0",65:"PORT_PIT_COUNTER1",66:"PORT_PIT_COUNTER2",67:"PORT_PIT_MODE",96:"PORT_PS2_DATA",97:"PORT_PS2_CTRLB",100:"PORT_PS2_STATUS",112:"PORT_CMOS_INDEX",113:"PORT_CMOS_DATA",128:"PORT_DIAG",129:"PORT_DMA_PAGE_2",146:"PORT_A20",160:"PORT_PIC2_CMD",161:"PORT_PIC2_DATA",178:"PORT_SMI_CMD",179:"PORT_SMI_STATUS",212:"PORT_DMA2_MASK_REG",214:"PORT_DMA2_MODE_REG",218:"PORT_DMA2_MASTER_CLEAR",240:"PORT_MATH_CLEAR",368:"PORT_ATA2_CMD_BASE",496:"PORT_ATA1_CMD_BASE",632:"PORT_LPT2",744:"PORT_SERIAL4",760:"PORT_SERIAL2",884:"PORT_ATA2_CTRL_BASE",888:"PORT_LPT1",1e3:"PORT_SERIAL3",1008:"PORT_FD_BASE",1010:"PORT_FD_DOR",1012:"PORT_FD_STATUS",1013:"PORT_FD_DATA",1014:"PORT_HD_DATA",1015:"PORT_FD_DIR",1016:"PORT_SERIAL1",3320:"PORT_PCI_CMD",3321:"PORT_PCI_REBOOT",3324:"PORT_PCI_DATA",1026:"PORT_BIOS_DEBUG",1296:"PORT_QEMU_CFG_CTL",1297:"PORT_QEMU_CFG_DATA",45056:"PORT_ACPI_PM_BASE",45312:"PORT_SMB_BASE",35072:"PORT_BIOS_APM"};function v(t){this.cpu=t,this.ioredtbl_config=new Int32Array(24),this.ioredtbl_destination=new Int32Array(24);for(var e=0;e<this.ioredtbl_config.length;e++)this.ioredtbl_config[e]=65536;this.irq_value=this.irr=this.ioapic_id=this.ioregsel=0,dbg_assert(32<=MMAP_BLOCK_SIZE),t.io.mmap_register(4273995776,MMAP_BLOCK_SIZE,(t=>16<=(t=t-4273995776|0)&&20>t?(t-=16,dbg_log("ioapic read8 byte "+t+" "+h(this.ioregsel),LOG_APIC),this.read(this.ioregsel)>>8*t&255):(dbg_log("Unexpected IOAPIC register read: "+h(t>>>0),LOG_APIC),dbg_assert(!1),0)),(t=>{dbg_assert(!1,"unsupported write8 from ioapic: "+h(t>>>0))}),(t=>0===(t=t-4273995776|0)?this.ioregsel:16===t?this.read(this.ioregsel):(dbg_log("Unexpected IOAPIC register read: "+h(t>>>0),LOG_APIC),dbg_assert(!1),0)),((t,e)=>{0===(t=t-4273995776|0)?this.ioregsel=e:16===t?this.write(this.ioregsel,e):(dbg_log("Unexpected IOAPIC register write: "+h(t>>>0)+" <- "+h(e>>>0,8),LOG_APIC),dbg_assert(!1))}))}function w(t,e,i){t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5]),t[6]===e[0]&&t[7]===e[1]&&t[8]===e[2]&&t[9]===e[3]&&t[10]===e[4]&&t[11]===e[5]&&(t[6]=i[0],t[7]=i[1],t[8]=i[2],t[9]=i[3],t[10]=i[4],t[11]=i[5]);var r=t[12]<<8|t[13];if(2048===r){if(4!==(r=(t=t.subarray(14))[0]>>4));else if(t[0],17===t[9]){r=(t=t.subarray(20))[0]<<8|t[1];var s=t[2]<<8|t[3];if(l(t[6]<<8|t[7],4),67===r||67===s)if(1669485411!==(s=(r=t.subarray(8))[236]<<24|r[237]<<16|r[238]<<8|r[239]))l(s,8);else for(r[28]===e[0]&&r[29]===e[1]&&r[30]===e[2]&&r[31]===e[3]&&r[32]===e[4]&&r[33]===e[5]&&(r[28]=i[0],r[29]=i[1],r[30]=i[2],r[31]=i[3],r[32]=i[4],r[33]=i[5],t[6]=t[7]=0),s=240;s<r.length;){let n=r[s++];if(255===n)break;let a=r[s++];61===n&&1===r[s+0]&&r[s+1]===e[0]&&r[s+2]===e[1]&&r[s+3]===e[2]&&r[s+4]===e[3]&&r[s+5]===e[4]&&r[s+6]===e[5]&&(r[s+1]=i[0],r[s+2]=i[1],r[s+3]=i[2],r[s+4]=i[3],r[s+5]=i[4],r[s+6]=i[5],t[6]=t[7]=0),s+=a}}}else 2054===r&&((t=t.subarray(14))[7],k(t.subarray(8,14)),k(t.subarray(18,24)),t[8]===e[0]&&t[9]===e[1]&&t[10]===e[2]&&t[11]===e[3]&&t[12]===e[4]&&t[13]===e[5]&&(t[8]=i[0],t[9]=i[1],t[10]=i[2],t[11]=i[3],t[12]=i[4],t[13]=i[5]))}function k(t){return[t[0].toString(16).padStart(2,"0"),t[1].toString(16).padStart(2,"0"),t[2].toString(16).padStart(2,"0"),t[3].toString(16).padStart(2,"0"),t[4].toString(16).padStart(2,"0"),t[5].toString(16).padStart(2,"0")].join(":")}function x(t,e,i,r){for(this.cpu=t,this.pci=t.devices.pci,this.preserve_mac_from_state_image=i,this.mac_address_translation=r,this.bus=e,this.bus.register("net0-receive",(function(t){this.receive(t)}),this),this.port=768,this.name="ne2k",this.pci_space=[236,16,41,128,3,1,0,0,0,0,0,2,0,0,0,0,255&this.port|1,this.port>>8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,244,26,0,17,0,0,184,254,0,0,0,0,0,0,0,0,0,1,0,0],this.pci_id=40,this.pci_bars=[{size:32}],this.imr=this.isr=0,this.cr=1,this.tpsr=this.tcnt=this.rcnt=this.dcfg=0,this.memory=new Uint8Array(32768),this.txcr=this.rxcr=0,this.tsr=1,this.mac=new Uint8Array([0,34,21,255*Math.random()|0,255*Math.random()|0,255*Math.random()|0]),this.mac_address_in_state=null,e=0;6>e;e++)this.memory[e<<1]=this.memory[e<<1|1]=this.mac[e];this.memory[28]=this.memory[29]=87,this.memory[30]=this.memory[31]=87,k(this.mac),this.rsar=0,this.pstart=64,this.pstop=128,this.boundary=this.curpg=76,(e=t.io).register_read(0|this.port,this,(function(){return this.cr})),e.register_write(0|this.port,this,(function(t){this.cr=t,l(t,2),this.cr,l(this.txcr,2),1&this.cr||(24&t&&0===this.rcnt&&this.do_interrupt(64),4&t&&(t=this.tpsr<<8,t=this.memory.subarray(t,t+this.tcnt),this.mac_address_in_state&&w(t=new Uint8Array(t),this.mac_address_in_state,this.mac),this.bus.send("net0-send",t),this.bus.send("eth-transmit-end",[t.length]),this.cr&=-5,this.do_interrupt(2),l(t.byteLength)))})),e.register_read(13|this.port,this,(function(){return 0})),e.register_read(14|this.port,this,(function(){return 0}),(function(){return 0})),e.register_read(15|this.port,this,(function(){return 0})),e.register_read(31|this.port,this,(function(){return this.get_page(),this.do_interrupt(128),0})),e.register_write(31|this.port,this,(function(t){this.get_page(),l(t,2)})),e.register_read(1|this.port,this,(function(){var t=this.get_page();return 0===t?this.pstart:1===t?this.mac[0]:2===t?this.pstart:0})),e.register_write(1|this.port,this,(function(t){var e=this.get_page();0===e?(l(t,2),this.pstart=t):1===e?(l(t),this.mac[0]=t):l(t)})),e.register_read(2|this.port,this,(function(){var t=this.get_page();return 0===t?this.pstop:1===t?this.mac[1]:2===t?this.pstop:0})),e.register_write(2|this.port,this,(function(t){var e=this.get_page();0===e?(l(t,2),t>this.memory.length>>8&&l(t=this.memory.length>>8),this.pstop=t):1===e?(l(t),this.mac[1]=t):l(t)})),e.register_read(7|this.port,this,(function(){var t=this.get_page();return 0===t?(l(this.isr,2),this.isr):1===t?(l(this.curpg,2),this.curpg):void 0})),e.register_write(7|this.port,this,(function(t){var e=this.get_page();0===e?(l(t,2),this.isr&=~t,this.update_irq()):1===e&&(l(t,2),this.curpg=t)})),e.register_write(13|this.port,this,(function(t){0===this.get_page()?(this.txcr=t,l(t,2)):l(t,2)})),e.register_write(14|this.port,this,(function(t){0===this.get_page()?(l(t,2),this.dcfg=t):l(t,2)})),e.register_read(10|this.port,this,(function(){return 0===this.get_page()?80:0})),e.register_write(10|this.port,this,(function(t){0===this.get_page()?(l(t,2),this.rcnt=65280&this.rcnt|255&t):l(t,2)})),e.register_read(11|this.port,this,(function(){return 0===this.get_page()?67:0})),e.register_write(11|this.port,this,(function(t){0===this.get_page()?(l(t,2),this.rcnt=255&this.rcnt|t<<8&65280):l(t,2)})),e.register_read(8|this.port,this,(function(){if(0===this.get_page())return 255&this.rsar})),e.register_write(8|this.port,this,(function(t){0===this.get_page()?(l(t,2),this.rsar=65280&this.rsar|255&t):l(t,2)})),e.register_read(9|this.port,this,(function(){if(0===this.get_page())return this.rsar>>8&255})),e.register_write(9|this.port,this,(function(t){0===this.get_page()?(l(t,2),this.rsar=255&this.rsar|t<<8&65280):l(t,2)})),e.register_write(15|this.port,this,(function(t){0===this.get_page()?(l(t,2),l(this.isr,2),this.imr=t,this.update_irq()):l(t,2)})),e.register_read(3|this.port,this,(function(){var t=this.get_page();return 0===t?(l(this.boundary,2),this.boundary):1===t?this.mac[2]:0})),e.register_write(3|this.port,this,(function(t){var e=this.get_page();0===e?(l(t,2),this.boundary=t):1===e?(l(t),this.mac[2]=t):l(t)})),e.register_read(4|this.port,this,(function(){var t=this.get_page();return 0===t?this.tsr:1===t?this.mac[3]:0})),e.register_write(4|this.port,this,(function(t){var e=this.get_page();0===e?(l(t,2),this.tpsr=t):1===e?(l(t),this.mac[3]=t):l(t)})),e.register_read(5|this.port,this,(function(){var t=this.get_page();return 0===t?0:1===t?this.mac[4]:0})),e.register_write(5|this.port,this,(function(t){var e=this.get_page();0===e?(l(t,2),this.tcnt=-256&this.tcnt|t):1===e?(l(t),this.mac[4]=t):l(t)})),e.register_read(6|this.port,this,(function(){var t=this.get_page();return 0===t?0:1===t?this.mac[5]:0})),e.register_write(6|this.port,this,(function(t){var e=this.get_page();0===e?(l(t,2),this.tcnt=255&this.tcnt|t<<8):1===e?(l(t),this.mac[5]=t):l(t)})),e.register_read(12|this.port,this,(function(){return 0===this.get_page()?9:0})),e.register_write(12|this.port,this,(function(t){0===this.get_page()?(l(t,2),this.rxcr=t):l(t)})),e.register_read(16|this.port,this,this.data_port_read8,this.data_port_read16,this.data_port_read32),e.register_write(16|this.port,this,this.data_port_write16,this.data_port_write16,this.data_port_write32),t.devices.pci.register_device(this)}function C(t){this.pci_addr=new Uint8Array(4),this.pci_value=new Uint8Array(4),this.pci_response=new Uint8Array(4),this.pci_status=new Uint8Array(4),this.pci_addr32=new Int32Array(this.pci_addr.buffer),this.pci_value32=new Int32Array(this.pci_value.buffer),this.pci_response32=new Int32Array(this.pci_response.buffer),this.pci_status32=new Int32Array(this.pci_status.buffer),this.device_spaces=[],this.devices=[],this.cpu=t;for(var e=0;256>e;e++)this.device_spaces[e]=void 0,this.devices[e]=void 0;this.io=t.io,t.io.register_write(3324,this,(function(t){this.pci_write8(this.pci_addr32[0],t)}),(function(t){this.pci_write16(this.pci_addr32[0],t)}),(function(t){this.pci_write32(this.pci_addr32[0],t)})),t.io.register_write(3325,this,(function(t){this.pci_write8(this.pci_addr32[0]+1|0,t)})),t.io.register_write(3326,this,(function(t){this.pci_write8(this.pci_addr32[0]+2|0,t)}),(function(t){this.pci_write16(this.pci_addr32[0]+2|0,t)})),t.io.register_write(3327,this,(function(t){this.pci_write8(this.pci_addr32[0]+3|0,t)})),t.io.register_read_consecutive(3324,this,(function(){return this.pci_response[0]}),(function(){return this.pci_response[1]}),(function(){return this.pci_response[2]}),(function(){return this.pci_response[3]})),t.io.register_read_consecutive(3320,this,(function(){return this.pci_status[0]}),(function(){return this.pci_status[1]}),(function(){return this.pci_status[2]}),(function(){return this.pci_status[3]})),t.io.register_write_consecutive(3320,this,(function(t){this.pci_addr[0]=252&t}),(function(e){2==(6&this.pci_addr[1])&&6==(6&e)?t.reboot_internal():this.pci_addr[1]=e}),(function(t){this.pci_addr[2]=t}),(function(t){this.pci_addr[3]=t,this.pci_query()})),this.register_device({pci_id:0,pci_space:[134,128,55,18,0,0,0,0,2,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,0,0,0,0,0,0],pci_bars:[],name:"82441FX PMC"}),this.isa_bridge={pci_id:8,pci_space:[134,128,0,112,7,0,0,2,0,0,1,6,0,0,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],pci_bars:[],name:"82371SB PIIX3 ISA"},this.isa_bridge_space=this.register_device(this.isa_bridge),this.isa_bridge_space8=new Uint8Array(this.isa_bridge_space.buffer)}function S(t,e){this.irq_value=this.irr=this.isr=this.irq_map=this.irq_mask=0,this.requested_irq=-1,this.master=e,this.is_master=void 0===this.master,this.slave=void 0,this.name=this.is_master?"master":"slave ",this.expect_icw4=!1,this.read_isr=this.state=0,this.auto_eoi=1,this.elcr=this.special_mask_mode=0,this.cpu=t,this.is_master?(this.slave=new S(this.cpu,this),this.check_irqs=function(){if(0<=this.requested_irq)this.cpu.handle_irqs();else{var t=this.irr&this.irq_mask;if(t){t&=-t;var e=this.special_mask_mode?this.irq_mask:-1;this.isr&&(this.isr&-this.isr&e)<=t?(l(this.isr,2),l(255&this.irq_mask,2),l(t,2)):(this.requested_irq=o.int_log2_byte(t),this.cpu.handle_irqs())}}},this.acknowledge_irq=function(){if(-1!==this.requested_irq)if(0===this.irr)this.requested_irq=-1;else{var t=1<<this.requested_irq;0==(this.elcr&t)&&(this.irr&=~t),this.auto_eoi||(this.isr|=t),2===this.requested_irq?this.slave.acknowledge_irq():this.cpu.pic_call_irq(this.irq_map|this.requested_irq),this.requested_irq=-1,this.check_irqs()}}):(this.check_irqs=function(){if(0<=this.requested_irq)this.cpu.handle_irqs();else{var t=this.irr&this.irq_mask;if(t){t&=-t;var e=this.special_mask_mode?this.irq_mask:-1;this.isr&&(this.isr&-this.isr&e)<=t||(this.requested_irq=o.int_log2_byte(t),this.master.set_irq(2))}}},this.acknowledge_irq=function(){if(-1!==this.requested_irq)if(0===this.irr)this.requested_irq=-1,this.master.irq_value&=-5,this.cpu.pic_call_irq(7|this.irq_map);else{var t=1<<this.requested_irq;0==(this.elcr&t)&&(this.irr&=~t),this.auto_eoi||(this.isr|=t),this.master.irq_value&=-5,this.cpu.pic_call_irq(this.irq_map|this.requested_irq),this.requested_irq=-1,this.check_irqs()}}),this.dump=function(){l(255&this.irq_mask),l(this.irq_map),l(this.irr),l(this.isr),this.is_master&&this.slave.dump()},this.is_master?(t=32,e=1232):(t=160,e=1233),this.cpu.io.register_write(t,this,this.port20_write),this.cpu.io.register_read(t,this,this.port20_read),this.cpu.io.register_write(1|t,this,this.port21_write),this.cpu.io.register_read(1|t,this,this.port21_read),this.cpu.io.register_write(e,this,this.port4D0_write),this.cpu.io.register_read(e,this,this.port4D0_read),this.is_master?(this.set_irq=function(t){8<=t?this.slave.set_irq(t-8):(t=1<<t,0==(this.irq_value&t)&&(this.irr|=t,this.irq_value|=t,this.check_irqs()))},this.clear_irq=function(t){8<=t?this.slave.clear_irq(t-8):(t=1<<t,this.irq_value&t&&(this.irq_value&=~t,this.irr&=~t,this.check_irqs()))}):(this.set_irq=function(t){t=1<<t,0==(this.irq_value&t)&&(this.irr|=t,this.irq_value|=t,this.check_irqs())},this.clear_irq=function(t){t=1<<t,this.irq_value&t&&(this.irq_value&=~t,this.irr&=~t,this.check_irqs())}),this.get_isr=function(){return this.isr}}function A(t,e){this.cpu=t,this.bus=e,this.counter_start_time=new Float64Array(3),this.counter_start_value=new Uint16Array(3),this.counter_next_low=new Uint8Array(4),this.counter_enabled=new Uint8Array(4),this.counter_mode=new Uint8Array(4),this.counter_read_mode=new Uint8Array(4),this.counter_latch=new Uint8Array(4),this.counter_latch_value=new Uint16Array(3),this.counter_reload=new Uint16Array(3),t.io.register_read(97,this,(function(){var t=Y.microtick();return(66.66666666666667*t&1)<<4|(t=this.did_rollover(2,t))<<5})),t.io.register_write(97,this,(function(t){1&t?this.bus.send("pcspeaker-enable"):this.bus.send("pcspeaker-disable")})),t.io.register_read(64,this,(function(){return this.counter_read(0)})),t.io.register_read(65,this,(function(){return this.counter_read(1)})),t.io.register_read(66,this,(function(){return this.counter_read(2)})),t.io.register_write(64,this,(function(t){this.counter_write(0,t)})),t.io.register_write(65,this,(function(t){this.counter_write(1,t)})),t.io.register_write(66,this,(function(t){this.counter_write(2,t),this.bus.send("pcspeaker-update",[this.counter_mode[2],this.counter_reload[2]])})),t.io.register_write(67,this,this.port43_write)}function E(t,e){this.cpu=t,this.bus=e,this.use_mouse=this.enable_mouse_stream=!1,this.have_mouse=!0,this.mouse_clicks=this.mouse_delta_y=this.mouse_delta_x=0,this.have_keyboard=!0,this.next_read_resolution=this.next_read_rate=this.next_handle_scan_code_set=this.next_read_led=this.next_read_sample=this.next_is_mouse_command=this.enable_keyboard_stream=!1,this.kbd_buffer=new u(1024),this.last_port60_byte=0,this.sample_rate=100,this.mouse_id=this.mouse_detect_state=0,this.mouse_reset_workaround=!1,this.wheel_movement=0,this.resolution=4,this.scaling2=!1,this.last_mouse_packet=-1,this.mouse_buffer=new u(1024),this.next_byte_is_aux=this.next_byte_is_ready=!1,this.bus.register("keyboard-code",(function(t){this.kbd_send_code(t)}),this),this.bus.register("mouse-click",(function(t){this.mouse_send_click(t[0],t[1],t[2])}),this),this.bus.register("mouse-delta",(function(t){this.mouse_send_delta(t[0],t[1])}),this),this.bus.register("mouse-wheel",(function(t){this.wheel_movement-=t[0],this.wheel_movement-=2*t[1],this.wheel_movement=Math.min(7,Math.max(-8,this.wheel_movement)),this.send_mouse_packet(0,0)}),this),this.command_register=5,this.controller_output_port=0,this.read_controller_output_port=this.read_command_register=this.read_output_register=!1,t.io.register_read(96,this,this.port60_read),t.io.register_read(100,this,this.port64_read),t.io.register_write(96,this,this.port60_write),t.io.register_write(100,this,this.port64_write)}y.prototype.get_port_description=function(t){return b[t]?"  ("+b[t]+")":""},v.prototype.remote_eoi=function(t){for(var e=0;24>e;e++){var i=this.ioredtbl_config[e];(255&i)===t&&16384&i&&(dbg_log("Clear remote IRR for irq="+h(e),LOG_APIC),this.ioredtbl_config[e]&=-16385,this.check_irq(e))}},v.prototype.check_irq=function(t){var e=1<<t;if(0!=(this.irr&e)){var i=this.ioredtbl_config[t];if(0==(65536&i)){var r=i>>8&7,s=i>>11&1,n=255&i,a=this.ioredtbl_destination[t]>>>24,o=32768==(32768&i);if(0==(32768&i))this.irr&=~e;else if(this.ioredtbl_config[t]|=16384,16384&i)return void dbg_log("No route: level interrupt and remote IRR still set",LOG_APIC);0===r||1===r?this.cpu.devices.apic.route(n,r,o,a,s):dbg_assert(!1,"TODO"),this.ioredtbl_config[t]&=-4097}}},v.prototype.set_irq=function(t){if(24<=t)dbg_assert(!1,"Bad irq: "+t,LOG_APIC);else{var e=1<<t;0==(this.irq_value&e)&&(APIC_LOG_VERBOSE&&dbg_log("apic set irq "+t,LOG_APIC),this.irq_value|=e,65536!=(98304&this.ioredtbl_config[t])&&(this.irr|=e,this.check_irq(t)))}},v.prototype.clear_irq=function(t){if(24<=t)dbg_assert(!1,"Bad irq: "+t,LOG_APIC);else{var e=1<<t;(this.irq_value&e)===e&&(this.irq_value&=~e,32768&this.ioredtbl_config[t]&&(this.irr&=~e))}},v.prototype.read=function(t){if(0===t)return dbg_log("IOAPIC Read id",LOG_APIC),this.ioapic_id<<24;if(1===t)return dbg_log("IOAPIC Read version",LOG_APIC),1507345;if(2===t)return dbg_log("IOAPIC Read arbitration id",LOG_APIC),this.ioapic_id<<24;if(16<=t&&64>t){var e=t-16>>1;return 1&t?(t=this.ioredtbl_destination[e],dbg_log("IOAPIC Read destination irq="+h(e)+" -> "+h(t,8),LOG_APIC)):(t=this.ioredtbl_config[e],dbg_log("IOAPIC Read config irq="+h(e)+" -> "+h(t,8),LOG_APIC)),t}return dbg_log("IOAPIC register read outside of range "+h(t),LOG_APIC),dbg_assert(!1),0},v.prototype.write=function(t,e){if(0===t)this.ioapic_id=e>>>24&15;else if(1===t||2===t)dbg_log("Invalid write: "+t,LOG_APIC);else if(16<=t&&64>t){var i=t-16>>1;if(1&t)this.ioredtbl_destination[i]=4278190080&e,dbg_log("Write destination "+h(e>>>0,8)+" irq="+h(i)+" dest="+h(e>>>24,2),LOG_APIC);else{this.ioredtbl_config[i]=110591&e|-110592&this.ioredtbl_config[i],t=255&e;var r=e>>8&7,s=e>>11&1,n=e>>15&1,a=e>>16&1;dbg_log("Write config "+h(e>>>0,8)+" irq="+h(i)+" vector="+h(t,2)+" deliverymode="+DELIVERY_MODES[r]+" destmode="+DESTINATION_MODES[s]+" is_level="+n+" disabled="+a,LOG_APIC),this.check_irq(i)}}else dbg_log("IOAPIC register write outside of range "+h(t)+": "+h(e>>>0,8),LOG_APIC),dbg_assert(!1)},v.prototype.get_state=function(){var t=[];return t[0]=this.ioredtbl_config,t[1]=this.ioredtbl_destination,t[2]=this.ioregsel,t[3]=this.ioapic_id,t[4]=this.irr,t[5]=this.irq_value,t},v.prototype.set_state=function(t){this.ioredtbl_config=t[0],this.ioredtbl_destination=t[1],this.ioregsel=t[2],this.ioapic_id=t[3],this.irr=t[4],this.irq_value=t[5]},x.prototype.get_state=function(){var t=[];return t[0]=this.isr,t[1]=this.imr,t[2]=this.cr,t[3]=this.dcfg,t[4]=this.rcnt,t[5]=this.tcnt,t[6]=this.tpsr,t[7]=this.rsar,t[8]=this.pstart,t[9]=this.curpg,t[10]=this.boundary,t[11]=this.pstop,t[12]=this.rxcr,t[13]=this.txcr,t[14]=this.tsr,t[15]=this.mac,t[16]=this.memory,t},x.prototype.set_state=function(t){this.isr=t[0],this.imr=t[1],this.cr=t[2],this.dcfg=t[3],this.rcnt=t[4],this.tcnt=t[5],this.tpsr=t[6],this.rsar=t[7],this.pstart=t[8],this.curpg=t[9],this.boundary=t[10],this.pstop=t[11],this.rxcr=t[12],this.txcr=t[13],this.tsr=t[14],this.preserve_mac_from_state_image?(this.mac=t[15],this.memory=t[16]):this.mac_address_translation&&(this.mac_address_in_state=t[15],this.memory=t[16],k(this.mac_address_in_state),k(this.mac))},x.prototype.do_interrupt=function(t){l(t,2),this.isr|=t,this.update_irq()},x.prototype.update_irq=function(){this.imr&this.isr?this.pci.raise_irq(this.pci_id):this.pci.lower_irq(this.pci_id)},x.prototype.data_port_write=function(t){(16>=this.rsar||16384<=this.rsar&&32768>this.rsar)&&(this.memory[this.rsar]=t),this.rsar++,this.rcnt--,this.rsar>=this.pstop<<8&&(this.rsar+=this.pstart-this.pstop<<8),0===this.rcnt&&this.do_interrupt(64)},x.prototype.data_port_write16=function(t){this.data_port_write(t),1&this.dcfg&&this.data_port_write(t>>8)},x.prototype.data_port_write32=function(t){this.data_port_write(t),this.data_port_write(t>>8),this.data_port_write(t>>16),this.data_port_write(t>>24)},x.prototype.data_port_read=function(){let t=0;return 32768>this.rsar&&(t=this.memory[this.rsar]),this.rsar++,this.rcnt--,this.rsar>=this.pstop<<8&&(this.rsar+=this.pstart-this.pstop<<8),0===this.rcnt&&this.do_interrupt(64),t},x.prototype.data_port_read8=function(){return 255&this.data_port_read16()},x.prototype.data_port_read16=function(){return 1&this.dcfg?this.data_port_read()|this.data_port_read()<<8:this.data_port_read()},x.prototype.data_port_read32=function(){return this.data_port_read()|this.data_port_read()<<8|this.data_port_read()<<16|this.data_port_read()<<24},x.prototype.receive=function(t){if(!(1&this.cr)&&(this.bus.send("eth-receive-end",[t.length]),16&this.rxcr||4&this.rxcr&&255===t[0]&&255===t[1]&&255===t[2]&&255===t[3]&&255===t[4]&&255===t[5]||!(8&this.rxcr&&1==(1&t[0])||t[0]!==this.mac[0]||t[1]!==this.mac[1]||t[2]!==this.mac[2]||t[3]!==this.mac[3]||t[4]!==this.mac[4]||t[5]!==this.mac[5]))){this.mac_address_in_state&&w(t=new Uint8Array(t),this.mac,this.mac_address_in_state);var e=this.curpg<<8,i=Math.max(60,t.length)+4,r=e+4,s=this.curpg+1+(i>>8),n=e+i,a=1+(i>>8),o=this.boundary>this.curpg?this.boundary-this.curpg:this.pstop-this.curpg+this.boundary-this.pstart;o<a&&0!==this.boundary?(l(this.pstart),l(this.pstop),l(this.curpg),l(a),l(this.boundary),l(o)):(n>this.pstop<<8?(n=(this.pstop<<8)-r,this.memory.set(t.subarray(0,n),r),this.memory.set(t.subarray(n),this.pstart<<8),l(n)):(this.memory.set(t,r),60>t.length&&this.memory.fill(0,r+t.length,r+60)),s>=this.pstop&&(s+=this.pstart-this.pstop),this.memory[e]=1,this.memory[e+1]=s,this.memory[e+2]=i,this.memory[e+3]=i>>8,this.curpg=s,l(e),l(i),l(s),this.do_interrupt(1))}},x.prototype.get_page=function(){return this.cr>>6&3},C.prototype.get_state=function(){for(var t=[],e=0;256>e;e++)t[e]=this.device_spaces[e];return t[256]=this.pci_addr,t[257]=this.pci_value,t[258]=this.pci_response,t[259]=this.pci_status,t},C.prototype.set_state=function(t){for(var e=0;256>e;e++){var i=this.devices[e],r=t[e];if(i&&r){for(var s=0;s<i.pci_bars.length;s++){var n=r[4+s];if(1&n){var a=i.pci_bars[s];this.set_io_bars(a,65534&a.original_bar,65534&n)}}this.device_spaces[e].set(r)}else i&&i.name,r&&l(e,2)}this.pci_addr.set(t[256]),this.pci_value.set(t[257]),this.pci_response.set(t[258]),this.pci_status.set(t[259])},C.prototype.pci_query=function(){var t=this.pci_addr[2]<<8|this.pci_addr[1],e=252&this.pci_addr[0],i=t>>3&31;this.pci_addr[3],l(t,4),l(i,2),l(e,2),void 0!==(i=this.device_spaces[t])?(this.pci_status32[0]=-2147483648,this.pci_response32[0]=e<i.byteLength?i[e>>2]:0,l(this.pci_addr32[0]>>>0,8),l(this.pci_response32[0]>>>0,8),i.byteLength,this.devices[t].name):(this.pci_response32[0]=-1,this.pci_status32[0]=0)},C.prototype.pci_write8=function(t,e){var i=t>>8&65535;t&=255;var r=new Uint8Array(this.device_spaces[i].buffer),s=this.devices[i];r&&(l(t),l(i>>3,2),s.name,l(t,4),l(e,2),r[t]=e)},C.prototype.pci_write16=function(t,e){var i=t>>8&65535;t&=255;var r=new Uint16Array(this.device_spaces[i].buffer),s=this.devices[i];r&&(16<=t&&44>t?l(t):(l(t),l(i>>3,2),s.name,l(t,4),l(e,4),r[t>>>1]=e))},C.prototype.pci_write32=function(t,e){var i=t>>8&65535;t&=255;var r=this.device_spaces[i],s=this.devices[i];if(r)if(16<=t&&40>t){var n=t-16>>2,a=s.pci_bars[n];l(e>>>0),l(i>>3,2),s.name,a?(s=1&r[i=t>>2],-1==(3|e|a.size-1)?(e=~(a.size-1)|s,0===s&&(r[i]=e)):0===s&&(n=a.original_bar,r[i]=n),1===s&&(n=65534&e,l((s=65534&r[i])>>>0,8),l(n>>>0,8),a.size,this.set_io_bars(a,s,n),r[i]=1|e)):r[t>>2]=0,l(r[t>>2]>>>0)}else 48===t?(l(i>>3,2),s.name,l(e>>>0,8),r[t>>2]=s.pci_rom_size?-1==(2047|e)?0|-s.pci_rom_size:0|s.pci_rom_address:0):4===t?(l(i>>3,2),s.name,l(t,4),l(e>>>0,8)):(l(i>>3,2),s.name,l(t,4),l(e>>>0,8),r[t>>>2]=e)},C.prototype.register_device=function(t){var e=t.pci_id;l(e),t.name;var i=new Int32Array(64);i.set(new Int32Array(new Uint8Array(t.pci_space).buffer)),this.device_spaces[e]=i,this.devices[e]=t,e=i.slice(4,10);for(var r=0;r<t.pci_bars.length;r++){var s=t.pci_bars[r];if(s){var n=e[r],a=1&n;if(s.original_bar=n,s.entries=[],0!==a)for(n&=-2,a=0;a<s.size;a++)s.entries[a]=this.io.ports[n+a]}}return i},C.prototype.set_io_bars=function(t,e,i){var r=t.size;l(e),l(i);for(var s=this.io.ports,n=0;n<r;n++){var a=s[e+n];4096<=e+n&&(s[e+n]=this.io.create_empty_entry()),a.read8===this.io.empty_port_read8&&a.read16===this.io.empty_port_read16&&a.read32===this.io.empty_port_read32&&a.write8===this.io.empty_port_write&&a.write16===this.io.empty_port_write&&a.write32===this.io.empty_port_write&&l(e+n,4),a=t.entries[n];var o=s[i+n];4096<=i+n&&(s[i+n]=a),o.read8!==this.io.empty_port_read8&&o.read16!==this.io.empty_port_read16&&o.read32!==this.io.empty_port_read32&&o.write8!==this.io.empty_port_write&&o.write16!==this.io.empty_port_write&&o.write32!==this.io.empty_port_write||l(i+n,4)}},C.prototype.raise_irq=function(t){this.cpu.device_raise_irq(this.isa_bridge_space8[96+((this.device_spaces[t][15]>>8&255)-1+((t>>3)-1&255)&3)])},C.prototype.lower_irq=function(t){this.cpu.device_lower_irq(this.isa_bridge_space8[96+((this.device_spaces[t][15]>>8&255)+(t>>3&255)-2&3)])},S.prototype.get_state=function(){var t=[];return t[0]=this.irq_mask,t[1]=this.irq_map,t[2]=this.isr,t[3]=this.irr,t[4]=this.is_master,t[5]=this.slave,t[6]=this.expect_icw4,t[7]=this.state,t[8]=this.read_isr,t[9]=this.auto_eoi,t[10]=this.elcr,t},S.prototype.set_state=function(t){this.irq_mask=t[0],this.irq_map=t[1],this.isr=t[2],this.irr=t[3],this.is_master=t[4],this.slave&&this.slave.set_state(t[5]),this.expect_icw4=t[6],this.state=t[7],this.read_isr=t[8],this.auto_eoi=t[9],this.elcr=t[10]},S.prototype.port20_write=function(t){if(16&t)l(t),this.irq_value=this.irq_mask=this.irr=this.isr=0,this.auto_eoi=1,this.requested_irq=-1,this.expect_icw4=1&t,this.state=1;else if(8&t)l(t),2&t&&(this.read_isr=1&t),64&t&&(this.special_mask_mode=32==(32&t),this.special_mask_mode);else{l(t),this.name;var e=t>>5;1===e?(this.isr&=this.isr-1,l(this.isr,2)):3===e?this.isr&=~(1<<(7&t)):192==(200&t)?l(7&t):(l(t),this.isr&=this.isr-1),this.check_irqs()}},S.prototype.port20_read=function(){return this.read_isr?(l(this.isr),this.isr):(l(this.irr),this.irr)},S.prototype.port21_write=function(t){0===this.state?this.expect_icw4?(this.expect_icw4=!1,this.auto_eoi=2&t,l(t),this.auto_eoi):(this.irq_mask=~t,this.check_irqs()):1===this.state?(this.irq_map=t,l(this.irq_map),this.name,this.state++):2===this.state&&(this.state=0,l(t))},S.prototype.port21_read=function(){return l(255&~this.irq_mask),255&~this.irq_mask},S.prototype.port4D0_read=function(){return l(this.elcr,2),this.elcr},S.prototype.port4D0_write=function(t){l(t,2),this.elcr=t},A.prototype.get_state=function(){var t=[];return t[0]=this.counter_next_low,t[1]=this.counter_enabled,t[2]=this.counter_mode,t[3]=this.counter_read_mode,t[4]=this.counter_latch,t[5]=this.counter_latch_value,t[6]=this.counter_reload,t[7]=this.counter_start_time,t[8]=this.counter_start_value,t},A.prototype.set_state=function(t){this.counter_next_low=t[0],this.counter_enabled=t[1],this.counter_mode=t[2],this.counter_read_mode=t[3],this.counter_latch=t[4],this.counter_latch_value=t[5],this.counter_reload=t[6],this.counter_start_time=t[7],this.counter_start_value=t[8]},A.prototype.timer=function(t,e){var i=100;return e||(this.counter_enabled[0]&&this.did_rollover(0,t)?(this.counter_start_value[0]=this.get_counter_value(0,t),this.counter_start_time[0]=t,this.counter_start_value[0],this.cpu.device_lower_irq(0),this.cpu.device_raise_irq(0),0===this.counter_mode[0]&&(this.counter_enabled[0]=0)):this.cpu.device_lower_irq(0),this.counter_enabled[0]&&(i=(this.counter_start_value[0]-Math.floor(1193.1816666*(t-this.counter_start_time[0])))/1193.1816666)),i},A.prototype.get_counter_value=function(t,e){if(!this.counter_enabled[t])return 0;var i=e-this.counter_start_time[t],r=Math.floor(1193.1816666*i);return e=this.counter_start_value[t]-r,this.counter_reload[t],e>=(i=this.counter_reload[t])?e%=i:0>e&&(e=e%i+i),e},A.prototype.did_rollover=function(t,e){return 0>(e-=this.counter_start_time[t])||this.counter_start_value[t]<Math.floor(1193.1816666*e)},A.prototype.counter_read=function(t){var e=this.counter_latch[t];return e?(this.counter_latch[t]--,2===e?255&this.counter_latch_value[t]:this.counter_latch_value[t]>>8):(e=this.counter_next_low[t],3===this.counter_mode[t]&&(this.counter_next_low[t]^=1),t=this.get_counter_value(t,Y.microtick()),e?255&t:t>>8)},A.prototype.counter_write=function(t,e){this.counter_reload[t]=this.counter_next_low[t]?-256&this.counter_reload[t]|e:255&this.counter_reload[t]|e<<8,3===this.counter_read_mode[t]&&this.counter_next_low[t]||(this.counter_reload[t]||(this.counter_reload[t]=65535),this.counter_start_value[t]=this.counter_reload[t],this.counter_enabled[t]=!0,this.counter_start_time[t]=Y.microtick(),l(this.counter_reload[t]),this.counter_reload[t]),3===this.counter_read_mode[t]&&(this.counter_next_low[t]^=1)},A.prototype.port43_write=function(t){var e=t>>1&7,i=t>>6&3;t=t>>4&3,3===i||(0===t?(this.counter_latch[i]=2,e=this.get_counter_value(i,Y.microtick()),this.counter_latch_value[i]=e?e-1:0):(6<=e&&(e&=-5),this.counter_next_low[i]=1===t?0:1,0===i&&this.cpu.device_lower_irq(0),0!==e&&3!==e&&2!==e&&l(e),this.counter_mode[i]=e,this.counter_read_mode[i]=t,2===i&&this.bus.send("pcspeaker-update",[this.counter_mode[2],this.counter_reload[2]])))},A.prototype.dump=function(){this.counter_reload[0]},E.prototype.get_state=function(){var t=[];return t[0]=this.enable_mouse_stream,t[1]=this.use_mouse,t[2]=this.have_mouse,t[3]=this.mouse_delta_x,t[4]=this.mouse_delta_y,t[5]=this.mouse_clicks,t[6]=this.have_keyboard,t[7]=this.enable_keyboard_stream,t[8]=this.next_is_mouse_command,t[9]=this.next_read_sample,t[10]=this.next_read_led,t[11]=this.next_handle_scan_code_set,t[12]=this.next_read_rate,t[13]=this.next_read_resolution,t[15]=this.last_port60_byte,t[16]=this.sample_rate,t[17]=this.resolution,t[18]=this.scaling2,t[20]=this.command_register,t[21]=this.read_output_register,t[22]=this.read_command_register,t[23]=this.controller_output_port,t[24]=this.read_controller_output_port,t[25]=this.mouse_id,t[26]=this.mouse_detect_state,t[27]=this.mouse_reset_workaround,t},E.prototype.set_state=function(t){this.enable_mouse_stream=t[0],this.use_mouse=t[1],this.have_mouse=t[2],this.mouse_delta_x=t[3],this.mouse_delta_y=t[4],this.mouse_clicks=t[5],this.have_keyboard=t[6],this.enable_keyboard_stream=t[7],this.next_is_mouse_command=t[8],this.next_read_sample=t[9],this.next_read_led=t[10],this.next_handle_scan_code_set=t[11],this.next_read_rate=t[12],this.next_read_resolution=t[13],this.last_port60_byte=t[15],this.sample_rate=t[16],this.resolution=t[17],this.scaling2=t[18],this.command_register=t[20],this.read_output_register=t[21],this.read_command_register=t[22],this.controller_output_port=t[23],this.read_controller_output_port=t[24],this.mouse_id=t[25]||0,this.mouse_detect_state=t[26]||0,this.mouse_reset_workaround=t[27]||!1,this.next_byte_is_aux=this.next_byte_is_ready=!1,this.kbd_buffer.clear(),this.mouse_buffer.clear(),this.bus.send("mouse-enable",this.use_mouse)},E.prototype.raise_irq=function(){this.next_byte_is_ready||(this.kbd_buffer.length?this.kbd_irq():this.mouse_buffer.length&&this.mouse_irq())},E.prototype.mouse_irq=function(){this.next_byte_is_aux=this.next_byte_is_ready=!0,2&this.command_register&&(this.cpu.device_lower_irq(12),this.cpu.device_raise_irq(12))},E.prototype.kbd_irq=function(){this.next_byte_is_ready=!0,this.next_byte_is_aux=!1,1&this.command_register&&(this.cpu.device_lower_irq(1),this.cpu.device_raise_irq(1))},E.prototype.kbd_send_code=function(t){this.enable_keyboard_stream&&(l(t),this.kbd_buffer.push(t),this.raise_irq())},E.prototype.mouse_send_delta=function(t,e){if(this.have_mouse&&this.use_mouse){var i=this.resolution*this.sample_rate/80;this.mouse_delta_x+=t*i,this.mouse_delta_y+=e*i,this.enable_mouse_stream&&(t=0|this.mouse_delta_x,e=0|this.mouse_delta_y,t||e)&&(this.mouse_delta_x-=t,this.mouse_delta_y-=e,this.send_mouse_packet(t,e))}},E.prototype.mouse_send_click=function(t,e,i){this.have_mouse&&this.use_mouse&&(this.mouse_clicks=t|i<<1|e<<2,this.enable_mouse_stream&&this.send_mouse_packet(0,0))},E.prototype.send_mouse_packet=function(t,e){var i=(0>e)<<5|(0>t)<<4|8|this.mouse_clicks;this.last_mouse_packet=Date.now(),this.mouse_buffer.push(i),this.mouse_buffer.push(t),this.mouse_buffer.push(e),4===this.mouse_id?(this.mouse_buffer.push(15&this.wheel_movement),this.wheel_movement=0):3===this.mouse_id&&(this.mouse_buffer.push(255&this.wheel_movement),this.wheel_movement=0),this.raise_irq()},E.prototype.apply_scaling2=function(t){var e=t>>31;switch(Math.abs(t)){case 0:case 1:case 3:return t;case 2:return e;case 4:return 6*e;case 5:return 9*e;default:return t<<1}},E.prototype.port60_read=function(){return this.next_byte_is_ready=!1,this.kbd_buffer.length||this.mouse_buffer.length?(this.next_byte_is_aux?(this.cpu.device_lower_irq(12),this.last_port60_byte=this.mouse_buffer.shift(),l(this.last_port60_byte)):(this.cpu.device_lower_irq(1),this.last_port60_byte=this.kbd_buffer.shift(),l(this.last_port60_byte)),(this.kbd_buffer.length||this.mouse_buffer.length)&&this.raise_irq(),this.last_port60_byte):this.last_port60_byte},E.prototype.port64_read=function(){var t=16;return this.next_byte_is_ready&&(t|=1),this.next_byte_is_aux&&(t|=32),l(t),t},E.prototype.port60_write=function(t){if(l(t),this.read_command_register)this.command_register=t,this.read_command_register=!1,l(this.command_register);else if(this.read_output_register)this.read_output_register=!1,this.mouse_buffer.clear(),this.mouse_buffer.push(t),this.mouse_irq();else if(this.next_read_sample){switch(this.next_read_sample=!1,this.mouse_buffer.clear(),this.mouse_buffer.push(250),this.sample_rate=t,this.mouse_detect_state){case-1:60===t?(this.mouse_reset_workaround=!0,this.mouse_detect_state=0):(this.mouse_reset_workaround=!1,this.mouse_detect_state=200===t?1:0);break;case 0:200===t&&(this.mouse_detect_state=1);break;case 1:this.mouse_detect_state=100===t?2:200===t?3:0;break;case 2:80===t&&(this.mouse_id=3),this.mouse_detect_state=-1;break;case 3:80===t&&(this.mouse_id=4),this.mouse_detect_state=-1}l(t),l(this.mouse_id),this.sample_rate||(this.sample_rate=100),this.mouse_irq()}else if(this.next_read_resolution)this.next_read_resolution=!1,this.mouse_buffer.clear(),this.mouse_buffer.push(250),3<t?this.resolution=4:(this.resolution=1<<t,this.resolution),this.mouse_irq();else if(this.next_read_led)this.next_read_led=!1,this.kbd_buffer.push(250),this.kbd_irq();else if(this.next_handle_scan_code_set)this.next_handle_scan_code_set=!1,this.kbd_buffer.push(250),this.kbd_irq(),t||this.kbd_buffer.push(2);else if(this.next_read_rate)this.next_read_rate=!1,this.kbd_buffer.push(250),this.kbd_irq();else if(this.next_is_mouse_command){if(this.next_is_mouse_command=!1,l(t),this.have_mouse){switch(this.kbd_buffer.clear(),this.mouse_buffer.clear(),this.mouse_buffer.push(250),t){case 230:this.scaling2=!1;break;case 231:this.scaling2=!0;break;case 232:this.next_read_resolution=!0;break;case 233:case 235:this.send_mouse_packet(0,0);break;case 242:l(this.mouse_id),this.mouse_buffer.push(this.mouse_id),this.mouse_clicks=this.mouse_delta_x=this.mouse_delta_y=0,this.raise_irq();break;case 243:this.next_read_sample=!0;break;case 244:this.use_mouse=this.enable_mouse_stream=!0,this.bus.send("mouse-enable",!0),this.mouse_clicks=this.mouse_delta_x=this.mouse_delta_y=0;break;case 245:this.enable_mouse_stream=!1;break;case 246:this.enable_mouse_stream=!1,this.sample_rate=100,this.scaling2=!1,this.resolution=4;break;case 255:this.mouse_buffer.push(170),this.mouse_buffer.push(0),this.use_mouse=!0,this.bus.send("mouse-enable",!0),this.enable_mouse_stream=!1,this.sample_rate=100,this.scaling2=!1,this.resolution=4,this.mouse_reset_workaround||(this.mouse_id=0),this.mouse_clicks=this.mouse_delta_x=this.mouse_delta_y=0;break;default:l(t)}this.mouse_irq()}}else if(this.read_controller_output_port)this.read_controller_output_port=!1,this.controller_output_port=t;else{switch(l(t),this.mouse_buffer.clear(),this.kbd_buffer.clear(),this.kbd_buffer.push(250),t){case 237:this.next_read_led=!0;break;case 240:this.next_handle_scan_code_set=!0;break;case 242:this.kbd_buffer.push(171),this.kbd_buffer.push(83);break;case 243:this.next_read_rate=!0;break;case 244:this.enable_keyboard_stream=!0;break;case 245:this.enable_keyboard_stream=!1;break;case 246:break;case 255:this.kbd_buffer.clear(),this.kbd_buffer.push(250),this.kbd_buffer.push(170),this.kbd_buffer.push(0);break;default:l(t)}this.kbd_irq()}},E.prototype.port64_write=function(t){switch(l(t),t){case 32:this.kbd_buffer.clear(),this.mouse_buffer.clear(),this.kbd_buffer.push(this.command_register),this.kbd_irq();break;case 96:this.read_command_register=!0;break;case 209:this.read_controller_output_port=!0;break;case 211:this.read_output_register=!0;break;case 212:this.next_is_mouse_command=!0;break;case 167:this.command_register|=32;break;case 168:this.command_register&=-33;break;case 169:case 171:this.kbd_buffer.clear(),this.mouse_buffer.clear(),this.kbd_buffer.push(0),this.kbd_irq();break;case 170:this.kbd_buffer.clear(),this.mouse_buffer.clear(),this.kbd_buffer.push(85),this.kbd_irq();break;case 173:this.command_register|=16;break;case 174:this.command_register&=-17;break;case 254:this.cpu.reboot_internal();break;default:l(t)}};var z=new Uint8Array(256),I=[],P=[],q=[],O=new Uint8Array(256),L=[];function T(t,e){this.cpu=t,this.bus=e,this.write_buffer=new u(64),this.read_buffer=new u(64),this.mixer_current_address=this.command_size=this.command=this.read_buffer_lastvalue=0,this.mixer_registers=new Uint8Array(256),this.mixer_reset(),this.dummy_speaker_enabled=!1,this.test_register=0,this.dsp_signed=this.dsp_16bit=this.dsp_stereo=this.dsp_highspeed=!1,this.dac_buffers=[new c(65536),new c(65536)],this.dma=t.devices.dma,this.dma_channel=this.dma_irq=this.dma_bytes_block=this.dma_bytes_left=this.dma_bytes_count=this.dma_sample_count=0,this.dma_channel_8bit=1,this.dma_channel_16bit=5,this.dma_autoinit=!1,this.dma_buffer=new ArrayBuffer(65536),this.dma_buffer_int8=new Int8Array(this.dma_buffer),this.dma_buffer_uint8=new Uint8Array(this.dma_buffer),this.dma_buffer_int16=new Int16Array(this.dma_buffer),this.dma_buffer_uint16=new Uint16Array(this.dma_buffer),this.dma_syncbuffer=new o.SyncBuffer(this.dma_buffer),this.dma_paused=this.dma_waiting_transfer=!1,this.sampling_rate=22050,e.send("dac-tell-sampling-rate",this.sampling_rate),this.bytes_per_sample=1,this.e2_value=170,this.e2_count=0,this.asp_registers=new Uint8Array(256),this.mpu_read_buffer=new u(64),this.fm_current_address1=this.fm_current_address0=this.mpu_read_buffer_lastvalue=0,this.fm_waveform_select_enable=!1,this.irq=5,this.irq_triggered=new Uint8Array(16),t.io.register_read_consecutive(544,this,this.port2x0_read,this.port2x1_read,this.port2x2_read,this.port2x3_read),t.io.register_read_consecutive(904,this,this.port2x0_read,this.port2x1_read),t.io.register_read_consecutive(548,this,this.port2x4_read,this.port2x5_read),t.io.register_read(550,this,this.port2x6_read),t.io.register_read(551,this,this.port2x7_read),t.io.register_read(552,this,this.port2x8_read),t.io.register_read(553,this,this.port2x9_read),t.io.register_read(554,this,this.port2xA_read),t.io.register_read(555,this,this.port2xB_read),t.io.register_read(556,this,this.port2xC_read),t.io.register_read(557,this,this.port2xD_read),t.io.register_read_consecutive(558,this,this.port2xE_read,this.port2xF_read),t.io.register_write_consecutive(544,this,this.port2x0_write,this.port2x1_write,this.port2x2_write,this.port2x3_write),t.io.register_write_consecutive(904,this,this.port2x0_write,this.port2x1_write),t.io.register_write_consecutive(548,this,this.port2x4_write,this.port2x5_write),t.io.register_write(550,this,this.port2x6_write),t.io.register_write(551,this,this.port2x7_write),t.io.register_write_consecutive(552,this,this.port2x8_write,this.port2x9_write),t.io.register_write(554,this,this.port2xA_write),t.io.register_write(555,this,this.port2xB_write),t.io.register_write(556,this,this.port2xC_write),t.io.register_write(557,this,this.port2xD_write),t.io.register_write(558,this,this.port2xE_write),t.io.register_write(559,this,this.port2xF_write),t.io.register_read_consecutive(816,this,this.port3x0_read,this.port3x1_read),t.io.register_write_consecutive(816,this,this.port3x0_write,this.port3x1_write),this.dma.on_unmask(this.dma_on_unmask,this),e.register("dac-request-data",(function(){this.dac_handle_request()}),this),e.register("speaker-has-initialized",(function(){this.mixer_reset()}),this),e.send("speaker-confirm-initialized"),this.dsp_reset()}function R(t,e,i){i||(i=T.prototype.dsp_default_handler);for(var r=0;r<t.length;r++)z[t[r]]=e,I[t[r]]=i}function N(t){for(var e=[],i=0;16>i;i++)e.push(t+i);return e}T.prototype.dsp_reset=function(){this.write_buffer.clear(),this.read_buffer.clear(),this.command_size=this.command=0,this.dummy_speaker_enabled=!1,this.test_register=0,this.dsp_signed=this.dsp_16bit=this.dsp_stereo=this.dsp_highspeed=!1,this.dac_buffers[0].clear(),this.dac_buffers[1].clear(),this.dma_channel=this.dma_irq=this.dma_bytes_block=this.dma_bytes_left=this.dma_bytes_count=this.dma_sample_count=0,this.dma_autoinit=!1,this.dma_buffer_uint8.fill(0),this.dma_paused=this.dma_waiting_transfer=!1,this.e2_value=170,this.e2_count=0,this.sampling_rate=22050,this.bytes_per_sample=1,this.lower_irq(1),this.irq_triggered.fill(0),this.asp_registers.fill(0),this.asp_registers[5]=1,this.asp_registers[9]=248},T.prototype.get_state=function(){var t=[];return t[2]=this.read_buffer_lastvalue,t[3]=this.command,t[4]=this.command_size,t[5]=this.mixer_current_address,t[6]=this.mixer_registers,t[7]=this.dummy_speaker_enabled,t[8]=this.test_register,t[9]=this.dsp_highspeed,t[10]=this.dsp_stereo,t[11]=this.dsp_16bit,t[12]=this.dsp_signed,t[15]=this.dma_sample_count,t[16]=this.dma_bytes_count,t[17]=this.dma_bytes_left,t[18]=this.dma_bytes_block,t[19]=this.dma_irq,t[20]=this.dma_channel,t[21]=this.dma_channel_8bit,t[22]=this.dma_channel_16bit,t[23]=this.dma_autoinit,t[24]=this.dma_buffer_uint8,t[25]=this.dma_waiting_transfer,t[26]=this.dma_paused,t[27]=this.sampling_rate,t[28]=this.bytes_per_sample,t[29]=this.e2_value,t[30]=this.e2_count,t[31]=this.asp_registers,t[33]=this.mpu_read_buffer_last_value,t[34]=this.irq,t[35]=this.irq_triggered,t},T.prototype.set_state=function(t){this.read_buffer_lastvalue=t[2],this.command=t[3],this.command_size=t[4],this.mixer_current_address=t[5],this.mixer_registers=t[6],this.mixer_full_update(),this.dummy_speaker_enabled=t[7],this.test_register=t[8],this.dsp_highspeed=t[9],this.dsp_stereo=t[10],this.dsp_16bit=t[11],this.dsp_signed=t[12],this.dma_sample_count=t[15],this.dma_bytes_count=t[16],this.dma_bytes_left=t[17],this.dma_bytes_block=t[18],this.dma_irq=t[19],this.dma_channel=t[20],this.dma_channel_8bit=t[21],this.dma_channel_16bit=t[22],this.dma_autoinit=t[23],this.dma_buffer_uint8=t[24],this.dma_waiting_transfer=t[25],this.dma_paused=t[26],this.sampling_rate=t[27],this.bytes_per_sample=t[28],this.e2_value=t[29],this.e2_count=t[30],this.asp_registers=t[31],this.mpu_read_buffer_last_value=t[33],this.irq=t[34],this.irq_triggered=t[35],this.dma_buffer=this.dma_buffer_uint8.buffer,this.dma_buffer_int8=new Int8Array(this.dma_buffer),this.dma_buffer_int16=new Int16Array(this.dma_buffer),this.dma_buffer_uint16=new Uint16Array(this.dma_buffer),this.dma_syncbuffer=new o.SyncBuffer(this.dma_buffer),this.dma_paused?this.bus.send("dac-disable"):this.bus.send("dac-enable")},T.prototype.port2x0_read=function(){return 255},T.prototype.port2x1_read=function(){return 255},T.prototype.port2x2_read=function(){return 255},T.prototype.port2x3_read=function(){return 255},T.prototype.port2x4_read=function(){return this.mixer_current_address},T.prototype.port2x5_read=function(){return this.mixer_read(this.mixer_current_address)},T.prototype.port2x6_read=function(){return 255},T.prototype.port2x7_read=function(){return 255},T.prototype.port2x8_read=function(){return 255},T.prototype.port2x9_read=function(){return 255},T.prototype.port2xA_read=function(){return this.read_buffer.length&&(this.read_buffer_lastvalue=this.read_buffer.shift()),this.read_buffer_lastvalue,l(this.read_buffer_lastvalue),String.fromCharCode(this.read_buffer_lastvalue),this.read_buffer_lastvalue},T.prototype.port2xB_read=function(){return 255},T.prototype.port2xC_read=function(){return 127},T.prototype.port2xD_read=function(){return 255},T.prototype.port2xE_read=function(){return this.irq_triggered[1]&&this.lower_irq(1),(this.read_buffer.length&&!this.dsp_highspeed)<<7|127},T.prototype.port2xF_read=function(){return this.lower_irq(2),0},T.prototype.port2x0_write=function(t){l(t),this.fm_current_address0=0},T.prototype.port2x1_write=function(t){l(t);var e=L[this.fm_current_address0];e||(e=this.fm_default_write),e.call(this,t,0,this.fm_current_address0)},T.prototype.port2x2_write=function(t){l(t),this.fm_current_address1=0},T.prototype.port2x3_write=function(t){l(t);var e=L[this.fm_current_address1];e||(e=this.fm_default_write),e.call(this,t,1,this.fm_current_address1)},T.prototype.port2x4_write=function(t){l(t),this.mixer_current_address=t},T.prototype.port2x5_write=function(t){l(t),this.mixer_write(this.mixer_current_address,t)},T.prototype.port2x6_write=function(t){l(t),this.dsp_highspeed?this.dsp_highspeed=!1:t&&this.dsp_reset(),this.read_buffer.clear(),this.read_buffer.push(170)},T.prototype.port2x7_write=function(){},T.prototype.port2x8_write=function(){},T.prototype.port2x9_write=function(){},T.prototype.port2xA_write=function(){},T.prototype.port2xB_write=function(){},T.prototype.port2xC_write=function(t){0===this.command?(l(t),this.command=t,this.write_buffer.clear(),this.command_size=z[t]):(l(t),this.write_buffer.push(t)),this.write_buffer.length>=this.command_size&&this.command_do()},T.prototype.port2xD_write=function(){},T.prototype.port2xE_write=function(){},T.prototype.port2xF_write=function(){},T.prototype.port3x0_read=function(){return this.mpu_read_buffer.length&&(this.mpu_read_buffer_lastvalue=this.mpu_read_buffer.shift()),l(this.mpu_read_buffer_lastvalue),this.mpu_read_buffer_lastvalue},T.prototype.port3x0_write=function(t){l(t)},T.prototype.port3x1_read=function(){return 0|128*!this.mpu_read_buffer.length},T.prototype.port3x1_write=function(t){l(t),255==t&&(this.mpu_read_buffer.clear(),this.mpu_read_buffer.push(254))},T.prototype.command_do=function(){var t=I[this.command];t||(t=this.dsp_default_handler),t.call(this),this.command_size=this.command=0,this.write_buffer.clear()},T.prototype.dsp_default_handler=function(){l(this.command)},R([14],2,(function(){this.asp_registers[this.write_buffer.shift()]=this.write_buffer.shift()})),R([15],1,(function(){this.read_buffer.clear(),this.read_buffer.push(this.asp_registers[this.write_buffer.shift()])})),R([16],1,(function(){var t=this.write_buffer.shift();t=W(t/127.5-1,-1,1),this.dac_buffers[0].push(t),this.dac_buffers[1].push(t),this.bus.send("dac-enable")})),R([20,21],2,(function(){this.dma_irq=1,this.dma_channel=this.dma_channel_8bit,this.dsp_highspeed=this.dsp_16bit=this.dsp_signed=this.dma_autoinit=!1,this.dma_transfer_size_set(),this.dma_transfer_start()})),R([22],2),R([23],2),R([28],0,(function(){this.dma_irq=1,this.dma_channel=this.dma_channel_8bit,this.dma_autoinit=!0,this.dsp_highspeed=this.dsp_16bit=this.dsp_signed=!1,this.dma_transfer_start()})),R([31],0),R([32],0,(function(){this.read_buffer.clear(),this.read_buffer.push(127)})),R([36],2),R([44],0),R([48],0),R([49],0),R([52],0),R([53],0),R([54],0),R([55],0),R([56],0),R([64],1,(function(){this.sampling_rate_change(1e6/(256-this.write_buffer.shift())/this.get_channel_count())})),R([65,66],2,(function(){this.sampling_rate_change(this.write_buffer.shift()<<8|this.write_buffer.shift())})),R([72],2,(function(){this.dma_transfer_size_set()})),R([116],2),R([117],2),R([118],2),R([119],2),R([125],0),R([127],0),R([128],2),R([144],0,(function(){this.dma_irq=1,this.dma_channel=this.dma_channel_8bit,this.dma_autoinit=!0,this.dsp_signed=!1,this.dsp_highspeed=!0,this.dsp_16bit=!1,this.dma_transfer_start()})),R([145],0),R([152],0),R([153],0),R([160],0),R([168],0),R(N(176),3,(function(){if(8&this.command)this.dsp_default_handler();else{var t=this.write_buffer.shift();this.dma_irq=2,this.dma_channel=this.dma_channel_16bit,this.dma_autoinit=!!(4&this.command),this.dsp_signed=!!(16&t),this.dsp_stereo=!!(32&t),this.dsp_16bit=!0,this.dma_transfer_size_set(),this.dma_transfer_start()}})),R(N(192),3,(function(){if(8&this.command)this.dsp_default_handler();else{var t=this.write_buffer.shift();this.dma_irq=1,this.dma_channel=this.dma_channel_8bit,this.dma_autoinit=!!(4&this.command),this.dsp_signed=!!(16&t),this.dsp_stereo=!!(32&t),this.dsp_16bit=!1,this.dma_transfer_size_set(),this.dma_transfer_start()}})),R([208],0,(function(){this.dma_paused=!0,this.bus.send("dac-disable")})),R([209],0,(function(){this.dummy_speaker_enabled=!0})),R([211],0,(function(){this.dummy_speaker_enabled=!1})),R([212],0,(function(){this.dma_paused=!1,this.bus.send("dac-enable")})),R([213],0,(function(){this.dma_paused=!0,this.bus.send("dac-disable")})),R([214],0,(function(){this.dma_paused=!1,this.bus.send("dac-enable")})),R([216],0,(function(){this.read_buffer.clear(),this.read_buffer.push(255*this.dummy_speaker_enabled)})),R([217,218],0,(function(){this.dma_autoinit=!1})),R([224],1,(function(){this.read_buffer.clear(),this.read_buffer.push(~this.write_buffer.shift())})),R([225],0,(function(){this.read_buffer.clear(),this.read_buffer.push(4),this.read_buffer.push(5)})),R([226],1),R([227],0,(function(){this.read_buffer.clear();for(var t=0;44>t;t++)this.read_buffer.push("COPYRIGHT (C) CREATIVE TECHNOLOGY LTD, 1992.".charCodeAt(t));this.read_buffer.push(0)})),R([228],1,(function(){this.test_register=this.write_buffer.shift()})),R([232],0,(function(){this.read_buffer.clear(),this.read_buffer.push(this.test_register)})),R([242,243],0,(function(){this.raise_irq()}));var U=new Uint8Array(256);function D(t,e){e||(e=T.prototype.mixer_default_read),P[t]=e}function M(t,e){e||(e=T.prototype.mixer_default_write),q[t]=e}function F(t,e,i){O[t]=1,P[t]=function(){return 240&this.mixer_registers[e]|this.mixer_registers[i]>>>4},q[t]=function(r){this.mixer_registers[t]=r;var s=r<<4&240|15&this.mixer_registers[i];this.mixer_write(e,240&r|15&this.mixer_registers[e]),this.mixer_write(i,s)}}function j(t,e,i){P[t]=T.prototype.mixer_default_read,q[t]=function(r){this.mixer_registers[t]=r,this.bus.send("mixer-volume",[e,i,(r>>>2)-62])}}function V(t,e){e||(e=T.prototype.fm_default_write);for(var i=0;i<t.length;i++)L[t[i]]=e}function B(t,e){for(var i=[];t<=e;t++)i.push(t);return i}U[14]=255,U[15]=7,U[55]=56,R([249],1,(function(){var t=this.write_buffer.shift();this.read_buffer.clear(),this.read_buffer.push(U[t])})),T.prototype.mixer_read=function(t){var e=P[t];return e?e=e.call(this):(e=this.mixer_registers[t],l(t),l(e)),e},T.prototype.mixer_write=function(t,e){var i=q[t];i?i.call(this,e):(l(t),l(e))},T.prototype.mixer_default_read=function(){return l(this.mixer_current_address),this.mixer_registers[this.mixer_current_address]},T.prototype.mixer_default_write=function(t){l(this.mixer_current_address),l(t),this.mixer_registers[this.mixer_current_address]=t},T.prototype.mixer_reset=function(){this.mixer_registers[4]=204,this.mixer_registers[34]=204,this.mixer_registers[38]=204,this.mixer_registers[40]=0,this.mixer_registers[46]=0,this.mixer_registers[10]=0,this.mixer_registers[48]=192,this.mixer_registers[49]=192,this.mixer_registers[50]=192,this.mixer_registers[51]=192,this.mixer_registers[52]=192,this.mixer_registers[53]=192,this.mixer_registers[54]=0,this.mixer_registers[55]=0,this.mixer_registers[56]=0,this.mixer_registers[57]=0,this.mixer_registers[59]=0,this.mixer_registers[60]=31,this.mixer_registers[61]=21,this.mixer_registers[62]=11,this.mixer_registers[63]=0,this.mixer_registers[64]=0,this.mixer_registers[65]=0,this.mixer_registers[66]=0,this.mixer_registers[67]=0,this.mixer_registers[68]=128,this.mixer_registers[69]=128,this.mixer_registers[70]=128,this.mixer_registers[71]=128,this.mixer_full_update()},T.prototype.mixer_full_update=function(){for(var t=1;t<this.mixer_registers.length;t++)O[t]||this.mixer_write(t,this.mixer_registers[t])},D(0,(function(){return this.mixer_reset(),0})),M(0),F(4,50,51),F(34,48,49),F(38,52,53),F(40,54,55),F(46,56,57),j(48,0,0),j(49,0,1),j(50,2,0),j(51,2,1),D(59),M(59,(function(t){this.mixer_registers[59]=t,this.bus.send("mixer-volume",[1,2,6*(t>>>6)-18])})),D(65),M(65,(function(t){this.mixer_registers[65]=t,this.bus.send("mixer-gain-left",6*(t>>>6))})),D(66),M(66,(function(t){this.mixer_registers[66]=t,this.bus.send("mixer-gain-right",6*(t>>>6))})),D(68),M(68,(function(t){this.mixer_registers[68]=t,t>>>=3,this.bus.send("mixer-treble-left",t-(16>t?14:16))})),D(69),M(69,(function(t){this.mixer_registers[69]=t,t>>>=3,this.bus.send("mixer-treble-right",t-(16>t?14:16))})),D(70),M(70,(function(t){this.mixer_registers[70]=t,t>>>=3,this.bus.send("mixer-bass-right",t-(16>t?14:16))})),D(71),M(71,(function(t){this.mixer_registers[71]=t,t>>>=3,this.bus.send("mixer-bass-right",t-(16>t?14:16))})),D(128,(function(){switch(this.irq){case 2:return 1;case 5:return 2;case 7:return 4;case 10:return 8;default:return 0}})),M(128,(function(t){1&t&&(this.irq=2),2&t&&(this.irq=5),4&t&&(this.irq=7),8&t&&(this.irq=10)})),D(129,(function(){var t=0;switch(this.dma_channel_8bit){case 0:t|=1;break;case 1:t|=2;break;case 3:t|=8}switch(this.dma_channel_16bit){case 5:t|=32;break;case 6:t|=64;break;case 7:t|=128}return t})),M(129,(function(t){1&t&&(this.dma_channel_8bit=0),2&t&&(this.dma_channel_8bit=1),8&t&&(this.dma_channel_8bit=3),32&t&&(this.dma_channel_16bit=5),64&t&&(this.dma_channel_16bit=6),128&t&&(this.dma_channel_16bit=7)})),D(130,(function(){for(var t=32,e=0;16>e;e++)t|=e*this.irq_triggered[e];return t})),T.prototype.fm_default_write=function(t,e,i){l(i),l(t)};var G=new Uint8Array(32);function W(t,e,i){return(t<e)*e+(t>i)*i+(e<=t&&t<=i)*t}function H(t,e,i){switch(this.bus=i,this.cpu=t,this.ints=4,this.line_control=this.baud_rate=0,this.lsr=96,this.ier=this.fifo_control=0,this.iir=1,this.irq=this.scratch_register=this.modem_status=this.modem_control=0,this.input=new u(4096),this.current_line="",e){case 1016:this.com=0,this.irq=4;break;case 760:this.com=1,this.irq=3;break;case 1e3:this.com=2,this.irq=4;break;case 744:this.irq=this.com=3;break;default:l(e),this.com=0,this.irq=4}this.bus.register("serial"+this.com+"-input",(function(t){this.data_received(t)}),this),(t=t.io).register_write(e,this,(function(t){this.write_data(t)}),(function(t){this.write_data(255&t),this.write_data(t>>8)})),t.register_write(1|e,this,(function(t){128&this.line_control?(this.baud_rate=255&this.baud_rate|t<<8,l(this.baud_rate)):(0==(2&this.ier)&&2&t&&this.ThrowInterrupt(2),this.ier=15&t,l(t),this.CheckInterrupt())})),t.register_read(e,this,(function(){if(128&this.line_control)return 255&this.baud_rate;var t=this.input.shift();return-1===t||l(t),0===this.input.length&&(this.lsr&=-2,this.ClearInterrupt(12),this.ClearInterrupt(4)),t})),t.register_read(1|e,this,(function(){return 128&this.line_control?this.baud_rate>>8:15&this.ier})),t.register_read(2|e,this,(function(){var t=15&this.iir;return l(this.iir),1&this.fifo_control&&(t|=192),t})),t.register_write(2|e,this,(function(t){l(t),this.fifo_control=t})),t.register_read(3|e,this,(function(){return l(this.line_control),this.line_control})),t.register_write(3|e,this,(function(t){l(t),this.line_control=t})),t.register_read(4|e,this,(function(){return this.modem_control})),t.register_write(4|e,this,(function(t){l(t),this.modem_control=t})),t.register_read(5|e,this,(function(){return l(this.lsr),this.lsr})),t.register_write(5|e,this,(function(){})),t.register_read(6|e,this,(function(){return l(this.modem_status),this.modem_status})),t.register_write(6|e,this,(function(){})),t.register_read(7|e,this,(function(){return this.scratch_register})),t.register_write(7|e,this,(function(t){this.scratch_register=t}))}G[0]=0,G[1]=1,G[2]=2,G[3]=3,G[4]=4,G[5]=5,G[8]=6,G[9]=7,G[10]=8,G[11]=9,G[12]=10,G[13]=11,G[16]=12,G[17]=13,G[18]=14,G[19]=15,G[20]=16,G[21]=17,V([1],(function(t,e){this.fm_waveform_select_enable[e]=1&t,this.fm_update_waveforms()})),V([2]),V([3]),V([4],(function(){})),V([5],(function(t,e,i){0===e&&this.fm_default_write(t,e,i)})),V([8],(function(){})),V(B(32,53),(function(){})),V(B(64,85),(function(){})),V(B(96,117),(function(){})),V(B(128,149),(function(){})),V(B(160,168),(function(){})),V(B(176,184),(function(){})),V([189],(function(){})),V(B(192,200),(function(){})),V(B(224,245),(function(){})),T.prototype.fm_update_waveforms=function(){},T.prototype.sampling_rate_change=function(t){this.sampling_rate=t,this.bus.send("dac-tell-sampling-rate",t)},T.prototype.get_channel_count=function(){return this.dsp_stereo?2:1},T.prototype.dma_transfer_size_set=function(){this.dma_sample_count=1+(this.write_buffer.shift()|0)+(this.write_buffer.shift()<<8)},T.prototype.dma_transfer_start=function(){this.bytes_per_sample=1,this.dsp_16bit&&(this.bytes_per_sample*=2),this.dma_bytes_count=this.dma_sample_count*this.bytes_per_sample,this.dma_bytes_block=1024*this.bytes_per_sample,this.dma_bytes_block=Math.min(Math.max(this.dma_bytes_count>>2&-4,32),this.dma_bytes_block),this.dma_waiting_transfer=!0,this.dma.channel_mask[this.dma_channel]||this.dma_on_unmask(this.dma_channel)},T.prototype.dma_on_unmask=function(t){t===this.dma_channel&&this.dma_waiting_transfer&&(this.dma_waiting_transfer=!1,this.dma_bytes_left=this.dma_bytes_count,this.dma_paused=!1,this.bus.send("dac-enable"))},T.prototype.dma_transfer_next=function(){var t=Math.min(this.dma_bytes_left,this.dma_bytes_block),e=Math.floor(t/this.bytes_per_sample);this.dma.do_write(this.dma_syncbuffer,0,t,this.dma_channel,(i=>{i||(this.dma_to_dac(e),this.dma_bytes_left-=t,this.dma_bytes_left||(this.raise_irq(this.dma_irq),this.dma_autoinit&&(this.dma_bytes_left=this.dma_bytes_count)))}))},T.prototype.dma_to_dac=function(t){for(var e=this.dsp_16bit?32767.5:127.5,i=this.dsp_signed?0:-1,r=this.dsp_stereo?1:2,s=this.dsp_16bit?this.dsp_signed?this.dma_buffer_int16:this.dma_buffer_uint16:this.dsp_signed?this.dma_buffer_int8:this.dma_buffer_uint8,n=0,a=0;a<t;a++)for(var o=W(s[a]/e+i,-1,1),l=0;l<r;l++)this.dac_buffers[n].push(o),n^=1;this.dac_send()},T.prototype.dac_handle_request=function(){!this.dma_bytes_left||this.dma_paused?this.dac_send():this.dma_transfer_next()},T.prototype.dac_send=function(){if(this.dac_buffers[0].length){var t=this.dac_buffers[0].shift_block(this.dac_buffers[0].length),e=this.dac_buffers[1].shift_block(this.dac_buffers[1].length);this.bus.send("dac-send-data",[t,e],[t.buffer,e.buffer])}},T.prototype.raise_irq=function(t){this.irq_triggered[t]=1,this.cpu.device_raise_irq(this.irq)},T.prototype.lower_irq=function(t){this.irq_triggered[t]=0,this.cpu.device_lower_irq(this.irq)},H.prototype.get_state=function(){var t=[];return t[0]=this.ints,t[1]=this.baud_rate,t[2]=this.line_control,t[3]=this.lsr,t[4]=this.fifo_control,t[5]=this.ier,t[6]=this.iir,t[7]=this.modem_control,t[8]=this.modem_status,t[9]=this.scratch_register,t[10]=this.irq,t},H.prototype.set_state=function(t){this.ints=t[0],this.baud_rate=t[1],this.line_control=t[2],this.lsr=t[3],this.fifo_control=t[4],this.ier=t[5],this.iir=t[6],this.modem_control=t[7],this.modem_status=t[8],this.scratch_register=t[9],this.irq=t[10]},H.prototype.CheckInterrupt=function(){4096&this.ints&&1&this.ier?(this.iir=12,this.cpu.device_raise_irq(this.irq)):16&this.ints&&1&this.ier?(this.iir=4,this.cpu.device_raise_irq(this.irq)):4&this.ints&&2&this.ier?(this.iir=2,this.cpu.device_raise_irq(this.irq)):1&this.ints&&8&this.ier?(this.iir=0,this.cpu.device_raise_irq(this.irq)):(this.iir=1,this.cpu.device_lower_irq(this.irq))},H.prototype.ThrowInterrupt=function(t){this.ints|=1<<t,this.CheckInterrupt()},H.prototype.ClearInterrupt=function(t){this.ints&=~(1<<t),this.CheckInterrupt()},H.prototype.data_received=function(t){l(t),this.input.push(t),this.lsr|=1,1&this.fifo_control?this.ThrowInterrupt(12):this.ThrowInterrupt(4)},H.prototype.write_data=function(t){128&this.line_control?this.baud_rate=-256&this.baud_rate|t:(l(t),this.ThrowInterrupt(2),255!==t&&(t=String.fromCharCode(t),this.bus.send("serial"+this.com+"-output-char",t),DEBUG&&(this.current_line+=t,"\n"===t&&(t=this.current_line.trimRight().replace(/[\x00-\x08\x0b-\x1f\x7f\x80-\xff]/g,""),this.current_line=""))))};var $=Uint32Array.from([655360,655360,720896,753664]),Q=Uint32Array.from([131072,65536,32768,32768]);function K(t,e,i){this.cpu=t,this.bus=e,this.vga_memory_size=i,this.cursor_address=0,this.cursor_scanline_start=14,this.cursor_scanline_end=15,this.max_cols=80,this.max_rows=25,this.virtual_height=this.virtual_width=this.screen_height=this.screen_width=0,this.layers=[],this.start_address_latched=this.start_address=0,this.crtc=new Uint8Array(25),this.line_compare=this.offset_register=this.preset_row_scan=this.underline_location_register=this.vertical_blank_start=this.vertical_display_enable_end=this.horizontal_blank_start=this.horizontal_display_enable_end=this.crtc_mode=0,this.graphical_mode_is_linear=!0,this.graphical_mode=!1,setTimeout((()=>{e.send("screen-set-mode",this.graphical_mode)}),0),this.vga256_palette=new Int32Array(256),this.latch_dword=0,this.svga_version=45253,this.svga_height=this.svga_width=0,this.svga_enabled=!1,this.svga_bpp=32,this.svga_offset=this.svga_bank_offset=0,this.pci_space=[52,18,17,17,3,1,0,0,0,0,0,3,0,0,0,0,8,14680064,57344,224,0,0,0,0,0,0,191,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,244,26,0,17,0,0,190,254,0,0,0,0,0,0,0,0,0,0,0,0],this.pci_id=144,this.pci_bars=[{size:i}],this.pci_rom_size=65536,this.pci_rom_address=4272947200,this.name="vga",this.stats={is_graphical:!1,res_x:0,res_y:0,bpp:0},this.dac_state=this.dac_color_index_read=this.dac_color_index_write=this.index_crtc=0,this.dac_mask=255,this.dac_map=new Uint8Array(16),this.attribute_controller_index=-1,this.palette_source=32,this.color_select=this.horizontal_panning=this.color_plane_enable=this.attribute_mode=0,this.sequencer_index=-1,this.plane_write_bm=15,this.clocking_mode=this.sequencer_memory_mode=0,this.graphics_index=-1,this.planar_rotate_reg=this.planar_mode=this.plane_read=0,this.planar_bitmap=255,this.max_scan_line=this.color_dont_care=this.color_compare=this.miscellaneous_graphics_register=this.planar_setreset_enable=this.planar_setreset=0,this.port_3DA_value=this.miscellaneous_output_register=255,(i=t.io).register_write(960,this,this.port3C0_write),i.register_read(960,this,this.port3C0_read,this.port3C0_read16),i.register_read(961,this,this.port3C1_read),i.register_write(962,this,this.port3C2_write),i.register_write_consecutive(964,this,this.port3C4_write,this.port3C5_write),i.register_read(964,this,this.port3C4_read),i.register_read(965,this,this.port3C5_read),i.register_write_consecutive(974,this,this.port3CE_write,this.port3CF_write),i.register_read(974,this,this.port3CE_read),i.register_read(975,this,this.port3CF_read),i.register_read(966,this,this.port3C6_read),i.register_write(966,this,this.port3C6_write),i.register_write(967,this,this.port3C7_write),i.register_read(967,this,this.port3C7_read),i.register_write(968,this,this.port3C8_write),i.register_read(968,this,this.port3C8_read),i.register_write(969,this,this.port3C9_write),i.register_read(969,this,this.port3C9_read),i.register_read(972,this,this.port3CC_read),i.register_write_consecutive(980,this,this.port3D4_write,this.port3D5_write),i.register_read(980,this,this.port3D4_read),i.register_read(981,this,this.port3D5_read,(()=>this.port3D5_read())),i.register_read(970,this,(function(){return 0})),i.register_read(986,this,this.port3DA_read),i.register_read(954,this,this.port3DA_read),this.dispi_index=-1,this.dispi_enable_value=0,i.register_write(462,this,void 0,this.port1CE_write),i.register_write(463,this,void 0,this.port1CF_write),i.register_read(463,this,void 0,this.port1CF_read),void 0===this.vga_memory_size||262144>this.vga_memory_size?(this.vga_memory_size=262144,this.vga_memory_size):65535&this.vga_memory_size&&(this.vga_memory_size|=65535,this.vga_memory_size++);let r=t.svga_allocate_memory(this.vga_memory_size);this.svga_memory=o.view(Uint8Array,t.wasm_memory,r,this.vga_memory_size),this.diff_addr_min=this.vga_memory_size,this.diff_addr_max=0,this.diff_plot_min=this.vga_memory_size,this.diff_plot_max=0,this.image_data=null,e.register("screen-fill-buffer",(function(){this.screen_fill_buffer()}),this),this.vga_memory=new Uint8Array(262144),this.plane0=new Uint8Array(this.vga_memory.buffer,0,65536),this.plane1=new Uint8Array(this.vga_memory.buffer,65536,65536),this.plane2=new Uint8Array(this.vga_memory.buffer,131072,65536),this.plane3=new Uint8Array(this.vga_memory.buffer,196608,65536),this.pixel_buffer=new Uint8Array(524288);var s=this;i.mmap_register(655360,131072,(function(t){return s.vga_memory_read(t)}),(function(t,e){s.vga_memory_write(t,e)})),t.devices.pci.register_device(this)}function X(t,e,i){this.next_tick_immediately=i,this.wm=e,this.wasm_patch(),this.create_jit_imports(),this.wasm_memory=e=this.wm.exports.memory,this.memory_size=o.view(Uint32Array,e,812,1),this.mem8=new Uint8Array(0),this.mem32s=new Int32Array(this.mem8.buffer),this.segment_is_null=o.view(Uint8Array,e,724,8),this.segment_offsets=o.view(Int32Array,e,736,8),this.segment_limits=o.view(Uint32Array,e,768,8),this.protected_mode=o.view(Int32Array,e,800,1),this.idtr_size=o.view(Int32Array,e,564,1),this.idtr_offset=o.view(Int32Array,e,568,1),this.gdtr_size=o.view(Int32Array,e,572,1),this.gdtr_offset=o.view(Int32Array,e,576,1),this.tss_size_32=o.view(Int32Array,e,1128,1),this.page_fault=o.view(Uint32Array,e,540,8),this.cr=o.view(Int32Array,e,580,8),this.cpl=o.view(Uint8Array,e,612,1),this.is_32=o.view(Int32Array,e,804,1),this.stack_size_32=o.view(Int32Array,e,808,1),this.in_hlt=o.view(Uint8Array,e,616,1),this.last_virt_eip=o.view(Int32Array,e,620,1),this.eip_phys=o.view(Int32Array,e,624,1),this.sysenter_cs=o.view(Int32Array,e,636,1),this.sysenter_esp=o.view(Int32Array,e,640,1),this.sysenter_eip=o.view(Int32Array,e,644,1),this.prefixes=o.view(Int32Array,e,648,1),this.flags=o.view(Int32Array,e,120,1),this.flags_changed=o.view(Int32Array,e,100,1),this.last_op_size=o.view(Int32Array,e,96,1),this.last_op1=o.view(Int32Array,e,104,1),this.last_result=o.view(Int32Array,e,112,1),this.current_tsc=o.view(Uint32Array,e,960,2),this.devices={},this.instruction_pointer=o.view(Int32Array,e,556,1),this.previous_ip=o.view(Int32Array,e,560,1),this.apic_enabled=o.view(Uint8Array,e,548,1),this.acpi_enabled=o.view(Uint8Array,e,552,1),this.memory_map_read8=[],this.memory_map_write8=[],this.memory_map_read32=[],this.memory_map_write32=[],this.bios={main:null,vga:null},this.instruction_counter=o.view(Uint32Array,e,664,1),this.reg32=o.view(Int32Array,e,64,8),this.fpu_st=o.view(Int32Array,e,1152,32),this.fpu_stack_empty=o.view(Uint8Array,e,816,1),this.fpu_stack_empty[0]=255,this.fpu_stack_ptr=o.view(Uint8Array,e,1032,1),this.fpu_stack_ptr[0]=0,this.fpu_control_word=o.view(Uint16Array,e,1036,1),this.fpu_control_word[0]=895,this.fpu_status_word=o.view(Uint16Array,e,1040,1),this.fpu_status_word[0]=0,this.fpu_ip=o.view(Int32Array,e,1048,1),this.fpu_ip[0]=0,this.fpu_ip_selector=o.view(Int32Array,e,1052,1),this.fpu_ip_selector[0]=0,this.fpu_opcode=o.view(Int32Array,e,1044,1),this.fpu_opcode[0]=0,this.fpu_dp=o.view(Int32Array,e,1056,1),this.fpu_dp[0]=0,this.fpu_dp_selector=o.view(Int32Array,e,1060,1),this.fpu_dp_selector[0]=0,this.reg_xmm32s=o.view(Int32Array,e,832,32),this.mxcsr=o.view(Int32Array,e,824,1),this.sreg=o.view(Uint16Array,e,668,8),this.dreg=o.view(Int32Array,e,684,8),this.reg_pdpte=o.view(Int32Array,e,968,8),this.svga_dirty_bitmap_min_offset=o.view(Uint32Array,e,716,1),this.svga_dirty_bitmap_max_offset=o.view(Uint32Array,e,720,1),this.fw_value=[],this.fw_pointer=0,this.option_roms=[],this.io=void 0,this.bus=t,this.set_tsc(0,0),this.debug_init()}function Y(t,e){this.stopping=this.running=!1,this.tick_counter=0,this.worker=null,this.cpu=new X(t,e,(()=>{this.idle&&this.next_tick(0)})),this.bus=t,t.register("cpu-init",this.init,this),t.register("cpu-run",this.run,this),t.register("cpu-stop",this.stop,this),t.register("cpu-restart",this.restart,this),this.register_yield()}if(K.prototype.get_state=function(){var t=[];return t[0]=this.vga_memory_size,t[1]=this.cursor_address,t[2]=this.cursor_scanline_start,t[3]=this.cursor_scanline_end,t[4]=this.max_cols,t[5]=this.max_rows,t[6]=this.vga_memory,t[7]=this.dac_state,t[8]=this.start_address,t[9]=this.graphical_mode,t[10]=this.vga256_palette,t[11]=this.latch_dword,t[12]=this.color_compare,t[13]=this.color_dont_care,t[14]=this.miscellaneous_graphics_register,t[15]=this.svga_width,t[16]=this.svga_height,t[17]=this.crtc_mode,t[18]=this.svga_enabled,t[19]=this.svga_bpp,t[20]=this.svga_bank_offset,t[21]=this.svga_offset,t[22]=this.index_crtc,t[23]=this.dac_color_index_write,t[24]=this.dac_color_index_read,t[25]=this.dac_map,t[26]=this.sequencer_index,t[27]=this.plane_write_bm,t[28]=this.sequencer_memory_mode,t[29]=this.graphics_index,t[30]=this.plane_read,t[31]=this.planar_mode,t[32]=this.planar_rotate_reg,t[33]=this.planar_bitmap,t[34]=this.max_scan_line,t[35]=this.miscellaneous_output_register,t[36]=this.port_3DA_value,t[37]=this.dispi_index,t[38]=this.dispi_enable_value,t[39]=this.svga_memory,t[40]=this.graphical_mode_is_linear,t[41]=this.attribute_controller_index,t[42]=this.offset_register,t[43]=this.planar_setreset,t[44]=this.planar_setreset_enable,t[45]=this.start_address_latched,t[46]=this.crtc,t[47]=this.horizontal_display_enable_end,t[48]=this.horizontal_blank_start,t[49]=this.vertical_display_enable_end,t[50]=this.vertical_blank_start,t[51]=this.underline_location_register,t[52]=this.preset_row_scan,t[53]=this.offset_register,t[54]=this.palette_source,t[55]=this.attribute_mode,t[56]=this.color_plane_enable,t[57]=this.horizontal_panning,t[58]=this.color_select,t[59]=this.clocking_mode,t[60]=this.line_compare,t[61]=this.pixel_buffer,t[62]=this.dac_mask,t},K.prototype.set_state=function(t){this.vga_memory_size=t[0],this.cursor_address=t[1],this.cursor_scanline_start=t[2],this.cursor_scanline_end=t[3],this.max_cols=t[4],this.max_rows=t[5],t[6]&&this.vga_memory.set(t[6]),this.dac_state=t[7],this.start_address=t[8],this.graphical_mode=t[9],this.vga256_palette=t[10],this.latch_dword=t[11],this.color_compare=t[12],this.color_dont_care=t[13],this.miscellaneous_graphics_register=t[14],this.svga_width=t[15],this.svga_height=t[16],this.crtc_mode=t[17],this.svga_enabled=t[18],this.svga_bpp=t[19],this.svga_bank_offset=t[20],this.svga_offset=t[21],this.index_crtc=t[22],this.dac_color_index_write=t[23],this.dac_color_index_read=t[24],this.dac_map=t[25],this.sequencer_index=t[26],this.plane_write_bm=t[27],this.sequencer_memory_mode=t[28],this.graphics_index=t[29],this.plane_read=t[30],this.planar_mode=t[31],this.planar_rotate_reg=t[32],this.planar_bitmap=t[33],this.max_scan_line=t[34],this.miscellaneous_output_register=t[35],this.port_3DA_value=t[36],this.dispi_index=t[37],this.dispi_enable_value=t[38],this.svga_memory.set(t[39]),this.graphical_mode_is_linear=t[40],this.attribute_controller_index=t[41],this.offset_register=t[42],this.planar_setreset=t[43],this.planar_setreset_enable=t[44],this.start_address_latched=t[45],this.crtc.set(t[46]),this.horizontal_display_enable_end=t[47],this.horizontal_blank_start=t[48],this.vertical_display_enable_end=t[49],this.vertical_blank_start=t[50],this.underline_location_register=t[51],this.preset_row_scan=t[52],this.offset_register=t[53],this.palette_source=t[54],this.attribute_mode=t[55],this.color_plane_enable=t[56],this.horizontal_panning=t[57],this.color_select=t[58],this.clocking_mode=t[59],this.line_compare=t[60],t[61]&&this.pixel_buffer.set(t[61]),this.dac_mask=void 0===t[62]?255:t[62],this.bus.send("screen-set-mode",this.graphical_mode),this.graphical_mode?(this.screen_height=this.screen_width=0,this.svga_enabled?(this.set_size_graphical(this.svga_width,this.svga_height,this.svga_bpp,this.svga_width,this.svga_height),this.update_layers()):(this.update_vga_size(),this.update_layers(),this.complete_replot())):(this.set_size_text(this.max_cols,this.max_rows),this.update_cursor_scanline(),this.update_cursor()),this.complete_redraw()},K.prototype.vga_memory_read=function(t){if(this.svga_enabled&&this.graphical_mode_is_linear)return this.cpu.read8(3758096384+(t-655360|this.svga_bank_offset)|0);var e=this.miscellaneous_graphics_register>>2&3;return 0>(t-=$[e])||t>=Q[e]?(l(t),0):(this.latch_dword=this.plane0[t],this.latch_dword|=this.plane1[t]<<8,this.latch_dword|=this.plane2[t]<<16,this.latch_dword|=this.plane3[t]<<24,8&this.planar_mode?(e=255,1&this.color_dont_care&&(e&=this.plane0[t]^~(1&this.color_compare?255:0)),2&this.color_dont_care&&(e&=this.plane1[t]^~(2&this.color_compare?255:0)),4&this.color_dont_care&&(e&=this.plane2[t]^~(4&this.color_compare?255:0)),8&this.color_dont_care&&(e&=this.plane3[t]^~(8&this.color_compare?255:0)),e):(e=this.plane_read,this.graphical_mode?8&this.sequencer_memory_mode?(e=3&t,t&=-4):16&this.planar_mode&&(e=1&t,t&=-2):e=0,this.vga_memory[e<<16|t]))},K.prototype.vga_memory_write=function(t,e){if(this.svga_enabled&&this.graphical_mode&&this.graphical_mode_is_linear)this.cpu.write8(3758096384+(t-655360|this.svga_bank_offset)|0,e);else{var i=this.miscellaneous_graphics_register>>2&3;0>(t-=$[i])||t>=Q[i]?(l(t),l(e)):this.graphical_mode?this.vga_memory_write_graphical(t,e):3&this.plane_write_bm&&this.vga_memory_write_text_mode(t,e)}},K.prototype.vga_memory_write_graphical=function(t,e){var i=3&this.planar_mode,r=this.apply_feed(this.planar_bitmap),s=this.apply_expand(this.planar_setreset),n=this.apply_expand(this.planar_setreset_enable);switch(i){case 0:e=this.apply_rotate(e);var a=this.apply_feed(e);a=this.apply_setreset(a,n),a=this.apply_logical(a,this.latch_dword),a=this.apply_bitmask(a,r);break;case 1:a=this.latch_dword;break;case 2:a=this.apply_expand(e),a=this.apply_logical(a,this.latch_dword),a=this.apply_bitmask(a,r);break;case 3:e=this.apply_rotate(e),r&=this.apply_feed(e),a=this.apply_bitmask(s,r)}switch(e=15,12&this.sequencer_memory_mode){case 0:e=5<<(1&t),t&=-2;break;case 8:case 12:e=1<<(3&t),t&=-4}1&(e&=this.plane_write_bm)&&(this.plane0[t]=255&a),2&e&&(this.plane1[t]=a>>8&255),4&e&&(this.plane2[t]=a>>16&255),8&e&&(this.plane3[t]=a>>24&255),t=this.vga_addr_to_pixel(t),this.partial_replot(t,t+7)},K.prototype.apply_feed=function(t){return t|t<<8|t<<16|t<<24},K.prototype.apply_expand=function(t){return(1&t?255:0)|(2&t?255:0)<<8|(4&t?255:0)<<16|(8&t?255:0)<<24},K.prototype.apply_rotate=function(t){return(t|t<<8)>>>(7&this.planar_rotate_reg)&255},K.prototype.apply_setreset=function(t,e){var i=this.apply_expand(this.planar_setreset);return(t|e&i)&(~e|i)},K.prototype.apply_logical=function(t,e){switch(24&this.planar_rotate_reg){case 8:return t&e;case 16:return t|e;case 24:return t^e}return t},K.prototype.apply_bitmask=function(t,e){return e&t|~e&this.latch_dword},K.prototype.text_mode_redraw=function(){for(var t,e,i=this.start_address<<1,r=0;r<this.max_rows;r++)for(var s=0;s<this.max_cols;s++)t=this.vga_memory[i],e=this.vga_memory[1|i],this.bus.send("screen-put-char",[r,s,t,this.vga256_palette[this.dac_mask&this.dac_map[e>>4&15]],this.vga256_palette[this.dac_mask&this.dac_map[15&e]]]),i+=2},K.prototype.vga_memory_write_text_mode=function(t,e){var i=(t>>1)-this.start_address,r=i/this.max_cols|0;if(i%=this.max_cols,1&t)var s=e,n=this.vga_memory[-2&t];else n=e,s=this.vga_memory[1|t];this.bus.send("screen-put-char",[r,i,n,this.vga256_palette[this.dac_mask&this.dac_map[s>>4&15]],this.vga256_palette[this.dac_mask&this.dac_map[15&s]]]),this.vga_memory[t]=e},K.prototype.update_cursor=function(){var t=(this.cursor_address-this.start_address)/this.max_cols|0,e=(this.cursor_address-this.start_address)%this.max_cols;t=Math.min(this.max_rows-1,t),this.bus.send("screen-update-cursor",[t,e])},K.prototype.complete_redraw=function(){this.graphical_mode?this.svga_enabled?this.cpu.svga_mark_dirty():(this.diff_addr_min=0,this.diff_addr_max=524288):this.text_mode_redraw()},K.prototype.complete_replot=function(){this.graphical_mode&&!this.svga_enabled&&(this.diff_plot_min=0,this.diff_plot_max=524288,this.complete_redraw())},K.prototype.partial_redraw=function(t,e){t<this.diff_addr_min&&(this.diff_addr_min=t),e>this.diff_addr_max&&(this.diff_addr_max=e)},K.prototype.partial_replot=function(t,e){t<this.diff_plot_min&&(this.diff_plot_min=t),e>this.diff_plot_max&&(this.diff_plot_max=e),this.partial_redraw(t,e)},K.prototype.reset_diffs=function(){this.diff_addr_min=this.vga_memory_size,this.diff_addr_max=0,this.diff_plot_min=this.vga_memory_size,this.diff_plot_max=0},K.prototype.destroy=function(){},K.prototype.vga_bytes_per_line=function(){var t=this.offset_register<<2;return 64&this.underline_location_register?t<<=1:64&this.crtc_mode&&(t>>>=1),t},K.prototype.vga_addr_shift_count=function(){var t=128+(~this.underline_location_register&this.crtc_mode&64);return t-=64&this.underline_location_register,(t-=64&this.attribute_mode)>>>6},K.prototype.vga_addr_to_pixel=function(t){var e=this.vga_addr_shift_count();if(3&~this.crtc_mode){var i=t-this.start_address;i&=this.crtc_mode<<13|-24577;var r=(i<<=e)/this.virtual_width|0;switch(i%=this.virtual_width,3&this.crtc_mode){case 2:r=r<<1|t>>13&1;break;case 1:r=r<<1|t>>14&1;break;case 0:r=r<<2|t>>13&3}return r*this.virtual_width+i+(this.start_address<<e)}return t<<e},K.prototype.scan_line_to_screen_row=function(t){return 128&this.max_scan_line&&(t>>>=1),t=Math.ceil(t/(1+(31&this.max_scan_line))),1&this.crtc_mode||(t<<=1),2&this.crtc_mode||(t<<=1),t},K.prototype.set_size_text=function(t,e){this.max_cols=t,this.max_rows=e,this.bus.send("screen-set-size-text",[t,e])},K.prototype.set_size_graphical=function(t,e,i,r,s){if(!this.stats.is_graphical||this.stats.bpp!==i||this.screen_width!==t||this.screen_height!==e||this.virtual_width!==r||this.virtual_height!==s){if(this.screen_width=t,this.screen_height=e,this.virtual_width=r,this.virtual_height=s,this.stats.bpp=i,this.stats.is_graphical=!0,this.stats.res_x=t,this.stats.res_y=e,"undefined"!=typeof ImageData){let t=r*s,e=this.cpu.svga_allocate_dest_buffer(t)>>>0;this.dest_buffet_offset=e,this.image_data=new ImageData(new Uint8ClampedArray(this.cpu.wasm_memory.buffer,e,4*t),r,s),this.cpu.svga_mark_dirty()}this.bus.send("screen-set-size-graphical",[t,e,r,s,i])}},K.prototype.update_vga_size=function(){if(!this.svga_enabled){var t=Math.min(1+this.horizontal_display_enable_end,this.horizontal_blank_start),e=Math.min(1+this.vertical_display_enable_end,this.vertical_blank_start);if(t&&e)if(this.graphical_mode){t<<=3;var i=this.offset_register<<4;64&this.attribute_mode&&(t>>>=1,i>>>=1),e=this.scan_line_to_screen_row(e);var r=Math.ceil(Q[0]/this.vga_bytes_per_line());this.set_size_graphical(t,e,8,i,r),this.update_vertical_retrace(),this.update_layers()}else 128&this.max_scan_line&&(e>>>=1),i=e/(1+(31&this.max_scan_line))|0,t&&i&&this.set_size_text(t,i)}},K.prototype.update_layers=function(){if(this.graphical_mode||this.text_mode_redraw(),this.svga_enabled)this.layers=[];else if(this.virtual_width&&this.screen_width)if(!this.palette_source||32&this.clocking_mode)this.layers=[],this.bus.send("screen-clear");else{var t=this.start_address_latched,e=this.horizontal_panning;64&this.attribute_mode&&(e>>>=1);var i=this.preset_row_scan>>5&3,r=this.vga_addr_to_pixel(t+i);t=r/this.virtual_width|0;var s=r%this.virtual_width+e;r=this.scan_line_to_screen_row(1+this.line_compare),r=Math.min(r,this.screen_height);var n=this.screen_height-r;this.layers=[],s=-s;for(var a=0;s<this.screen_width;s+=this.virtual_width,a++)this.layers.push({image_data:this.image_data,screen_x:s,screen_y:0,buffer_x:0,buffer_y:t+a,buffer_width:this.virtual_width,buffer_height:r});for(t=0,32&this.attribute_mode||(t=this.vga_addr_to_pixel(i)+e),s=-t,a=0;s<this.screen_width;s+=this.virtual_width,a++)this.layers.push({image_data:this.image_data,screen_x:s,screen_y:r,buffer_x:0,buffer_y:a,buffer_width:this.virtual_width,buffer_height:n})}},K.prototype.update_vertical_retrace=function(){this.port_3DA_value|=8,this.start_address_latched!==this.start_address&&(this.start_address_latched=this.start_address,this.update_layers())},K.prototype.update_cursor_scanline=function(){this.bus.send("screen-update-cursor-scanline",[this.cursor_scanline_start,this.cursor_scanline_end])},K.prototype.port3C0_write=function(t){if(-1===this.attribute_controller_index)l(t),this.attribute_controller_index=31&t,l(this.attribute_controller_index),this.palette_source!==(32&t)&&(this.palette_source=32&t,this.update_layers());else{if(16>this.attribute_controller_index)l(this.attribute_controller_index),l(t),this.dac_map[this.attribute_controller_index]=t,64&this.attribute_mode||this.complete_redraw();else switch(this.attribute_controller_index){case 16:if(l(t),this.attribute_mode!==t){var e=this.attribute_mode;this.attribute_mode=t;var i=0<(1&t);this.svga_enabled||this.graphical_mode===i||(this.graphical_mode=i,this.bus.send("screen-set-mode",this.graphical_mode)),64&(e^t)&&this.complete_replot(),this.update_vga_size(),this.complete_redraw()}break;case 18:l(t),this.color_plane_enable!==t&&(this.color_plane_enable=t,this.complete_redraw());break;case 19:l(t),this.horizontal_panning!==t&&(this.horizontal_panning=15&t,this.update_layers());break;case 20:l(t),this.color_select!==t&&(this.color_select=t,this.complete_redraw());break;default:l(this.attribute_controller_index),l(t)}this.attribute_controller_index=-1}},K.prototype.port3C0_read=function(){return this.attribute_controller_index|this.palette_source},K.prototype.port3C0_read16=function(){return 255&this.port3C0_read()|this.port3C1_read()<<8&65280},K.prototype.port3C1_read=function(){if(16>this.attribute_controller_index)return l(this.attribute_controller_index),l(this.dac_map[this.attribute_controller_index]),255&this.dac_map[this.attribute_controller_index];switch(this.attribute_controller_index){case 16:return l(this.attribute_mode),this.attribute_mode;case 18:return l(this.color_plane_enable),this.color_plane_enable;case 19:return l(this.horizontal_panning),this.horizontal_panning;case 20:return l(this.color_select),this.color_select;default:l(this.attribute_controller_index)}return 255},K.prototype.port3C2_write=function(t){l(t),this.miscellaneous_output_register=t},K.prototype.port3C4_write=function(t){this.sequencer_index=t},K.prototype.port3C4_read=function(){return this.sequencer_index},K.prototype.port3C5_write=function(t){switch(this.sequencer_index){case 1:l(t);var e=this.clocking_mode;this.clocking_mode=t,32&(e^t)&&this.update_layers();break;case 2:l(t),this.plane_write_bm=t;break;case 4:l(t),this.sequencer_memory_mode=t;break;default:l(this.sequencer_index),l(t)}},K.prototype.port3C5_read=function(){switch(l(this.sequencer_index),this.sequencer_index){case 1:return this.clocking_mode;case 2:return this.plane_write_bm;case 4:return this.sequencer_memory_mode;case 6:return 18}return 0},K.prototype.port3C6_write=function(t){this.dac_mask=t},K.prototype.port3C6_read=function(){return this.dac_mask},K.prototype.port3C7_write=function(t){l(t),this.dac_color_index_read=3*t,this.dac_state&=0},K.prototype.port3C7_read=function(){return this.dac_state},K.prototype.port3C8_write=function(t){this.dac_color_index_write=3*t,this.dac_state|=3},K.prototype.port3C8_read=function(){return this.dac_color_index_write/3&255},K.prototype.port3C9_write=function(t){var e=this.dac_color_index_write/3|0,i=this.dac_color_index_write%3,r=this.vga256_palette[e];if(0==(32&this.dispi_enable_value)){let e=1&(t&=63);t=t<<2|e<<1|e}0===i?r=-16711681&r|t<<16:1===i?r=-65281&r|t<<8:(r=-256&r|t,l(e),l(r)),this.vga256_palette[e]!==r&&(this.vga256_palette[e]=r,this.complete_redraw()),this.dac_color_index_write++},K.prototype.port3C9_read=function(){var t=this.vga256_palette[this.dac_color_index_read/3|0]>>8*(2-this.dac_color_index_read%3)&255;return this.dac_color_index_read++,32&this.dispi_enable_value?t:t>>2},K.prototype.port3CC_read=function(){return this.miscellaneous_output_register},K.prototype.port3CE_write=function(t){this.graphics_index=t},K.prototype.port3CE_read=function(){return this.graphics_index},K.prototype.port3CF_write=function(t){switch(this.graphics_index){case 0:this.planar_setreset=t,l(t);break;case 1:this.planar_setreset_enable=t,l(t);break;case 2:this.color_compare=t,l(t);break;case 3:this.planar_rotate_reg=t,l(t);break;case 4:this.plane_read=t,l(t);break;case 5:var e=this.planar_mode;this.planar_mode=t,l(t),96&(e^t)&&this.complete_replot();break;case 6:l(t),this.miscellaneous_graphics_register!==t&&(this.miscellaneous_graphics_register=t,this.update_vga_size());break;case 7:this.color_dont_care=t,l(t);break;case 8:this.planar_bitmap=t,l(t);break;default:l(this.graphics_index),l(t)}},K.prototype.port3CF_read=function(){switch(l(this.graphics_index),this.graphics_index){case 0:return this.planar_setreset;case 1:return this.planar_setreset_enable;case 2:return this.color_compare;case 3:return this.planar_rotate_reg;case 4:return this.plane_read;case 5:return this.planar_mode;case 6:return this.miscellaneous_graphics_register;case 7:return this.color_dont_care;case 8:return this.planar_bitmap}return 0},K.prototype.port3D4_write=function(t){this.index_crtc=t},K.prototype.port3D4_read=function(){return this.index_crtc,this.index_crtc},K.prototype.port3D5_write=function(t){switch(this.index_crtc){case 1:l(t),this.horizontal_display_enable_end!==t&&(this.horizontal_display_enable_end=t,this.update_vga_size());break;case 2:this.horizontal_blank_start!==t&&(this.horizontal_blank_start=t,this.update_vga_size());break;case 7:l(t);var e=this.vertical_display_enable_end;this.vertical_display_enable_end&=255,this.vertical_display_enable_end=this.vertical_display_enable_end|t<<3&512|t<<7&256,e!=this.vertical_display_enable_end&&this.update_vga_size(),this.line_compare=767&this.line_compare|t<<4&256,e=this.vertical_blank_start,this.vertical_blank_start=767&this.vertical_blank_start|t<<5&256,e!==this.vertical_blank_start&&this.update_vga_size(),this.update_layers();break;case 8:l(t),this.preset_row_scan=t,this.update_layers();break;case 9:l(t),this.max_scan_line=t,this.line_compare=511&this.line_compare|t<<3&512,e=this.vertical_blank_start,this.vertical_blank_start=511&this.vertical_blank_start|t<<4&512,e!==this.vertical_blank_start&&this.update_vga_size(),this.update_layers();break;case 10:l(t),this.cursor_scanline_start=t,this.update_cursor_scanline();break;case 11:l(t),this.cursor_scanline_end=t,this.update_cursor_scanline();break;case 12:(this.start_address>>8&255)!==t&&(this.start_address=255&this.start_address|t<<8,this.update_layers(),3&~this.crtc_mode&&this.complete_replot()),l(t),l(this.start_address,4);break;case 13:(255&this.start_address)!==t&&(this.start_address=65280&this.start_address|t,this.update_layers(),3&~this.crtc_mode&&this.complete_replot()),l(t),l(this.start_address,4);break;case 14:l(t),this.cursor_address=255&this.cursor_address|t<<8,this.update_cursor();break;case 15:l(t),this.cursor_address=65280&this.cursor_address|t,this.update_cursor();break;case 18:l(t),(255&this.vertical_display_enable_end)!==t&&(this.vertical_display_enable_end=768&this.vertical_display_enable_end|t,this.update_vga_size());break;case 19:l(t),this.offset_register!==t&&(this.offset_register=t,this.update_vga_size(),3&~this.crtc_mode&&this.complete_replot());break;case 20:l(t),this.underline_location_register!==t&&(e=this.underline_location_register,this.underline_location_register=t,this.update_vga_size(),64&(e^t)&&this.complete_replot());break;case 21:l(t),(255&this.vertical_blank_start)!==t&&(this.vertical_blank_start=768&this.vertical_blank_start|t,this.update_vga_size());break;case 23:l(t),this.crtc_mode!==t&&(e=this.crtc_mode,this.crtc_mode=t,this.update_vga_size(),67&(e^t)&&this.complete_replot());break;case 24:l(t),this.line_compare=768&this.line_compare|t,this.update_layers();break;default:this.index_crtc<this.crtc.length&&(this.crtc[this.index_crtc]=t),l(this.index_crtc),l(t)}},K.prototype.port3D5_read=function(){switch(l(this.index_crtc),this.index_crtc){case 1:return this.horizontal_display_enable_end;case 2:return this.horizontal_blank_start;case 7:return this.vertical_display_enable_end>>7&2|this.vertical_blank_start>>5&8|this.line_compare>>4&16|this.vertical_display_enable_end>>3&64;case 8:return this.preset_row_scan;case 9:return this.max_scan_line;case 10:return this.cursor_scanline_start;case 11:return this.cursor_scanline_end;case 12:return 255&this.start_address;case 13:return this.start_address>>8;case 14:return this.cursor_address>>8;case 15:return 255&this.cursor_address;case 18:return 255&this.vertical_display_enable_end;case 19:return this.offset_register;case 20:return this.underline_location_register;case 21:return 255&this.vertical_blank_start;case 23:return this.crtc_mode;case 24:return 255&this.line_compare}return this.index_crtc<this.crtc.length?this.crtc[this.index_crtc]:0},K.prototype.port3DA_read=function(){var t=this.port_3DA_value;return this.graphical_mode?(this.port_3DA_value^=1,this.port_3DA_value&=1):(1&this.port_3DA_value&&(this.port_3DA_value^=8),this.port_3DA_value^=1),this.attribute_controller_index=-1,t},K.prototype.port1CE_write=function(t){this.dispi_index=t},K.prototype.port1CF_write=function(t){switch(l(this.dispi_index),l(t),this.dispi_index){case 0:45248<=t&&45253>=t?this.svga_version=t:l(t);break;case 1:this.svga_width=t,2560<this.svga_width&&(this.svga_width,this.svga_width=2560);break;case 2:this.svga_height=t,1600<this.svga_height&&(this.svga_height,this.svga_height=1600);break;case 3:this.svga_bpp=t;break;case 4:this.svga_enabled=1==(1&t),this.dispi_enable_value=t;break;case 5:l(t<<16),this.svga_bank_offset=t<<16;break;case 9:let e=t*this.svga_width;l(e),l(t),this.svga_offset!==e&&(this.svga_offset=e,this.complete_redraw())}!this.svga_enabled||this.svga_width&&this.svga_height||(this.svga_width,this.svga_height,this.svga_enabled=!1),this.svga_enabled,this.svga_width,this.svga_height,this.svga_bpp,this.svga_enabled&&4===this.dispi_index&&(this.set_size_graphical(this.svga_width,this.svga_height,this.svga_bpp,this.svga_width,this.svga_height),this.bus.send("screen-set-mode",!0),this.graphical_mode_is_linear=this.graphical_mode=!0),this.svga_enabled||(this.svga_bank_offset=0),this.update_layers()},K.prototype.port1CF_read=function(){return l(this.dispi_index),this.svga_register_read(this.dispi_index)},K.prototype.svga_register_read=function(t){switch(t){case 0:return this.svga_version;case 1:return 2&this.dispi_enable_value?2560:this.svga_width;case 2:return 2&this.dispi_enable_value?1600:this.svga_height;case 3:return 2&this.dispi_enable_value?32:this.svga_bpp;case 4:return this.dispi_enable_value;case 5:return this.svga_bank_offset>>>16;case 6:return this.screen_width?this.screen_width:1;case 8:return 0;case 10:return this.vga_memory_size/65536|0}return 255},K.prototype.vga_replot=function(){for(var t=-16&this.diff_plot_min,e=Math.min(15|this.diff_plot_max,524287),i=this.vga_addr_shift_count(),r=3&~this.crtc_mode,s=96&this.planar_mode,n=64&this.attribute_mode;t<=e;){var a=t>>>i;if(r){var o=t/this.virtual_width|0,l=t-this.virtual_width*o;switch(r){case 1:a=(1&o)<<13,o>>>=1;break;case 2:a=(1&o)<<14,o>>>=1;break;case 3:a=(3&o)<<13,o>>>=2}a|=(o*this.virtual_width+l>>>i)+this.start_address}o=this.plane0[a],l=this.plane1[a];var u=this.plane2[a],h=this.plane3[a];switch(a=new Uint8Array(8),s){case 0:o<<=0,l<<=1,u<<=2,h<<=3;for(var c=7;0<=c;c--)a[7-c]=o>>c&1|l>>c&2|u>>c&4|h>>c&8;break;case 32:a[0]=o>>6&3|u>>4&12,a[1]=o>>4&3|u>>2&12,a[2]=o>>2&3|12&u,a[3]=3&o|u<<2&12,a[4]=l>>6&3|h>>4&12,a[5]=l>>4&3|h>>2&12,a[6]=l>>2&3|12&h,a[7]=3&l|h<<2&12;break;case 64:case 96:a[0]=o>>4&15,a[1]=15&o,a[2]=l>>4&15,a[3]=15&l,a[4]=u>>4&15,a[5]=15&u,a[6]=h>>4&15,a[7]=15&h}if(n)for(o=c=0;4>c;c++,t++,o+=2)this.pixel_buffer[t]=a[o]<<4|a[o+1];else for(c=0;8>c;c++,t++)this.pixel_buffer[t]=a[c]}},K.prototype.vga_redraw=function(){var t=this.diff_addr_min,e=Math.min(this.diff_addr_max,524287);let i=new Int32Array(this.cpu.wasm_memory.buffer,this.dest_buffet_offset,this.virtual_width*this.virtual_height);var r=255,s=0;if(128&this.attribute_mode&&(r&=207,s|=this.color_select<<4&48),64&this.attribute_mode)for(;t<=e;t++){var n=this.pixel_buffer[t]&r|s;n=this.vga256_palette[n],i[t]=65280&n|n<<16|n>>16|4278190080}else for(r&=63,s|=this.color_select<<4&192;t<=e;t++)n=this.dac_map[this.pixel_buffer[t]&this.color_plane_enable]&r|s,n=this.vga256_palette[n],i[t]=65280&n|n<<16|n>>16|4278190080},K.prototype.screen_fill_buffer=function(){if(this.graphical_mode){if(0===this.image_data.data.byteLength){var t=new Uint8ClampedArray(this.cpu.wasm_memory.buffer,this.dest_buffet_offset,4*this.virtual_width*this.virtual_height);this.image_data=new ImageData(t,this.virtual_width,this.virtual_height),this.update_layers()}if(this.svga_enabled){t=0;let r=this.svga_height;if(8===this.svga_bpp){let t=new Int32Array(this.cpu.wasm_memory.buffer,this.dest_buffet_offset,this.screen_width*this.screen_height),r=new Uint8Array(this.cpu.wasm_memory.buffer,this.svga_memory.byteOffset,this.vga_memory_size);for(var e=0;e<t.length;e++){var i=this.vga256_palette[r[e]];t[e]=65280&i|i<<16|i>>16|4278190080}}else this.cpu.svga_fill_pixel_buffer(this.svga_bpp,this.svga_offset),e=15===this.svga_bpp?2:this.svga_bpp/8,t=((this.cpu.svga_dirty_bitmap_min_offset[0]/e|0)-this.svga_offset)/this.svga_width|0,r=1+(((this.cpu.svga_dirty_bitmap_max_offset[0]/e|0)-this.svga_offset)/this.svga_width|0);t<r&&(t=Math.max(t,0),r=Math.min(r,this.svga_height),this.bus.send("screen-fill-buffer-end",[{image_data:this.image_data,screen_x:0,screen_y:t,buffer_x:0,buffer_y:t,buffer_width:this.svga_width,buffer_height:r-t}]))}else this.vga_replot(),this.vga_redraw(),this.bus.send("screen-fill-buffer-end",this.layers);this.reset_diffs()}this.update_vertical_retrace()},X.prototype.clear_opstats=function(){new Uint8Array(this.wasm_memory.buffer,32768,131072).fill(0),this.wm.exports.profiler_init()},X.prototype.create_jit_imports=function(){let t=Object.create(null);t.m=this.wm.exports.memory;for(let e of Object.keys(this.wm.exports))e.startsWith("_")||e.startsWith("zstd")||e.endsWith("_js")||(t[e]=this.wm.exports[e]);this.jit_imports=t},X.prototype.wasm_patch=function(){let t=t=>this.wm.exports[t],e=e=>{const i=t(e);return console.assert(i,"Missing import: "+e),i};this.reset_cpu=e("reset_cpu"),this.getiopl=e("getiopl"),this.get_eflags=e("get_eflags"),this.get_eflags_no_arith=e("get_eflags_no_arith"),this.pic_call_irq=e("pic_call_irq"),this.do_many_cycles_native=e("do_many_cycles_native"),this.cycle_internal=e("cycle_internal"),this.read8=e("read8"),this.read16=e("read16"),this.read32s=e("read32s"),this.write8=e("write8"),this.write16=e("write16"),this.write32=e("write32"),this.in_mapped_range=e("in_mapped_range"),this.fpu_load_tag_word=e("fpu_load_tag_word"),this.fpu_load_status_word=e("fpu_load_status_word"),this.fpu_get_sti_f64=e("fpu_get_sti_f64"),this.translate_address_system_read=e("translate_address_system_read_js"),this.get_seg_cs=e("get_seg_cs"),this.get_real_eip=e("get_real_eip"),this.clear_tlb=e("clear_tlb"),this.full_clear_tlb=e("full_clear_tlb"),this.update_state_flags=e("update_state_flags"),this.set_tsc=e("set_tsc"),this.store_current_tsc=e("store_current_tsc"),this.set_cpuid_level=e("set_cpuid_level"),this.jit_clear_cache=e("jit_clear_cache_js"),this.jit_dirty_cache=e("jit_dirty_cache"),this.codegen_finalize_finished=e("codegen_finalize_finished"),this.allocate_memory=e("allocate_memory"),this.zero_memory=e("zero_memory"),this.svga_allocate_memory=e("svga_allocate_memory"),this.svga_allocate_dest_buffer=e("svga_allocate_dest_buffer"),this.svga_fill_pixel_buffer=e("svga_fill_pixel_buffer"),this.svga_mark_dirty=e("svga_mark_dirty"),this.zstd_create_ctx=e("zstd_create_ctx"),this.zstd_get_src_ptr=e("zstd_get_src_ptr"),this.zstd_free_ctx=e("zstd_free_ctx"),this.zstd_read=e("zstd_read"),this.zstd_read_free=e("zstd_read_free")},X.prototype.jit_force_generate=function(t){this.jit_force_generate_unsafe&&this.jit_force_generate_unsafe(t)},X.prototype.jit_clear_func=function(t){this.wm.wasm_table.set(t+1024,null)},X.prototype.jit_clear_all_funcs=function(){let t=this.wm.wasm_table;for(let e=0;900>e;e++)t.set(1024+e,null)},X.prototype.get_state=function(){var t=[];t[0]=this.memory_size[0],t[1]=this.segment_is_null,t[2]=this.segment_offsets,t[3]=this.segment_limits,t[4]=this.protected_mode[0],t[5]=this.idtr_offset[0],t[6]=this.idtr_size[0],t[7]=this.gdtr_offset[0],t[8]=this.gdtr_size[0],t[9]=this.page_fault[0],t[10]=this.cr,t[11]=this.cpl[0],t[13]=this.is_32[0],t[16]=this.stack_size_32[0],t[17]=this.in_hlt[0],t[18]=this.last_virt_eip[0],t[19]=this.eip_phys[0],t[22]=this.sysenter_cs[0],t[23]=this.sysenter_eip[0],t[24]=this.sysenter_esp[0],t[25]=this.prefixes[0],t[26]=this.flags[0],t[27]=this.flags_changed[0],t[28]=this.last_op1[0],t[30]=this.last_op_size[0],t[37]=this.instruction_pointer[0],t[38]=this.previous_ip[0],t[39]=this.reg32,t[40]=this.sreg,t[41]=this.dreg,t[42]=this.reg_pdpte,this.store_current_tsc(),t[43]=this.current_tsc,t[45]=this.devices.virtio_9p,t[46]=this.devices.apic,t[47]=this.devices.rtc,t[48]=this.devices.pci,t[49]=this.devices.dma,t[50]=this.devices.acpi,t[51]=this.devices.hpet,t[52]=this.devices.vga,t[53]=this.devices.ps2,t[54]=this.devices.uart0,t[55]=this.devices.fdc,t[56]=this.devices.cdrom,t[57]=this.devices.hda,t[58]=this.devices.pit,t[59]=this.devices.net,t[60]=this.devices.pic,t[61]=this.devices.sb16,t[62]=this.fw_value,t[63]=this.devices.ioapic,t[64]=this.tss_size_32[0],t[66]=this.reg_xmm32s,t[67]=this.fpu_st,t[68]=this.fpu_stack_empty[0],t[69]=this.fpu_stack_ptr[0],t[70]=this.fpu_control_word[0],t[71]=this.fpu_ip[0],t[72]=this.fpu_ip_selector[0],t[73]=this.fpu_dp[0],t[74]=this.fpu_dp_selector[0],t[75]=this.fpu_opcode[0];let{packed_memory:e,bitmap:i}=this.pack_memory();return t[77]=e,t[78]=new Uint8Array(i.get_buffer()),t[79]=this.devices.uart1,t[80]=this.devices.uart2,t[81]=this.devices.uart3,t},X.prototype.set_state=function(t){this.memory_size[0]=t[0],this.mem8.length!==this.memory_size[0]&&console.warn("Note: Memory size mismatch. we="+this.mem8.length+" state="+this.memory_size[0]),this.segment_is_null.set(t[1]),this.segment_offsets.set(t[2]),this.segment_limits.set(t[3]),this.protected_mode[0]=t[4],this.idtr_offset[0]=t[5],this.idtr_size[0]=t[6],this.gdtr_offset[0]=t[7],this.gdtr_size[0]=t[8],this.page_fault[0]=t[9],this.cr.set(t[10]),this.cpl[0]=t[11],this.is_32[0]=t[13],this.stack_size_32[0]=t[16],this.in_hlt[0]=t[17],this.last_virt_eip[0]=t[18],this.eip_phys[0]=t[19],this.sysenter_cs[0]=t[22],this.sysenter_eip[0]=t[23],this.sysenter_esp[0]=t[24],this.prefixes[0]=t[25],this.flags[0]=t[26],this.flags_changed[0]=t[27],this.last_op1[0]=t[28],this.last_op_size[0]=t[30],this.instruction_pointer[0]=t[37],this.previous_ip[0]=t[38],this.reg32.set(t[39]),this.sreg.set(t[40]),this.dreg.set(t[41]),t[42]&&this.reg_pdpte.set(t[42]),this.set_tsc(t[43][0],t[43][1]),this.devices.virtio_9p&&this.devices.virtio_9p.set_state(t[45]),this.devices.apic&&this.devices.apic.set_state(t[46]),this.devices.rtc&&this.devices.rtc.set_state(t[47]),this.devices.pci&&this.devices.pci.set_state(t[48]),this.devices.dma&&this.devices.dma.set_state(t[49]),this.devices.acpi&&this.devices.acpi.set_state(t[50]),this.devices.hpet&&this.devices.hpet.set_state(t[51]),this.devices.vga&&this.devices.vga.set_state(t[52]),this.devices.ps2&&this.devices.ps2.set_state(t[53]),this.devices.uart0&&this.devices.uart0.set_state(t[54]),this.devices.fdc&&this.devices.fdc.set_state(t[55]),this.devices.cdrom&&this.devices.cdrom.set_state(t[56]),this.devices.hda&&this.devices.hda.set_state(t[57]),this.devices.pit&&this.devices.pit.set_state(t[58]),this.devices.net&&this.devices.net.set_state(t[59]),this.devices.pic&&this.devices.pic.set_state(t[60]),this.devices.sb16&&this.devices.sb16.set_state(t[61]),this.devices.uart1&&this.devices.uart1.set_state(t[79]),this.devices.uart2&&this.devices.uart2.set_state(t[80]),this.devices.uart3&&this.devices.uart3.set_state(t[81]),this.fw_value=t[62],this.devices.ioapic&&this.devices.ioapic.set_state(t[63]),this.tss_size_32[0]=t[64],this.reg_xmm32s.set(t[66]),this.fpu_st.set(t[67]),this.fpu_stack_empty[0]=t[68],this.fpu_stack_ptr[0]=t[69],this.fpu_control_word[0]=t[70],this.fpu_ip[0]=t[71],this.fpu_ip_selector[0]=t[72],this.fpu_dp[0]=t[73],this.fpu_dp_selector[0]=t[74],this.fpu_opcode[0]=t[75];let e=new o.Bitmap(t[78].buffer);this.unpack_memory(e,t[77]),this.update_state_flags(),this.full_clear_tlb(),this.jit_clear_cache()},X.prototype.pack_memory=function(){for(var t=this.mem8.length>>12,e=[],i=0;i<t;i++){var r=i<<12;r=this.mem32s.subarray(r>>2,r+4096>>2);let t=!0;for(let e=0;e<r.length;e++)if(0!==r[e]){t=!1;break}t||e.push(i)}t=new o.Bitmap(t),i=new Uint8Array(e.length<<12);for(let[s,n]of e.entries())t.set(n,1),e=n<<12,e=this.mem8.subarray(e,e+4096),i.set(e,s<<12);return{bitmap:t,packed_memory:i}},X.prototype.unpack_memory=function(t,e){this.zero_memory(this.memory_size[0]);let i=this.memory_size[0]>>12,r=0;for(let n=0;n<i;n++)if(t.get(n)){var s=r<<12;s=e.subarray(s,s+4096),this.mem8.set(s,n<<12),r++}},X.prototype.main_run=function(){if(this.in_hlt[0]){var t=this.hlt_loop();if(this.in_hlt[0])return t}let e=t=Y.microtick();for(;1>e-t;){this.do_many_cycles(),e=Y.microtick();let t=this.run_hardware_timers(e);if(this.handle_irqs(),this.in_hlt[0])return t}return 0},X.prototype.reboot_internal=function(){this.reset_cpu(),this.fw_value=[],this.devices.virtio&&this.devices.virtio.reset(),this.load_bios()},X.prototype.reset_memory=function(){this.mem8.fill(0)},X.prototype.create_memory=function(t){1048576>t?t=1048576:0>(0|t)&&(t=Math.pow(2,31)-131072),t=1+(t-1|131071)|0,console.assert(0===this.memory_size[0],"Expected uninitialised memory"),this.memory_size[0]=t;let e=this.allocate_memory(t);this.mem8=o.view(Uint8Array,this.wasm_memory,e,t),this.mem32s=o.view(Uint32Array,this.wasm_memory,e,t>>2)},a.exportProperty(X.prototype,"create_memory",X.prototype.create_memory),X.prototype.init=function(t,e){"number"==typeof t.log_level&&(LOG_LEVEL=t.log_level),this.create_memory("number"==typeof t.memory_size?t.memory_size:67108864),t.cpuid_level&&this.set_cpuid_level(t.cpuid_level),this.acpi_enabled[0]=+t.acpi,this.reset_cpu();var i=new y(this);if(this.io=i,this.bios.main=t.bios,this.bios.vga=t.vga_bios,this.load_bios(),t.bzimage){let{option_rom:e}=load_kernel(this.mem8,t.bzimage,t.initrd,t.cmdline||"");e&&this.option_roms.push(e)}i.register_read(179,this,(function(){return 0}));var r=0;i.register_read(146,this,(function(){return r})),i.register_write(146,this,(function(t){r=t})),i.register_read(1297,this,(function(){return this.fw_pointer<this.fw_value.length?this.fw_value[this.fw_pointer++]:0})),i.register_write(1296,this,void 0,(function(t){function e(t){return new Uint8Array(new Int32Array([t]).buffer)}function i(t){return t>>8|t<<8&65280}function r(t){return t<<24|t<<8&16711680|t>>8&65280|t>>>24}if(l(t),this.fw_pointer=0,0===t)this.fw_value=e(1431127377);else if(1===t)this.fw_value=e(0);else if(3===t)this.fw_value=e(this.memory_size[0]);else if(5===t)this.fw_value=e(1);else if(15===t)this.fw_value=e(1);else if(13===t)this.fw_value=new Uint8Array(16);else if(25===t){t=new Int32Array(4+64*this.option_roms.length);let e=new Uint8Array(t.buffer);t[0]=r(this.option_roms.length);for(let s=0;s<this.option_roms.length;s++){let{name:n,data:a}=this.option_roms[s],o=4+64*s;t[o+0>>2]=r(a.length),t[o+4>>2]=i(49152+s);for(let t=0;t<n.length;t++)e[o+8+t]=n.charCodeAt(t)}this.fw_value=e}else 32768<=t&&49152>t?this.fw_value=e(0):49152<=t&&t-49152<this.option_roms.length?this.fw_value=this.option_roms[t-49152].data:(l(t),this.fw_value=e(0))})),this.devices={},t.load_devices&&(this.devices.pic=new S(this),this.devices.pci=new C(this),this.acpi_enabled[0]&&(this.devices.ioapic=new v(this),this.devices.apic=new n(this),this.devices.acpi=new J(this)),this.devices.rtc=new p(this),this.fill_cmos(this.devices.rtc,t),this.devices.dma=new _(this),this.devices.vga=new K(this,e,t.vga_memory_size||8388608),this.devices.ps2=new E(this,e),this.devices.uart0=new H(this,1016,e),t.uart1&&(this.devices.uart1=new H(this,760,e)),t.uart2&&(this.devices.uart2=new H(this,1e3,e)),t.uart3&&(this.devices.uart3=new H(this,744,e)),this.devices.fdc=new f(this,t.fda,t.fdb),i=0,t.hda&&(this.devices.hda=new m(this,t.hda,t.hdb,!1,i++,e)),t.cdrom&&(this.devices.cdrom=new m(this,t.cdrom,void 0,!0,i++,e)),this.devices.pit=new A(this,e),t.enable_ne2k&&(this.devices.net=new x(this,e,t.preserve_mac_from_state_image,t.mac_address_translation)),t.fs9p&&(this.devices.virtio_9p=new Virtio9p(t.fs9p,this,e)),this.devices.sb16=new T(this,e)),t.multiboot&&this.load_multiboot(t.multiboot)},X.prototype.load_multiboot=function(t){if(t.byteLength,LOG_CPU,8192>t.byteLength){var e=new Int32Array(2048);new Uint8Array(e.buffer).set(new Uint8Array(t))}else e=new Int32Array(t,0,2048);for(var i=0;8192>i;i+=4)if(464367618===e[i>>2]){var r=e[i+4>>2];if(!(464367618+r+e[i+8>>2]|0)){l(r>>>0,8),LOG_CPU,this.reg32[REG_EAX]=732803074,this.reg32[REG_EBX]=31744,this.write32(31744,0),this.cr[0]=1,this.protected_mode[0]=1,this.flags[0]=FLAGS_DEFAULT,this.is_32[0]=1,this.stack_size_32[0]=1;for(var s=0;6>s;s++)this.segment_is_null[s]=0,this.segment_offsets[s]=0,this.segment_limits[s]=4294967295,this.sreg[s]=45058;if(65536&r){LOG_CPU,r=e[i+12>>2];var n=e[i+16>>2];s=e[i+20>>2];var a=e[i+24>>2];e=e[i+28>>2],l(r,8),l(n,8),l(s,8),l(a,8),l(e,8),t=new Uint8Array(t,i-(r-n),0===s?void 0:s-n),this.write_blob(t,n),this.instruction_pointer[0]=this.get_seg_cs()+e|0}else if(1179403647===e[0])for(n of(LOG_CPU,i=read_elf(t),this.instruction_pointer[0]=this.get_seg_cs()+i.header.entry|0,i.program_headers))0!==n.type&&(1===n.type?n.paddr+n.memsz<this.memory_size[0]?n.filesz&&(i=new Uint8Array(t,n.offset,n.filesz),this.write_blob(i,n.paddr)):(l(n.paddr),n.memsz,LOG_CPU):2!==n.type&&3!==n.type&&4!==n.type&&6!==n.type&&1685382480!==n.type&&1685382481!==n.type&&1685382483!==n.type&&l(n.type));this.io.register_write_consecutive(244,this,(function(t){throw console.log("Test exited with code "+l(t,2)),"HALT"}),(function(){}),(function(){}),(function(){}));for(let o=0;15>=o;o++){function u(t){l(o),l(t,2),t?this.device_raise_irq(o):this.device_lower_irq(o)}this.io.register_write(8192+o,this,u,u,u)}this.update_state_flags(),LOG_CPU,this.debug.dump_state(),this.debug.dump_regs();break}LOG_CPU}},X.prototype.fill_cmos=function(t,e){var i=e.boot_order||531;t.cmos_write(56,1|i>>4&240),t.cmos_write(61,255&i),t.cmos_write(21,128),t.cmos_write(22,2),i=0,1048576<=this.memory_size[0]&&(i=this.memory_size[0]-1048576>>10,i=Math.min(i,65535)),t.cmos_write(23,255&i),t.cmos_write(24,i>>8&255),t.cmos_write(48,255&i),t.cmos_write(49,i>>8&255),i=0,16777216<=this.memory_size[0]&&(i=this.memory_size[0]-16777216>>16,i=Math.min(i,65535)),t.cmos_write(52,255&i),t.cmos_write(53,i>>8&255),t.cmos_write(91,0),t.cmos_write(92,0),t.cmos_write(93,0),t.cmos_write(20,47),t.cmos_write(95,0),e.fastboot&&t.cmos_write(63,1)},X.prototype.load_bios=function(){var t=this.bios.main,e=this.bios.vga;if(t){var i=new Uint8Array(t);if(this.write_blob(i,1048576-t.byteLength),e){var r=new Uint8Array(e);this.write_blob(r,786432),this.io.mmap_register(4272947200,1048576,(function(t){return(t=t-4272947200|0)<r.length?r[t]:0}),(function(){}))}this.io.mmap_register(4293918720,1048576,function(t){return this.mem8[1048575&t]}.bind(this),function(t,e){this.mem8[1048575&t]=e}.bind(this))}},X.prototype.do_many_cycles=function(){this.do_many_cycles_native()},X.prototype.cycle=function(){this.cycle_internal()},a.exportProperty(X.prototype,"cycle",X.prototype.cycle),X.prototype.codegen_finalize=function(t,e,i,r,s){let n=new Uint8Array(this.wasm_memory.buffer,r>>>0,s>>>0);WebAssembly.instantiate(n,{e:this.jit_imports}).then((r=>{this.wm.wasm_table.set(t+1024,r.instance.exports.f),this.codegen_finalize_finished(t,e,i),this.test_hook_did_finalize_wasm&&this.test_hook_did_finalize_wasm(n)}))},X.prototype.log_uncompiled_code=function(){},X.prototype.dump_function_code=function(){},X.prototype.hlt_loop=function(){if(512&this.get_eflags_no_arith()){let t=this.run_hardware_timers(Y.microtick());return this.handle_irqs(),t}return 100},X.prototype.run_hardware_timers=function(t){var e=this.devices.pit.timer(t,!1),i=this.devices.rtc.timer(t,!1);let r=100,s=100;return this.acpi_enabled[0]&&(r=this.devices.acpi.timer(t),s=this.devices.apic.timer(t)),Math.min(e,i,100,r,s)},X.prototype.hlt_op=function(){0==(512&this.get_eflags_no_arith())&&this.bus.send("cpu-event-halt"),this.in_hlt[0]=1,this.hlt_loop()},X.prototype.handle_irqs=function(){512&this.get_eflags_no_arith()&&(this.pic_acknowledge(),this.next_tick_immediately())},X.prototype.pic_acknowledge=function(){this.get_eflags_no_arith(),this.devices.pic&&this.devices.pic.acknowledge_irq(),this.devices.apic&&this.devices.apic.acknowledge_irq()},X.prototype.device_raise_irq=function(t){this.devices.pic&&this.devices.pic.set_irq(t),this.devices.ioapic&&this.devices.ioapic.set_irq(t)},X.prototype.device_lower_irq=function(t){this.devices.pic&&this.devices.pic.clear_irq(t),this.devices.ioapic&&this.devices.ioapic.clear_irq(t)},Y.prototype.run=function(){this.stopping=!1,this.running||(this.running=!0,this.bus.send("emulator-started")),this.next_tick(0)},Y.prototype.do_tick=function(){if(this.stopping||!this.running)this.stopping=this.running=!1,this.bus.send("emulator-stopped");else{this.idle=!1;var t=this.cpu.main_run();this.next_tick(t)}},Y.prototype.next_tick=function(t){let e=++this.tick_counter;this.idle=!0,this.yield(t,e)},Y.prototype.yield_callback=function(t){t===this.tick_counter&&this.do_tick()},Y.prototype.stop=function(){this.running&&(this.stopping=!0)},Y.prototype.destroy=function(){this.unregister_yield()},Y.prototype.restart=function(){this.cpu.reset_cpu(),this.cpu.load_bios()},Y.prototype.init=function(t){this.cpu.init(t,this.bus),this.bus.send("emulator-ready")},"undefined"!=typeof process&&i.g.setImmediate)Y.prototype.yield=function(t,e){1>t?i.g.setImmediate((t=>this.yield_callback(t)),e):setTimeout((t=>this.yield_callback(t)),t,e)},Y.prototype.register_yield=function(){},Y.prototype.unregister_yield=function(){};else if("undefined"!=typeof Worker){function Lt(){globalThis.onmessage=function(t){let e=t.data.t;1>e?postMessage(t.data.tick):setTimeout((()=>postMessage(t.data.tick)),e)}}Y.prototype.register_yield=function(){let t=URL.createObjectURL(new Blob(["("+Lt.toString()+")()"],{type:"text/javascript"}));this.worker=new Worker(t),this.worker.onmessage=t=>this.yield_callback(t.data),URL.revokeObjectURL(t)},Y.prototype.yield=function(t,e){this.worker.postMessage({t:t,tick:e})},Y.prototype.unregister_yield=function(){this.worker.terminate(),this.worker=null}}else Y.prototype.yield=function(t){setTimeout((()=>{this.do_tick()}),t)},Y.prototype.register_yield=function(){},Y.prototype.unregister_yield=function(){};function J(t){this.cpu=t;var e=t.io;t.devices.pci.register_device({pci_id:56,pci_space:[134,128,19,113,7,0,128,2,8,0,128,6,0,0,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,1,0,0],pci_bars:[],name:"acpi"}),this.timer_imprecision_offset=this.timer_last_value=0,this.status=1,this.pm1_enable=this.pm1_status=0,this.last_timer=this.get_timer(Y.microtick()),this.gpe=new Uint8Array(4),e.register_read(45056,this,void 0,(function(){return dbg_log("ACPI pm1_status read",LOG_ACPI),this.pm1_status})),e.register_write(45056,this,void 0,(function(t){dbg_log("ACPI pm1_status write: "+h(t,4),LOG_ACPI),this.pm1_status&=~t})),e.register_read(45058,this,void 0,(function(){return dbg_log("ACPI pm1_enable read",LOG_ACPI),this.pm1_enable})),e.register_write(45058,this,void 0,(function(t){dbg_log("ACPI pm1_enable write: "+h(t),LOG_ACPI),this.pm1_enable=t})),e.register_read(45060,this,void 0,(function(){return dbg_log("ACPI status read",LOG_ACPI),this.status})),e.register_write(45060,this,void 0,(function(t){dbg_log("ACPI status write: "+h(t),LOG_ACPI),this.status=t})),e.register_read(45064,this,void 0,void 0,(function(){return 16777215&this.get_timer(Y.microtick())})),e.register_read(45024,this,(function(){return dbg_log("Read gpe#0",LOG_ACPI),this.gpe[0]})),e.register_read(45025,this,(function(){return dbg_log("Read gpe#1",LOG_ACPI),this.gpe[1]})),e.register_read(45026,this,(function(){return dbg_log("Read gpe#2",LOG_ACPI),this.gpe[2]})),e.register_read(45027,this,(function(){return dbg_log("Read gpe#3",LOG_ACPI),this.gpe[3]})),e.register_write(45024,this,(function(t){dbg_log("Write gpe#0: "+h(t),LOG_ACPI),this.gpe[0]=t})),e.register_write(45025,this,(function(t){dbg_log("Write gpe#1: "+h(t),LOG_ACPI),this.gpe[1]=t})),e.register_write(45026,this,(function(t){dbg_log("Write gpe#2: "+h(t),LOG_ACPI),this.gpe[2]=t})),e.register_write(45027,this,(function(t){dbg_log("Write gpe#3: "+h(t),LOG_ACPI),this.gpe[3]=t}))}Y.prototype.save_state=function(){return this.cpu.save_state()},Y.prototype.restore_state=function(t){return this.cpu.restore_state(t)},Y.microtick="object"==typeof performance&&performance.now?performance.now.bind(performance):"object"==typeof process&&process.hrtime?function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:Date.now,J.prototype.timer=function(t){var e=0!=(8388608&((t=this.get_timer(t))^this.last_timer));return 1&this.pm1_enable&&e?(dbg_log("ACPI raise irq",LOG_ACPI),this.pm1_status|=1,this.cpu.device_raise_irq(9)):this.cpu.device_lower_irq(9),this.last_timer=t,100},J.prototype.get_timer=function(t){return(t=Math.round(3579.545*t))===this.timer_last_value?3579.545>this.timer_imprecision_offset&&this.timer_imprecision_offset++:(dbg_assert(t>this.timer_last_value),this.timer_last_value+this.timer_imprecision_offset<=t?(this.timer_imprecision_offset=0,this.timer_last_value=t):dbg_log("Warning: Overshot pmtimer, waiting; current="+t+" last="+this.timer_last_value+" offset="+this.timer_imprecision_offset,LOG_ACPI)),this.timer_last_value+this.timer_imprecision_offset},J.prototype.get_state=function(){var t=[];return t[0]=this.status,t[1]=this.pm1_status,t[2]=this.pm1_enable,t[3]=this.gpe,t},J.prototype.set_state=function(t){this.status=t[0],this.pm1_status=t[1],this.pm1_enable=t[2],this.gpe=t[3]},function(){function t(t){this.buffer=t,this.byteLength=t.byteLength,this.onprogress=this.onload=void 0}function e(t,e,i){this.filename=t,this.byteLength=e,this.block_cache=new Map,this.block_cache_is_write=new Set,this.fixed_chunk_size=i,this.cache_reads=!!i,this.onprogress=this.onload=void 0}function r(t,e,i,r){let s=t.match(/(.*)(\..*)/);s?(this.basename=s[1],this.extension=s[2]):(this.basename=t,this.extension=""),this.basename.endsWith("/")||(this.basename+="-"),this.block_cache=new Map,this.block_cache_is_write=new Set,this.byteLength=e,this.fixed_chunk_size=i,this.partfile_alt_format=!!r,this.cache_reads=!!i,this.onprogress=this.onload=void 0}function s(t){this.file=t,this.byteLength=t.size,1073741824<t.size&&console.warn("SyncFileBuffer: Allocating buffer of "+(t.size>>20)+" MB ..."),this.buffer=new ArrayBuffer(t.size),this.onprogress=this.onload=void 0}function n(t){this.file=t,this.byteLength=t.size,this.block_cache=new Map,this.block_cache_is_write=new Set,this.onprogress=this.onload=void 0}o.SyncBuffer=t,o.AsyncXHRBuffer=e,o.AsyncXHRPartfileBuffer=r,o.AsyncFileBuffer=n,o.SyncFileBuffer=s,t.prototype.load=function(){this.onload&&this.onload({buffer:this.buffer})},t.prototype.get=function(t,e,i){i(new Uint8Array(this.buffer,t,e))},t.prototype.set=function(t,e,i){new Uint8Array(this.buffer,t,e.byteLength).set(e),i()},t.prototype.get_buffer=function(t){t(this.buffer)},t.prototype.get_state=function(){let t=[];return t[0]=this.byteLength,t[1]=new Uint8Array(this.buffer),t},t.prototype.set_state=function(t){this.byteLength=t[0],this.buffer=t[1].slice().buffer},e.prototype.load=function(){void 0!==this.byteLength?this.onload&&this.onload(Object.create(null)):a(this.filename,((t,e)=>{if(t)throw Error("Cannot use: "+this.filename+". "+t);this.byteLength=e,this.onload&&this.onload(Object.create(null))}))},e.prototype.get_from_cache=function(t,e){var i=e/256;t/=256;for(var r=0;r<i;r++)if(!this.block_cache.get(t+r))return;if(1===i)return this.block_cache.get(t);for(e=new Uint8Array(e),r=0;r<i;r++)e.set(this.block_cache.get(t+r),256*r);return e},e.prototype.get=function(t,e,i){var r=this.get_from_cache(t,e);if(r)i(r);else{var s=t,n=e;this.fixed_chunk_size&&(s=t-t%this.fixed_chunk_size,n=Math.ceil((t-s+e)/this.fixed_chunk_size)*this.fixed_chunk_size),o.load_file(this.filename,{done:function(r){r=new Uint8Array(r),this.handle_read(s,n,r),i(s===t&&n===e?r:r.subarray(t-s,t-s+e))}.bind(this),range:{start:s,length:n}})}},e.prototype.set=function(t,e,i){t/=256;for(var r=e.length/256,s=0;s<r;s++){var n=this.block_cache.get(t+s);if(void 0===n)n=e.slice(256*s,256*(s+1)),this.block_cache.set(t+s,n);else{let t=e.subarray(256*s,256*(s+1));n.set(t)}this.block_cache_is_write.add(t+s)}i()},e.prototype.handle_read=function(t,e,i){t/=256,e/=256;for(var r=0;r<e;r++){let e=this.block_cache.get(t+r);e?i.set(e,256*r):this.cache_reads&&this.block_cache.set(t+r,i.slice(256*r,256*(r+1)))}},e.prototype.get_buffer=function(t){t()},e.prototype.get_state=function(){let t=[],e=[];for(let[i,r]of this.block_cache)this.block_cache_is_write.has(i)&&e.push([i,r]);return t[0]=e,t},e.prototype.set_state=function(t){t=t[0],this.block_cache.clear(),this.block_cache_is_write.clear();for(let[e,i]of t)this.block_cache.set(e,i),this.block_cache_is_write.add(e)},r.prototype.load=function(){this.onload&&this.onload(Object.create(null))},r.prototype.get=function(t,e,i){var r=this.get_from_cache(t,e);if(r)i(r);else if(this.fixed_chunk_size){let n=Math.floor(t/this.fixed_chunk_size),a=t-n*this.fixed_chunk_size,l=Math.ceil((a+e)/this.fixed_chunk_size),u=new Uint8Array(l*this.fixed_chunk_size),h=0;for(let t=0;t<l;t++){var s=(n+t)*this.fixed_chunk_size;r=this.partfile_alt_format?this.basename+(n+t+"").padStart(8,"0")+this.extension:this.basename+s+"-"+(s+this.fixed_chunk_size)+this.extension,(s=this.get_from_cache(s,this.fixed_chunk_size))?(u.set(s,t*this.fixed_chunk_size),h++,h===l&&(r=u.subarray(a,a+e),i(r))):o.load_file(r,{done:function(r){var s=t*this.fixed_chunk_size;r=new Uint8Array(r),this.handle_read((n+t)*this.fixed_chunk_size,0|this.fixed_chunk_size,r),u.set(r,s),h++,h===l&&(s=u.subarray(a,a+e),i(s))}.bind(this)})}}else o.load_file(this.basename+t+"-"+(t+e)+this.extension,{done:function(r){r=new Uint8Array(r),this.handle_read(t,e,r),i(r)}.bind(this)})},r.prototype.get_from_cache=e.prototype.get_from_cache,r.prototype.set=e.prototype.set,r.prototype.handle_read=e.prototype.handle_read,r.prototype.get_state=e.prototype.get_state,r.prototype.set_state=e.prototype.set_state,s.prototype.load=function(){this.load_next(0)},s.prototype.load_next=function(t){var e=new FileReader;if(e.onload=function(e){e=new Uint8Array(e.target.result),new Uint8Array(this.buffer,t).set(e),this.load_next(t+4194304)}.bind(this),this.onprogress&&this.onprogress({loaded:t,total:this.byteLength,lengthComputable:!0}),t<this.byteLength){var i=this.file.slice(t,Math.min(t+4194304,this.byteLength));e.readAsArrayBuffer(i)}else this.file=void 0,this.onload&&this.onload({buffer:this.buffer})},s.prototype.get=t.prototype.get,s.prototype.set=t.prototype.set,s.prototype.get_buffer=t.prototype.get_buffer,s.prototype.get_state=t.prototype.get_state,s.prototype.set_state=t.prototype.set_state,n.prototype.load=function(){this.onload&&this.onload(Object.create(null))},n.prototype.get=function(t,e,i){var r=this.get_from_cache(t,e);r?i(r):((r=new FileReader).onload=function(r){r=new Uint8Array(r.target.result),this.handle_read(t,e,r),i(r)}.bind(this),r.readAsArrayBuffer(this.file.slice(t,t+e)))},n.prototype.get_from_cache=e.prototype.get_from_cache,n.prototype.set=e.prototype.set,n.prototype.handle_read=e.prototype.handle_read,n.prototype.get_state=e.prototype.get_state,n.prototype.set_state=e.prototype.set_state,n.prototype.get_buffer=function(t){t()},n.prototype.get_as_file=function(t){for(var e=[],i=Array.from(this.block_cache.keys()).sort((function(t,e){return t-e})),r=0,s=0;s<i.length;s++){var n=i[s],a=this.block_cache.get(n);(n*=256)!==r&&(e.push(this.file.slice(r,n)),r=n),e.push(a),r+=a.length}return r!==this.file.size&&e.push(this.file.slice(r)),new File(e,t)};var a="undefined"==typeof XMLHttpRequest?function(t,e){i(919).stat(t,((t,i)=>{t?e(t):e(null,i.size)}))}:function(t,e){o.load_file(t,{done:(t,i)=>{t=i.getResponseHeader("Content-Range")||"",(i=t.match(/\/(\d+)\s*$/))?e(null,+i[1]):e("`Range: bytes=...` header not supported (Got `"+t+"`)")},headers:{Range:"bytes=0-0"}})}}();var Z={};function tt(){this.listeners={},this.pair=void 0}tt.prototype.register=function(t,e,i){var r=this.listeners[t];void 0===r&&(r=this.listeners[t]=[]),r.push({fn:e,this_value:i})},tt.prototype.unregister=function(t,e){var i=this.listeners[t];void 0!==i&&(this.listeners[t]=i.filter((function(t){return t.fn!==e})))},tt.prototype.send=function(t,e){if(this.pair&&void 0!==(t=this.pair.listeners[t]))for(var i=0;i<t.length;i++){var r=t[i];r.fn.call(r.this_value,e)}},tt.prototype.send_async=function(t,e){dbg_assert(1===arguments.length||2===arguments.length),setTimeout(this.send.bind(this,t,e),0)},Z.create=function(){var t=new tt,e=new tt;return t.pair=e,e.pair=t,[t,e]},X.prototype.debug_init=function(){var t=this,e={};let i;this.debug=e,e.init=function(){},e.get_regs_short=function(){},e.dump_regs=function(){},e.get_state=function(){},e.dump_state=function(){},e.dump_stack=function(){},e.dump_page_structures=function(){if(t.cr[4]&CR4_PAE){dbg_log("PAE enabled");for(var e=0;4>e;e++)t.read32s(t.cr[3]+8*e)}else dbg_log("PAE disabled")},e.dump_gdt_ldt=function(){},e.dump_idt=function(){},e.get_memory_dump=function(){},e.memory_hex_dump=function(){},e.used_memory_dump=function(){},e.debug_interrupt=function(){},e.dump_code=function(t,e,r){if(i)try{i[t].disasm(e,r).forEach((function(t){dbg_log(h(t.address>>>0)+": "+v86util.pads(t.bytes.map((t=>h(t,2).slice(-2))).join(" "),20)+" "+t.mnemonic+" "+t.op_str)})),dbg_log("")}catch(t){dbg_log("Could not disassemble: "+Array.from(e).map((t=>h(t,2))).join(" "))}else dbg_log("Warning: Missing capstone library, disassembly not available")},e.dump_wasm=function(t){dbg_log("Warning: Missing libwabt, wasm dump not available")}};let et=DataView.prototype,it={size:1,get:et.getUint8,set:et.setUint8},rt={size:2,get:et.getUint16,set:et.setUint16},st={size:4,get:et.getUint32,set:et.setUint32},nt=lt([{magic:st},{class:it},{data:it},{version0:it},{osabi:it},{abiversion:it},{pad0:{size:7,get:()=>-1}},{type:rt},{machine:rt},{version1:st},{entry:st},{phoff:st},{shoff:st},{flags:st},{ehsize:rt},{phentsize:rt},{phnum:rt},{shentsize:rt},{shnum:rt},{shstrndx:rt}]);console.assert(52===nt.reduce(((t,e)=>t+e.size),0));let at=lt([{type:st},{offset:st},{vaddr:st},{paddr:st},{filesz:st},{memsz:st},{flags:st},{align:st}]);console.assert(32===at.reduce(((t,e)=>t+e.size),0));let ot=lt([{name:st},{type:st},{flags:st},{addr:st},{offset:st},{size:st},{link:st},{info:st},{addralign:st},{entsize:st}]);function lt(t){return t.map((function(t){var e=Object.keys(t);return console.assert(1===e.length),t=t[e=e[0]],console.assert(0<t.size),{name:e,type:t,size:t.size,get:t.get,set:t.set}}))}function ut(t){this.message=t}console.assert(40===ot.reduce(((t,e)=>t+e.size),0)),X.prototype.mmap_read8=function(t){return this.memory_map_read8[t>>>17](t)},X.prototype.mmap_write8=function(t,e){this.memory_map_write8[t>>>17](t,e)},X.prototype.mmap_read16=function(t){var e=this.memory_map_read8[t>>>17];return e(t)|e(t+1|0)<<8},X.prototype.mmap_write16=function(t,e){var i=this.memory_map_write8[t>>>17];i(t,255&e),i(t+1|0,e>>8)},X.prototype.mmap_read32=function(t){return this.memory_map_read32[t>>>17](t)},X.prototype.mmap_write32=function(t,e){this.memory_map_write32[t>>>17](t,e)},X.prototype.mmap_write64=function(t,e,i){var r=this.memory_map_write32[t>>>17];r(t,e),r(t+4,i)},X.prototype.mmap_write128=function(t,e,i,r,s){var n=this.memory_map_write32[t>>>17];n(t,e),n(t+4,i),n(t+8,r),n(t+12,s)},X.prototype.write_blob=function(t,e){t.length&&(this.in_mapped_range(e),this.in_mapped_range(e+t.length-1),this.jit_dirty_cache(e,e+t.length),this.mem8.set(t,e))},X.prototype.read_blob=function(t,e){return e&&(this.in_mapped_range(t),this.in_mapped_range(t+e-1)),this.mem8.subarray(t,t+e)},ut.prototype=Error();let ht={Uint8Array:Uint8Array,Int8Array:Int8Array,Uint16Array:Uint16Array,Int16Array:Int16Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Float32Array:Float32Array,Float64Array:Float64Array};function ct(t,e){if("object"!=typeof t||null===t)return dbg_assert("function"!=typeof t),t;if(t instanceof Array)return t.map((t=>ct(t,e)));if(t.constructor===Object&&(console.log(t),dbg_assert(t.constructor!==Object,"Expected non-object")),t.BYTES_PER_ELEMENT){var i=new Uint8Array(t.buffer,t.byteOffset,t.length*t.BYTES_PER_ELEMENT);return t=t.constructor.name.replace("bound ",""),dbg_assert(ht[t]),{__state_type__:t,buffer_id:e.push(i)-1}}i=t.get_state(),t=[];for(var r=0;r<i.length;r++){var s=i[r];dbg_assert("function"!=typeof s),t[r]=ct(s,e)}return t}function dt(t,e){if("object"!=typeof t||null===t)return dbg_assert("function"!=typeof t),t;if(t instanceof Array){for(var i=0;i<t.length;i++)t[i]=dt(t[i],e);return t}i=t.__state_type__,dbg_assert(void 0!==i);let r=ht[i];return dbg_assert(r,"Unkown type: "+i),new r(e[t.buffer_id])}function _t(t,e){for(var i of(t.io,this.cpu=t,this.pci=t.devices.pci,this.device_id=e.device_id,this.pci_space=[244,26,255&e.device_id,e.device_id>>8,7,5,16,0,1,0,2,0,0,0,0,0,1,168,0,0,0,16,191,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,244,26,255&e.subsystem_device_id,e.subsystem_device_id>>8,0,0,0,0,64,0,0,0,0,0,0,0,0,1,0,0],this.pci_space=this.pci_space.concat(v86util.zeros(256-this.pci_space.length)),this.pci_id=e.pci_id,this.pci_bars=[],this.name=e.name,this.driver_feature_select=this.device_feature_select=0,this.device_feature=new Uint32Array(4),this.driver_feature=new Uint32Array(4),e.common.features))dbg_assert(0<=i,"VirtIO device<"+this.name+"> feature bit numbers must be non-negative"),dbg_assert(128>i,"VirtIO device<"+this.name+"> feature bit numbers assumed less than 128 in implementation"),this.device_feature[i>>>5]|=1<<(31&i),this.driver_feature[i>>>5]|=1<<(31&i);for(var r of(dbg_assert(e.common.features.includes(32),"VirtIO device<"+this.name+"> only non-transitional devices are supported"),this.features_ok=!0,this.device_status=0,this.config_has_changed=!1,this.config_generation=0,this.queues=[],e.common.queues))this.queues.push(new pt(t,this,r));if(this.queue_select=0,this.queue_selected=this.queues[0],this.isr_status=0,DEBUG){for(var s of(i=new Set,this.queues.map((t=>t.notify_offset))))r=e.notification.single_handler?0:s,i.add(r),dbg_assert(e.notification.handlers[r],"VirtIO device<"+this.name+"> every queue's notifier must exist");for(let[t,r]of e.notification.handlers.entries())dbg_assert(!r||i.has(t),"VirtIO device<"+this.name+"> no defined notify handler should be unused")}(s=[]).push(this.create_common_capability(e.common)),s.push(this.create_notification_capability(e.notification)),s.push(this.create_isr_capability(e.isr_status)),e.device_specific&&s.push(this.create_device_specific_capability(e.device_specific)),this.init_capabilities(s),t.devices.pci.register_device(this),this.reset()}function pt(t,e,i){this.cpu=t,this.virtio=e,this.size_supported=this.size=i.size_supported,this.mask=this.size-1,this.enabled=!1,this.notify_offset=i.notify_offset,this.num_staged_replies=this.used_addr=this.avail_last_idx=this.avail_addr=this.desc_addr=0,this.reset()}function ft(t,e){this.cpu=t.cpu,this.virtio=t.virtio,this.head_idx=e,this.read_buffers=[],this.length_readable=this.read_buffer_offset=this.read_buffer_idx=0,this.write_buffers=[],this.length_writable=this.length_written=this.write_buffer_offset=this.write_buffer_idx=0;let i=t.desc_addr,r=0,s=t.size,n=!1,a=this.virtio.is_feature_negotiated(28);for(dbg_log("<<< Descriptor chain start",LOG_VIRTIO);;){let o=t.get_descriptor(i,e);if(dbg_log("descriptor: idx="+e+" addr="+h(o.addr_high,8)+":"+h(o.addr_low,8)+" len="+h(o.len,8)+" flags="+h(o.flags,4)+" next="+h(o.next,4),LOG_VIRTIO),a&&4&o.flags)DEBUG&&1&o.flags&&dbg_log("Driver bug: has set VIRTQ_DESC_F_NEXT flag in an indirect table descriptor",LOG_VIRTIO),i=o.addr_low,r=e=0,s=o.len/16,dbg_log("start indirect",LOG_VIRTIO);else{if(2&o.flags)n=!0,this.write_buffers.push(o),this.length_writable+=o.len;else{if(n){dbg_log("Driver bug: readonly buffer after writeonly buffer within chain",LOG_VIRTIO);break}this.read_buffers.push(o),this.length_readable+=o.len}if(r++,r>s){dbg_log("Driver bug: descriptor chain cycle detected",LOG_VIRTIO);break}if(!(1&o.flags))break;e=o.next}}dbg_log("Descriptor chain end >>>",LOG_VIRTIO)}function mt(t,e){this.bus=e,this.socket=void 0,this.send_queue=[],this.url=t,this.reconnect_interval=1e4,this.last_connect_attempt=Date.now()-this.reconnect_interval,this.send_queue_limit=64,this.bus.register("net0-send",(function(t){this.send(t)}),this)}function gt(t){function e(t){return!t.altKey&&o[56]&&n(56,!1),s(t,!1)}function i(t){return!t.altKey&&o[56]&&n(56,!1),s(t,!0)}function r(){for(var t,e=Object.keys(o),i=0;i<e.length;i++)t=+e[i],o[t]&&n(t,!1);o={}}function s(t,e){var i;if((i=l.bus)&&(i=!(t.shiftKey&&t.ctrlKey&&(73===t.keyCode||74===t.keyCode||75===t.keyCode)||!l.emu_enabled)&&(!t.target||t.target.classList.contains("phone_keyboard")||"INPUT"!==t.target.nodeName&&"TEXTAREA"!==t.target.nodeName)),i){if(void 0!==t.code&&void 0!==(i=d[t.code])||(i=u[t.keyCode]),i)return n(i,e,t.repeat),t.preventDefault&&t.preventDefault(),!1;console.log("Missing char in map: keyCode="+(t.keyCode||-1).toString(16)+" code="+t.code)}}function n(t,e,i){if(e)o[t]&&!i&&n(t,!1);else if(!o[t])return;(o[t]=e)||(t|=128),255<t?(a(t>>8),a(255&t)):a(t)}function a(t){l.bus.send("keyboard-code",t)}var o={},l=this;this.emu_enabled=!0;var u=new Uint16Array([0,0,0,0,0,0,0,0,14,15,0,0,0,28,0,0,42,29,56,0,58,0,0,0,0,0,0,1,0,0,0,0,57,57417,57425,57423,57415,57419,57416,57421,80,0,0,0,0,82,83,0,11,2,3,4,5,6,7,8,9,10,0,39,0,13,0,0,0,30,48,46,32,18,33,34,35,23,36,37,38,50,49,24,25,16,19,31,20,22,47,17,45,21,44,57435,57436,57437,0,0,82,79,80,81,75,76,77,71,72,73,0,0,0,0,0,0,59,60,61,62,63,64,65,66,67,68,87,88,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,69,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,39,13,51,12,52,53,41,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,26,43,27,40,0,57435,57400,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),h={8:8,10:13,32:32,39:222,44:188,45:189,46:190,47:191,48:48,49:49,50:50,51:51,52:52,53:53,54:54,55:55,56:56,57:57,59:186,61:187,91:219,92:220,93:221,96:192,97:65,98:66,99:67,100:68,101:69,102:70,103:71,104:72,105:73,106:74,107:75,108:76,109:77,110:78,111:79,112:80,113:81,114:82,115:83,116:84,117:85,118:86,119:87,120:88,121:89,122:90},c={33:49,34:222,35:51,36:52,37:53,38:55,40:57,41:48,42:56,43:187,58:186,60:188,62:190,63:191,64:50,65:65,66:66,67:67,68:68,69:69,70:70,71:71,72:72,73:73,74:74,75:75,76:76,77:77,78:78,79:79,80:80,81:81,82:82,83:83,84:84,85:85,86:86,87:87,88:88,89:89,90:90,94:54,95:189,123:219,124:220,125:221,126:192},d={Escape:1,Digit1:2,Digit2:3,Digit3:4,Digit4:5,Digit5:6,Digit6:7,Digit7:8,Digit8:9,Digit9:10,Digit0:11,Minus:12,Equal:13,Backspace:14,Tab:15,KeyQ:16,KeyW:17,KeyE:18,KeyR:19,KeyT:20,KeyY:21,KeyU:22,KeyI:23,KeyO:24,KeyP:25,BracketLeft:26,BracketRight:27,Enter:28,ControlLeft:29,KeyA:30,KeyS:31,KeyD:32,KeyF:33,KeyG:34,KeyH:35,KeyJ:36,KeyK:37,KeyL:38,Semicolon:39,Quote:40,Backquote:41,ShiftLeft:42,Backslash:43,KeyZ:44,KeyX:45,KeyC:46,KeyV:47,KeyB:48,KeyN:49,KeyM:50,Comma:51,Period:52,Slash:53,ShiftRight:54,NumpadMultiply:55,AltLeft:56,Space:57,CapsLock:58,F1:59,F2:60,F3:61,F4:62,F5:63,F6:64,F7:65,F8:66,F9:67,F10:68,NumLock:69,ScrollLock:70,Numpad7:71,Numpad8:72,Numpad9:73,NumpadSubtract:74,Numpad4:75,Numpad5:76,Numpad6:77,NumpadAdd:78,Numpad1:79,Numpad2:80,Numpad3:81,Numpad0:82,NumpadDecimal:83,IntlBackslash:86,F11:87,F12:88,NumpadEnter:57372,ControlRight:57373,NumpadDivide:57397,AltRight:57400,Home:57415,ArrowUp:57416,PageUp:57417,ArrowLeft:57419,ArrowRight:57421,End:57423,ArrowDown:57424,PageDown:57425,Insert:57426,Delete:57427,OSLeft:57435,OSRight:57436,ContextMenu:57437};this.bus=t,this.destroy=function(){"undefined"!=typeof window&&(window.removeEventListener("keyup",e,!1),window.removeEventListener("keydown",i,!1),window.removeEventListener("blur",r,!1))},this.init=function(){"undefined"!=typeof window&&(this.destroy(),window.addEventListener("keyup",e,!1),window.addEventListener("keydown",i,!1),window.addEventListener("blur",r,!1))},this.init(),this.simulate_press=function(t){s(t={keyCode:t},!0),s(t,!1)},this.simulate_char=function(t){var e=t.charCodeAt(0);e in h?this.simulate_press(h[e]):e in c?(a(42),this.simulate_press(c[e]),a(170)):console.log("ascii -> keyCode not found: ",e,t)}}function yt(t,e){function i(t){if(!f.enabled||!f.emu_enabled)return!1;var i,r=e||document.body;if(!(i=document.pointerLockElement))t:{for(t=t.target;t.parentNode;){if(t===r){i=!0;break t}t=t.parentNode}i=!1}return i}function r(t){i(t)&&(t=t.changedTouches)&&t.length&&(t=t[t.length-1],_=t.clientX,p=t.clientY)}function s(){(h||d||c)&&(f.bus.send("mouse-click",[!1,!1,!1]),h=d=c=!1)}function n(t){if(f.bus&&i(t)&&f.is_running){var r=0,s=0,n=t.changedTouches;n?n.length&&(r=(n=n[n.length-1]).clientX-_,s=n.clientY-p,_=n.clientX,p=n.clientY,t.preventDefault()):"number"==typeof t.movementX?(r=t.movementX,s=t.movementY):"number"==typeof t.webkitMovementX?(r=t.webkitMovementX,s=t.webkitMovementY):"number"==typeof t.mozMovementX?(r=t.mozMovementX,s=t.mozMovementY):(r=t.clientX-_,s=t.clientY-p,_=t.clientX,p=t.clientY),f.bus.send("mouse-delta",[.15*r,-.15*s]),e&&f.bus.send("mouse-absolute",[t.pageX-e.offsetLeft,t.pageY-e.offsetTop,e.offsetWidth,e.offsetHeight])}}function a(t){i(t)&&l(t,!0)}function o(t){i(t)&&l(t,!1)}function l(t,e){f.bus&&(1===t.which?h=e:2===t.which?d=e:3===t.which?c=e:dbg_log("Unknown event.which: "+t.which),f.bus.send("mouse-click",[h,d,c]),t.preventDefault())}function u(t){if(i(t)){var e=t.wheelDelta||-t.detail;0>e?e=-1:0<e&&(e=1),f.bus.send("mouse-wheel",[e,0]),t.preventDefault()}}var h=!1,c=!1,d=!1,_=0,p=0,f=this;this.enabled=!1,this.emu_enabled=!0,this.bus=t,this.bus.register("mouse-enable",(function(t){this.enabled=t}),this),this.is_running=!1,this.bus.register("emulator-stopped",(function(){this.is_running=!1}),this),this.bus.register("emulator-started",(function(){this.is_running=!0}),this),this.destroy=function(){"undefined"!=typeof window&&(window.removeEventListener("touchstart",r,!1),window.removeEventListener("touchend",s,!1),window.removeEventListener("touchmove",n,!1),window.removeEventListener("mousemove",n,!1),window.removeEventListener("mousedown",a,!1),window.removeEventListener("mouseup",o,!1),window.removeEventListener("wheel",u,{passive:!1}))},this.init=function(){"undefined"!=typeof window&&(this.destroy(),window.addEventListener("touchstart",r,!1),window.addEventListener("touchend",s,!1),window.addEventListener("touchmove",n,!1),window.addEventListener("mousemove",n,!1),window.addEventListener("mousedown",a,!1),window.addEventListener("mouseup",o,!1),window.addEventListener("wheel",u,{passive:!1}))},this.init()}function bt(t,e){function i(t){return t=t.toString(16),"#"+"0".repeat(6-t.length)+t}function r(t,e,i,r){t.style.width="",t.style.height="",r&&(t.style.transform="");var s=t.getBoundingClientRect();r?t.style.transform=(1===e?"":" scaleX("+e+")")+(1===i?"":" scaleY("+i+")"):(0==e%1&&0==i%1?(h.style.imageRendering="crisp-edges",h.style.imageRendering="pixelated",h.style["-ms-interpolation-mode"]="nearest-neighbor"):(h.style.imageRendering="",h.style["-ms-interpolation-mode"]=""),0!=(r=window.devicePixelRatio||1)%1&&(e/=r,i/=r)),1!==e&&(t.style.width=s.width*e+"px"),1!==i&&(t.style.height=s.height*i+"px")}console.assert(t,"1st argument must be a DOM container");var s,n,a,o,l,u,h=t.getElementsByTagName("canvas")[0],c=h.getContext("2d",{alpha:!1}),d=t.getElementsByTagName("div")[0],_=document.createElement("div"),p=1,f=1,m=1,g=!1,y=!1,b=this;t=new Uint16Array([199,252,233,226,228,224,229,231,234,235,232,239,238,236,196,197,201,230,198,244,246,242,251,249,255,214,220,162,163,165,8359,402,225,237,243,250,241,209,170,186,191,8976,172,189,188,161,171,187,9617,9618,9619,9474,9508,9569,9570,9558,9557,9571,9553,9559,9565,9564,9563,9488,9492,9524,9516,9500,9472,9532,9566,9567,9562,9556,9577,9574,9568,9552,9580,9575,9576,9572,9573,9561,9560,9554,9555,9579,9578,9496,9484,9608,9604,9612,9616,9600,945,223,915,960,931,963,181,964,934,920,937,948,8734,966,949,8745,8801,177,8805,8804,8992,8993,247,8776,176,8729,183,8730,8319,178,9632,160]);for(var v,w=new Uint16Array([32,9786,9787,9829,9830,9827,9824,8226,9688,9675,9689,9794,9792,9834,9835,9788,9658,9668,8597,8252,182,167,9644,8616,8593,8595,8594,8592,8735,8596,9650,9660]),k=[],x=0;256>x;x++)v=127<x?t[x-128]:32>x?w[x]:x,k[x]=String.fromCharCode(v);c.imageSmoothingEnabled=!1,_.style.position="absolute",_.style.backgroundColor="#ccc",_.style.width="7px",_.style.display="inline-block",d.style.display="block",h.style.display="none",this.bus=e,e.register("screen-set-mode",(function(t){this.set_mode(t)}),this),e.register("screen-fill-buffer-end",(function(t){this.update_buffer(t)}),this),e.register("screen-put-char",(function(t){this.put_char(t[0],t[1],t[2],t[3],t[4])}),this),e.register("screen-update-cursor",(function(t){this.update_cursor(t[0],t[1])}),this),e.register("screen-update-cursor-scanline",(function(t){this.update_cursor_scanline(t[0],t[1])}),this),e.register("screen-clear",(function(){this.clear_screen()}),this),e.register("screen-set-size-text",(function(t){this.set_size_text(t[0],t[1])}),this),e.register("screen-set-size-graphical",(function(t){this.set_size_graphical(t[0],t[1],t[2],t[3])}),this),this.init=function(){this.set_size_text(80,25),this.timer()},this.make_screenshot=function(){let t=new Image;if(g)t.src=h.toDataURL("image/png");else{let e=[9,16],r=document.createElement("canvas");r.width=l*e[0],r.height=u*e[1];let a=r.getContext("2d");a.imageSmoothingEnabled=!1,a.font=window.getComputedStyle(d).font,a.textBaseline="top";for(let t=0;t<l;t++)for(let r=0;r<u;r++){let s=3*(r*l+t);a.fillStyle=i(o[s+1]),a.fillRect(t*e[0],r*e[1],e[0],e[1]),a.fillStyle=i(o[s+2]),a.fillText(k[o[s]],t*e[0],r*e[1])}"none"!==_.style.display&&(a.fillStyle=_.style.backgroundColor,a.fillRect(n*e[0],s*e[1]+parseInt(_.style.marginTop,10)-1,parseInt(_.style.width,10),parseInt(_.style.height,10))),t.src=r.toDataURL("image/png")}try{window.open("").document.write(t.outerHTML)}catch(t){}},this.put_char=function(t,e,i,r,s){t<u&&e<l&&(o[e=3*(t*l+e)]=i,o[e+1]=r,o[e+2]=s,a[t]=1)},this.timer=function(){y||requestAnimationFrame(g?S:C)};var C=function(){for(var t=0;t<u;t++)a[t]&&(b.text_update_row(t),a[t]=0);this.timer()}.bind(this),S=function(){this.bus.send("screen-fill-buffer"),this.timer()}.bind(this);this.destroy=function(){y=!0},this.set_mode=function(t){(g=t)?(d.style.display="none",h.style.display="block"):(d.style.display="block",h.style.display="none")},this.clear_screen=function(){c.fillStyle="#000",c.fillRect(0,0,h.width,h.height)},this.set_size_text=function(t,e){if(t!==l||e!==u){for(a=new Int8Array(e),o=new Int32Array(t*e*3),l=t,u=e;d.childNodes.length>e;)d.removeChild(d.firstChild);for(;d.childNodes.length<e;)d.appendChild(document.createElement("div"));for(t=0;t<e;t++)this.text_update_row(t);r(d,p,f,!0)}},this.set_size_graphical=function(t,e){h.style.display="block",h.width=t,h.height=e,m=640>=t&&2*t<window.innerWidth&&2*t<window.innerHeight?2:1,r(h,p*m,f*m,!1)},this.set_scale=function(t,e){r(d,p=t,f=e,!0),r(h,p*m,f*m,!1)},this.set_scale(p,f),this.update_cursor_scanline=function(t,e){32&t?_.style.display="none":(_.style.display="inline",_.style.height=Math.min(15,e-t)+"px",_.style.marginTop=Math.min(15,t)+"px")},this.update_cursor=function(t,e){t===s&&e===n||(a[t]=1,a[s]=1,s=t,n=e)},this.text_update_row=function(t){for(var e,r=3*t*l,a=d.childNodes[t],u=document.createElement("div"),h=0;h<l;){var c=document.createElement("span"),p=o[r+1],f=o[r+2];for(c.style.backgroundColor=i(p),c.style.color=i(f),e="";h<l&&o[r+1]===p&&o[r+2]===f;)if(e+=k[o[r]],h++,r+=3,t===s){if(h===n)break;if(h===n+1){u.appendChild(_);break}}c.textContent=e,u.appendChild(c)}a.parentNode.replaceChild(u,a)},this.update_buffer=function(t){t.forEach((t=>{c.putImageData(t.image_data,t.screen_x-t.buffer_x,t.screen_y-t.buffer_y,t.buffer_x,t.buffer_y,t.buffer_width,t.buffer_height)}))},this.init()}function vt(t){var e,i,r;this.bus=t,t.register("screen-set-mode",(function(t){this.set_mode(t)}),this),t.register("screen-fill-buffer-end",(function(t){this.update_buffer(t[0],t[1])}),this),t.register("screen-put-char",(function(t){this.put_char(t[0],t[1],t[2],t[3],t[4])}),this),t.register("screen-text-scroll",(function(t){console.log("scroll",t)}),this),t.register("screen-update-cursor",(function(t){this.update_cursor(t[0],t[1])}),this),t.register("screen-update-cursor-scanline",(function(t){this.update_cursor_scanline(t[0],t[1])}),this),t.register("screen-set-size-text",(function(t){this.set_size_text(t[0],t[1])}),this),t.register("screen-set-size-graphical",(function(t){this.set_size_graphical(t[0],t[1])}),this),this.put_char=function(t,s,n,a,o){t<r&&s<i&&(e[t=3*(t*i+s)]=n,e[t+1]=a,e[t+2]=o)},this.destroy=function(){},this.set_mode=function(){},this.clear_screen=function(){},this.set_size_text=function(t,s){t===i&&s===r||(e=new Int32Array(t*s*3),i=t,r=s)},this.set_size_graphical=function(){},this.set_scale=function(){},this.update_cursor_scanline=function(){},this.update_cursor=function(){},this.update_buffer=function(){},this.get_text_screen=function(){for(var t=[],e=0;e<r;e++)t.push(this.get_text_row(e));return t},this.get_text_row=function(t){var r="";t=3*t*i;for(var s=0;s<i;s++)r+=String.fromCharCode(e[t+3*s]);return r}}function wt(t,e){function i(t){a.bus&&a.enabled&&(a.send_char(t.which),t.preventDefault())}function r(t){var e=t.which;8===e?(a.send_char(127),t.preventDefault()):9===e&&(a.send_char(9),t.preventDefault())}function s(t){if(a.enabled){for(var e=t.clipboardData.getData("text/plain"),i=0;i<e.length;i++)a.send_char(e.charCodeAt(i));t.preventDefault()}}function n(e){e.target!==t&&t.blur()}var a=this;this.enabled=!0,this.bus=e,this.text="",this.text_new_line=!1,this.last_update=0,this.bus.register("serial0-output-char",(function(t){this.show_char(t)}),this),this.destroy=function(){t.removeEventListener("keypress",i,!1),t.removeEventListener("keydown",r,!1),t.removeEventListener("paste",s,!1),window.removeEventListener("mousedown",n,!1)},this.init=function(){this.destroy(),t.style.display="block",t.addEventListener("keypress",i,!1),t.addEventListener("keydown",r,!1),t.addEventListener("paste",s,!1),window.addEventListener("mousedown",n,!1)},this.init(),this.show_char=function(t){"\b"===t?(this.text=this.text.slice(0,-1),this.update()):"\r"!==t&&(this.text+=t,"\n"===t&&(this.text_new_line=!0),this.update())},this.update=function(){var t=Date.now(),e=t-this.last_update;16>e?void 0===this.update_timer&&(this.update_timer=setTimeout((()=>{this.update_timer=void 0;var t=Date.now();dbg_assert(15<=t-this.last_update),this.last_update=t,this.render()}),16-e)):(void 0!==this.update_timer&&(clearTimeout(this.update_timer),this.update_timer=void 0),this.last_update=t,this.render())},this.render=function(){t.value=this.text,this.text_new_line&&(this.text_new_line=!1,t.scrollTop=1e9)},this.send_char=function(t){a.bus&&a.bus.send("serial0-input",t)}}function kt(t,e){if(this.element=t,window.Terminal){var i=this.term=new window.Terminal;i.setOption("logLevel","off"),i.write("This is the serial console. Whatever you type or paste here will be sent to COM1");var r=i.onData((function(t){for(let i=0;i<t.length;i++)e.send("serial0-input",t.charCodeAt(i))}));e.register("serial0-output-char",(function(t){i.write(t)}),this),this.destroy=function(){r.dispose(),i.dispose()}}}function xt(t){if("undefined"!=typeof window)if(window.AudioContext||window.webkitAudioContext){var e=window.AudioWorklet?Et:zt;this.bus=t,this.audio_context=window.AudioContext?new AudioContext:new webkitAudioContext,this.mixer=new Ct(t,this.audio_context),this.pcspeaker=new At(t,this.audio_context,this.mixer),this.dac=new e(t,this.audio_context,this.mixer),this.pcspeaker.start(),t.register("emulator-stopped",(function(){this.audio_context.suspend()}),this),t.register("emulator-started",(function(){this.audio_context.resume()}),this),t.register("speaker-confirm-initialized",(function(){t.send("speaker-has-initialized")}),this),t.send("speaker-has-initialized")}else console.warn("Web browser doesn't support Web Audio API")}function Ct(t,e){function i(t){return function(e){t.gain.setValueAtTime(e,this.audio_context.currentTime)}}this.audio_context=e,this.sources=new Map,this.gain_right=this.gain_left=this.volume_right=this.volume_left=this.volume_both=1,this.node_treble_left=this.audio_context.createBiquadFilter(),this.node_treble_right=this.audio_context.createBiquadFilter(),this.node_treble_left.type="highshelf",this.node_treble_right.type="highshelf",this.node_treble_left.frequency.setValueAtTime(2e3,this.audio_context.currentTime),this.node_treble_right.frequency.setValueAtTime(2e3,this.audio_context.currentTime),this.node_bass_left=this.audio_context.createBiquadFilter(),this.node_bass_right=this.audio_context.createBiquadFilter(),this.node_bass_left.type="lowshelf",this.node_bass_right.type="lowshelf",this.node_bass_left.frequency.setValueAtTime(200,this.audio_context.currentTime),this.node_bass_right.frequency.setValueAtTime(200,this.audio_context.currentTime),this.node_gain_left=this.audio_context.createGain(),this.node_gain_right=this.audio_context.createGain(),this.node_merger=this.audio_context.createChannelMerger(2),this.input_left=this.node_treble_left,this.input_right=this.node_treble_right,this.node_treble_left.connect(this.node_bass_left),this.node_bass_left.connect(this.node_gain_left),this.node_gain_left.connect(this.node_merger,0,0),this.node_treble_right.connect(this.node_bass_right),this.node_bass_right.connect(this.node_gain_right),this.node_gain_right.connect(this.node_merger,0,1),this.node_merger.connect(this.audio_context.destination),t.register("mixer-connect",(function(t){this.connect_source(t[0],t[1])}),this),t.register("mixer-disconnect",(function(t){this.disconnect_source(t[0],t[1])}),this),t.register("mixer-volume",(function(t){var e=t[0],i=t[1];t=Math.pow(10,t[2]/20),void 0!==(e=0===e?this:this.sources.get(e))&&e.set_volume(t,i)}),this),t.register("mixer-gain-left",(function(t){this.gain_left=Math.pow(10,t/20),this.update()}),this),t.register("mixer-gain-right",(function(t){this.gain_right=Math.pow(10,t/20),this.update()}),this),t.register("mixer-treble-left",i(this.node_treble_left),this),t.register("mixer-treble-right",i(this.node_treble_right),this),t.register("mixer-bass-left",i(this.node_bass_left),this),t.register("mixer-bass-right",i(this.node_bass_right),this)}function St(t,e,i,r){this.audio_context=t,this.connected_right=this.connected_left=!0,this.volume_right=this.volume_left=this.volume_both=this.gain_hidden=1,this.node_splitter=t.createChannelSplitter(2),this.node_gain_left=t.createGain(),this.node_gain_right=t.createGain(),e.connect(this.node_splitter),this.node_splitter.connect(this.node_gain_left,0),this.node_gain_left.connect(i),this.node_splitter.connect(this.node_gain_right,1),this.node_gain_right.connect(r)}function At(t,e,i){this.node_oscillator=e.createOscillator(),this.node_oscillator.type="square",this.node_oscillator.frequency.setValueAtTime(440,e.currentTime),this.mixer_connection=i.add_source(this.node_oscillator,1),this.mixer_connection.disconnect(),t.register("pcspeaker-enable",(function(){i.connect_source(1)}),this),t.register("pcspeaker-disable",(function(){i.disconnect_source(1)}),this),t.register("pcspeaker-update",(function(t){var i=t[1],r=0;3===t[0]&&(r=Math.min(1193181.6665999999/i,this.node_oscillator.frequency.maxValue),r=Math.max(r,0)),this.node_oscillator.frequency.setValueAtTime(r,e.currentTime)}),this)}function Et(t,e,i){this.bus=t,this.audio_context=e,this.enabled=!1,this.sampling_rate=48e3;var r=(e=function(){function t(t){return 0===t?1:(t*=Math.PI,Math.sin(t)/t)}function e(){var t=Reflect.construct(AudioWorkletProcessor,[],e);return t.kernel_size=3,t.queue_data=Array(1024),t.queue_start=0,t.queue_end=0,t.queue_length=0,t.queue_size=t.queue_data.length,t.queued_samples=0,t.source_buffer_previous=i,t.source_buffer_current=i,t.source_samples_per_destination=1,t.source_block_start=0,t.source_time=0,t.source_offset=0,t.port.onmessage=e=>{switch(e.data.type){case"queue":t.queue_push(e.data.value);break;case"sampling-rate":t.source_samples_per_destination=e.data.value/sampleRate}},t}var i=[new Float32Array(256),new Float32Array(256)];Reflect.setPrototypeOf(e.prototype,AudioWorkletProcessor.prototype),Reflect.setPrototypeOf(e,AudioWorkletProcessor),e.prototype.process=e.prototype.process=function(t,e){for(t=0;t<e[0][0].length;t++){for(var i=0,r=0,s=this.source_offset+this.kernel_size,n=this.source_offset-this.kernel_size+1;n<=s;n++){var a=this.source_block_start+n;i+=this.get_sample(a,0)*this.kernel(this.source_time-n),r+=this.get_sample(a,1)*this.kernel(this.source_time-n)}(isNaN(i)||isNaN(r))&&(i=r=0,this.dbg_log("ERROR: NaN values! Ignoring for now.")),e[0][0][t]=i,e[0][1][t]=r,this.source_time+=this.source_samples_per_destination,this.source_offset=Math.floor(this.source_time)}return e=this.source_offset,e+=this.kernel_size+2,this.source_time-=this.source_offset,this.source_block_start+=this.source_offset,this.source_offset=0,this.ensure_enough_data(e),!0},e.prototype.kernel=function(e){return t(e)*t(e/this.kernel_size)},e.prototype.get_sample=function(t,e){return 0>t?(t+=this.source_buffer_previous[0].length,this.source_buffer_previous[e][t]):this.source_buffer_current[e][t]},e.prototype.ensure_enough_data=function(t){var e=this.source_buffer_current[0].length;e-this.source_block_start<t&&(this.prepare_next_buffer(),this.source_block_start-=e)},e.prototype.prepare_next_buffer=function(){256>this.queued_samples&&this.queue_length&&this.dbg_log("Not enough samples - should not happen during midway of playback"),this.source_buffer_previous=this.source_buffer_current,this.source_buffer_current=this.queue_shift();var t=this.source_buffer_current[0].length;if(256>t){for(var e=this.queue_start,i=0;256>t&&i<this.queue_length;)t+=this.queue_data[e][0].length,e=e+1&this.queue_size-1,i++;t=Math.max(t,256),(t=[new Float32Array(t),new Float32Array(t)])[0].set(this.source_buffer_current[0]),t[1].set(this.source_buffer_current[1]),e=this.source_buffer_current[0].length;for(var r=0;r<i;r++){var s=this.queue_shift();t[0].set(s[0],e),t[1].set(s[1],e),e+=s[0].length}this.source_buffer_current=t}this.pump()},e.prototype.pump=function(){1024>this.queued_samples/this.source_samples_per_destination&&this.port.postMessage({type:"pump"})},e.prototype.queue_push=function(t){this.queue_length<this.queue_size&&(this.queue_data[this.queue_end]=t,this.queue_end=this.queue_end+1&this.queue_size-1,this.queue_length++,this.queued_samples+=t[0].length,this.pump())},e.prototype.queue_shift=function(){if(!this.queue_length)return i;var t=this.queue_data[this.queue_start];return this.queue_data[this.queue_start]=null,this.queue_start=this.queue_start+1&this.queue_size-1,this.queue_length--,this.queued_samples-=t[0].length,t},e.prototype.dbg_log=function(){},registerProcessor("dac-processor",e)}.toString()).indexOf("{")+1,s=e.lastIndexOf("}");e=e.substring(r,s),e=new Blob([e],{type:"application/javascript"});var n=URL.createObjectURL(e);this.node_processor=null,this.node_output=this.audio_context.createGain(),this.audio_context.audioWorklet.addModule(n).then((()=>{URL.revokeObjectURL(n),this.node_processor=new AudioWorkletNode(this.audio_context,"dac-processor",{numberOfInputs:0,numberOfOutputs:1,outputChannelCount:[2],parameterData:{},processorOptions:{}}),this.node_processor.port.postMessage({type:"sampling-rate",value:this.sampling_rate}),this.node_processor.port.onmessage=t=>{switch(t.data.type){case"pump":this.pump();break;case"debug-log":t.data.value}},this.node_processor.connect(this.node_output)})),this.mixer_connection=i.add_source(this.node_output,2),this.mixer_connection.set_gain_hidden(3),t.register("dac-send-data",(function(t){this.queue(t)}),this),t.register("dac-enable",(function(){this.enabled=!0}),this),t.register("dac-disable",(function(){this.enabled=!1}),this),t.register("dac-tell-sampling-rate",(function(t){this.sampling_rate=t,this.node_processor&&this.node_processor.port.postMessage({type:"sampling-rate",value:t})}),this)}function zt(t,e,i){this.bus=t,this.audio_context=e,this.enabled=!1,this.sampling_rate=22050,this.buffered_time=0,this.rate_ratio=1,this.node_lowpass=this.audio_context.createBiquadFilter(),this.node_lowpass.type="lowpass",this.node_output=this.node_lowpass,this.mixer_connection=i.add_source(this.node_output,2),this.mixer_connection.set_gain_hidden(3),t.register("dac-send-data",(function(t){this.queue(t)}),this),t.register("dac-enable",(function(){this.enabled=!0,this.pump()}),this),t.register("dac-disable",(function(){this.enabled=!1}),this),t.register("dac-tell-sampling-rate",(function(t){this.sampling_rate=t,this.rate_ratio=Math.ceil(8e3/t),this.node_lowpass.frequency.setValueAtTime(t/2,this.audio_context.currentTime)}),this)}function It(t){this.cpu_is_running=!1;var e,i,r=Z.create();this.bus=r[0],this.emulator_bus=r[1];let s=new WebAssembly.Table({element:"anyfunc",initial:1924});r={cpu_exception_hook:t=>this.cpu_exception_hook&&this.cpu_exception_hook(t),hlt_op:function(){return e.hlt_op()},abort:function(){},microtick:Y.microtick,get_rand_int:function(){return o.get_rand_int()},pic_acknowledge:function(){e.pic_acknowledge()},io_port_read8:function(t){return e.io.port_read8(t)},io_port_read16:function(t){return e.io.port_read16(t)},io_port_read32:function(t){return e.io.port_read32(t)},io_port_write8:function(t,i){e.io.port_write8(t,i)},io_port_write16:function(t,i){e.io.port_write16(t,i)},io_port_write32:function(t,i){e.io.port_write32(t,i)},mmap_read8:function(t){return e.mmap_read8(t)},mmap_read16:function(t){return e.mmap_read16(t)},mmap_read32:function(t){return e.mmap_read32(t)},mmap_write8:function(t,i){e.mmap_write8(t,i)},mmap_write16:function(t,i){e.mmap_write16(t,i)},mmap_write32:function(t,i){e.mmap_write32(t,i)},mmap_write64:function(t,i,r){e.mmap_write64(t,i,r)},mmap_write128:function(t,i,r,s,n){e.mmap_write128(t,i,r,s,n)},log_from_wasm:function(t,e){t=o.read_sized_string_from_mem(i,t,e),LOG_CPU},console_log_from_wasm:function(t,e){t=o.read_sized_string_from_mem(i,t,e),console.error(t)},dbg_trace_from_wasm:function(){},codegen_finalize:(t,i,r,s,n)=>{e.codegen_finalize(t,i,r,s,n)},jit_clear_func:t=>e.jit_clear_func(t),jit_clear_all_funcs:()=>e.jit_clear_all_funcs(),__indirect_function_table:s};let n=t.wasm_fn;n||(n=e=>new Promise((i=>{let r="v86.wasm",s="v86-fallback.wasm";if(t.wasm_path){r=t.wasm_path;let e=r.lastIndexOf("/");s=(-1===e?"":r.substr(0,e))+"/"+s}else"undefined"==typeof window?(r="//"+r,s="//"+s):(r="build/"+r,s="build/"+s);o.load_file(r,{done:async t=>{try{let{instance:r}=await WebAssembly.instantiate(t,e);i(r.exports)}catch(t){o.load_file(s,{done:async t=>{({instance:t}=await WebAssembly.instantiate(t,e)),i(t.exports)}})}},progress:t=>{this.emulator_bus.send("download-progress",{file_index:0,file_count:1,file_name:r,lengthComputable:t.lengthComputable,total:t.total,loaded:t.loaded})}})}))),n({env:r}).then((r=>{i=r.memory,r.rust_init(),r=this.v86=new Y(this.emulator_bus,{exports:r,wasm_table:s}),e=r.cpu,this.continue_init(r,t)}))}function Pt(t){this.message=t||"File already exists"}function qt(t){this.message=t||"File not found"}X.prototype.save_state=function(){for(var t=[],e=ct(this,t),i=[],r=0,s=0;s<t.length;s++){var n=t[s].byteLength;i[s]={offset:r,length:n},r=(r+=n)+3&-4}e=JSON.stringify({buffer_infos:i,state:e});var a=(s=(s=16+(e=(new TextEncoder).encode(e)).length)+3&-4)+r;r=new ArrayBuffer(a);var o=new Int32Array(r,0,4);for(new Uint8Array(r,16,e.length).set(e),n=new Uint8Array(r,s),o[0]=-2039052682,o[1]=6,o[2]=a,o[3]=e.length,s=0;s<t.length;s++)a=t[s],dbg_assert(a.constructor===Uint8Array),n.set(a,i[s].offset);return dbg_log("State: json size "+(e.byteLength>>10)+"k"),dbg_log("State: Total buffers size "+(n.byteLength>>10)+"k"),r},X.prototype.restore_state=function(t){function e(t,e){let i=t.length;if(16>i)throw new ut("Invalid length: "+i);if(-2039052682!==(t=new Int32Array(t.buffer,t.byteOffset,4))[0])throw new ut("Invalid header: "+h(t[0]>>>0));if(6!==t[1])throw new ut("Version mismatch: dump="+t[1]+" we=6");if(e&&t[2]!==i)throw new ut("Length doesn't match header: real="+i+" header="+t[2]);return t[3]}function i(t){return t=(new TextDecoder).decode(t),JSON.parse(t)}if(t=new Uint8Array(t),4247762216===new Uint32Array(t.buffer,0,1)[0]){var r=this.zstd_create_ctx(t.length);new Uint8Array(this.wasm_memory.buffer,this.zstd_get_src_ptr(r),t.length).set(t);var s=this.zstd_read(r,16),n=new Uint8Array(this.wasm_memory.buffer,s,16),a=e(n,!1);this.zstd_read_free(s,16),s=this.zstd_read(r,a),n=i(n=new Uint8Array(this.wasm_memory.buffer,s,a)),this.zstd_read_free(s,a),s=n.state;var o=n.buffer_infos;for(var l of(n=[],a=16+a,o)){if(o=(a+3&-4)-a,1048576<l.length){var u=this.zstd_read(r,o);this.zstd_read_free(u,o),u=new Uint8Array(l.length),n.push(u.buffer);for(var c=0;c<l.length;){var d=l.length-c;dbg_assert(0<=d),d=Math.min(d,1048576);let t=this.zstd_read(r,d);u.set(new Uint8Array(this.wasm_memory.buffer,t,d),c),this.zstd_read_free(t,d),c+=d}}else c=(u=this.zstd_read(r,o+l.length))+o,n.push(this.wasm_memory.buffer.slice(c,c+l.length)),this.zstd_read_free(u,o+l.length);a+=o+l.length}s=dt(s,n),this.set_state(s),this.zstd_free_ctx(r)}else{if(0>(r=e(t,!0))||r+12>=t.length)throw new ut("Invalid info block length: "+r);l=(s=i(l=t.subarray(16,16+r))).state,s=s.buffer_infos;let n=16+r;n=n+3&-4,l=dt(l,r=s.map((e=>{const i=n+e.offset;return t.buffer.slice(i,i+e.length)}))),this.set_state(l)}},_t.prototype.create_common_capability=function(t){return{type:1,bar:0,port:t.initial_port,use_mmio:!1,offset:0,extra:new Uint8Array(0),struct:[{bytes:4,name:"device_feature_select",read:()=>this.device_feature_select,write:t=>{this.device_feature_select=t}},{bytes:4,name:"device_feature",read:()=>this.device_feature[this.device_feature_select]||0,write:()=>{}},{bytes:4,name:"driver_feature_select",read:()=>this.driver_feature_select,write:t=>{this.driver_feature_select=t}},{bytes:4,name:"driver_feature",read:()=>this.driver_feature[this.driver_feature_select]||0,write:t=>{let e=this.device_feature[this.driver_feature_select];this.driver_feature_select<this.driver_feature.length&&(this.driver_feature[this.driver_feature_select]=t&e),this.features_ok=this.features_ok&&!(t&~e)}},{bytes:2,name:"msix_config",read:()=>(dbg_log("No msi-x capability supported.",LOG_VIRTIO),65535),write:()=>{dbg_log("No msi-x capability supported.",LOG_VIRTIO)}},{bytes:2,name:"num_queues",read:()=>this.queues.length,write:()=>{}},{bytes:1,name:"device_status",read:()=>this.device_status,write:e=>{0===e?(dbg_log("Reset device<"+this.name+">",LOG_VIRTIO),this.reset()):128&e?dbg_log("Warning: Device<"+this.name+"> status failed",LOG_VIRTIO):dbg_log("Device<"+this.name+"> status: "+(1&e?"ACKNOWLEDGE ":"")+(2&e?"DRIVER ":"")+(4&e?"DRIVER_OK":"")+(8&e?"FEATURES_OK ":"")+(64&e?"DEVICE_NEEDS_RESET":""),LOG_VIRTIO),e&~this.device_status&4&&64&this.device_status&&this.notify_config_changes(),this.features_ok||(DEBUG&&8&e&&dbg_log("Removing FEATURES_OK",LOG_VIRTIO),e&=-9),this.device_status=e,e&~this.device_status&4&&t.on_driver_ok()}},{bytes:1,name:"config_generation",read:()=>this.config_generation,write:()=>{}},{bytes:2,name:"queue_select",read:()=>this.queue_select,write:t=>{this.queue_select=t,this.queue_select<this.queues.length?this.queues_selected=this.queues[this.queue_select]:this.queue_selected=null}},{bytes:2,name:"queue_size",read:()=>this.queue_selected?this.queue_selected.size:0,write:t=>{this.queue_selected&&(t&t-1&&(dbg_log("Warning: dev<"+this.name+"> Given queue size was not a power of 2. Rounding up to next power of 2.",LOG_VIRTIO),t=1<<v86util.int_log2(t-1)+1),t>this.queue_selected.size_supported&&(dbg_log("Warning: dev<"+this.name+"> Trying to set queue size greater than supported. Clamping to supported size.",LOG_VIRTIO),t=this.queue_selected.size_supported),this.queue_selected.set_size(t))}},{bytes:2,name:"queue_msix_vector",read:()=>(dbg_log("No msi-x capability supported.",LOG_VIRTIO),65535),write:()=>{dbg_log("No msi-x capability supported.",LOG_VIRTIO)}},{bytes:2,name:"queue_enable",read:()=>this.queue_selected?0|this.queue_selected.enabled:0,write:t=>{this.queue_selected&&(1===t?this.queue_selected.is_configured()?this.queue_selected.enable():dbg_log("Driver bug: tried enabling unconfigured queue",LOG_VIRTIO):0===t&&dbg_log("Driver bug: tried writing 0 to queue_enable",LOG_VIRTIO))}},{bytes:2,name:"queue_notify_off",read:()=>this.queue_selected?this.queue_selected.notify_offset:0,write:()=>{}},{bytes:4,name:"queue_desc (low dword)",read:()=>this.queue_selected?this.queue_selected.desc_addr:0,write:t=>{this.queue_selected&&(this.queue_selected.desc_addr=t)}},{bytes:4,name:"queue_desc (high dword)",read:()=>0,write:()=>{dbg_log("Warning: High dword of 64 bit queue_desc ignored",LOG_VIRTIO)}},{bytes:4,name:"queue_avail (low dword)",read:()=>this.queue_selected?this.queue_selected.avail_addr:0,write:t=>{this.queue_selected&&(this.queue_selected.avail_addr=t)}},{bytes:4,name:"queue_avail (high dword)",read:()=>0,write:()=>{dbg_log("Warning: High dword of 64 bit queue_avail ignored",LOG_VIRTIO)}},{bytes:4,name:"queue_used (low dword)",read:()=>this.queue_selected?this.queue_selected.used_addr:0,write:t=>{this.queue_selected&&(this.queue_selected.used_addr=t)}},{bytes:4,name:"queue_used (high dword)",read:()=>0,write:()=>{dbg_log("Warning: High dword of 64 bit queue_used ignored",LOG_VIRTIO)}}]}},_t.prototype.create_notification_capability=function(t){let e,i=[];t.single_handler?(dbg_assert(1===t.handlers.length,"VirtIO device<"+this.name+"> too many notify handlers specified: expected single handler"),e=0):e=2;for(let[r,s]of t.handlers.entries())i.push({bytes:2,name:"notify"+r,read:()=>65535,write:s||(()=>{})});return{type:2,bar:1,port:t.initial_port,use_mmio:!1,offset:0,extra:new Uint8Array([255&e,e>>8&255,e>>16&255,e>>24]),struct:i}},_t.prototype.create_isr_capability=function(t){return{type:3,bar:2,port:t.initial_port,use_mmio:!1,offset:0,extra:new Uint8Array(0),struct:[{bytes:1,name:"isr_status",read:()=>{let t=this.isr_status;return this.lower_irq(),t},write:()=>{}}]}},_t.prototype.create_device_specific_capability=function(t){return dbg_assert(3&~t.offset,"VirtIO device<"+this.name+"> device specific cap offset must be 4-byte aligned"),{type:4,bar:3,port:t.initial_port,use_mmio:!1,offset:0,extra:new Uint8Array(0),struct:t.struct}},_t.prototype.init_capabilities=function(t){let e=this.pci_space[52]=64;var i=e;for(let s of t){e=(i=e)+(t=16+s.extra.length),dbg_assert(256>=e,"VirtIO device<"+this.name+"> can't fit all capabilities into 256byte configspace"),dbg_assert(0<=s.bar&&6>s.bar,"VirtIO device<"+this.name+"> capability invalid bar number");var r=s.struct.reduce(((t,e)=>t+e.bytes),0);r=16>(r+=s.offset)?16:1<<v86util.int_log2(r-1)+1,dbg_assert(0==(s.port&r-1),"VirtIO device<"+this.name+"> capability port should be aligned to pci bar size"),this.pci_bars[s.bar]={size:r},this.pci_space[i]=9,this.pci_space[i+1]=e,this.pci_space[i+2]=t,this.pci_space[i+3]=s.type,this.pci_space[i+4]=s.bar,this.pci_space[i+5]=0,this.pci_space[i+6]=0,this.pci_space[i+7]=0,this.pci_space[i+8]=255&s.offset,this.pci_space[i+9]=s.offset>>>8&255,this.pci_space[i+10]=s.offset>>>16&255,this.pci_space[i+11]=s.offset>>>24,this.pci_space[i+12]=255&r,this.pci_space[i+13]=r>>>8&255,this.pci_space[i+14]=r>>>16&255,this.pci_space[i+15]=r>>>24;for(let[t,e]of s.extra.entries())this.pci_space[i+16+t]=e;i=16+4*s.bar,this.pci_space[i]=254&s.port|!s.use_mmio,this.pci_space[i+1]=s.port>>>8&255,this.pci_space[i+2]=s.port>>>16&255,this.pci_space[i+3]=s.port>>>24&255,i=s.port+s.offset;for(let e of s.struct){let n=e.read;if(t=e.write,DEBUG&&(n=()=>{let t=e.read();return dbg_log("Device<"+this.name+"> cap["+s.type+"] read["+e.name+"] => "+h(t,8*e.bytes),LOG_VIRTIO),t},t=t=>{dbg_log("Device<"+this.name+"> cap["+s.type+"] write["+e.name+"] <= "+h(t,8*e.bytes),LOG_VIRTIO),e.write(t)}),s.use_mmio)dbg_assert(!1,"VirtIO device <"+this.name+"> mmio capability not implemented.");else{r=function(t){return dbg_log("Warning: 8-bit read from 16-bit virtio port",LOG_VIRTIO),n(-2&t)>>((1&t)<<3)&255};let s=function(t){return dbg_log("Warning: 8-bit read from 32-bit virtio port",LOG_VIRTIO),n(-4&t)>>((3&t)<<3)&255};switch(e.bytes){case 4:this.cpu.io.register_read(i,this,s,void 0,n),this.cpu.io.register_write(i,this,void 0,void 0,t);break;case 2:this.cpu.io.register_read(i,this,r,n),this.cpu.io.register_write(i,this,void 0,t);break;case 1:this.cpu.io.register_read(i,this,n),this.cpu.io.register_write(i,this,t);break;default:dbg_assert(!1,"VirtIO device <"+this.name+"> invalid capability field width of "+e.bytes+" bytes")}}i+=e.bytes}}dbg_assert(256>=e+20,"VirtIO device<"+this.name+"> can't fit all capabilities into 256byte configspace"),this.pci_space[e]=9,this.pci_space[e+1]=0,this.pci_space[e+2]=20,this.pci_space[e+3]=5,this.pci_space[e+4]=0,this.pci_space[e+5]=0,this.pci_space[e+6]=0,this.pci_space[e+7]=0,this.pci_space[e+8]=0,this.pci_space[e+9]=0,this.pci_space[e+10]=0,this.pci_space[e+11]=0,this.pci_space[e+12]=0,this.pci_space[e+13]=0,this.pci_space[e+14]=0,this.pci_space[e+15]=0,this.pci_space[e+16]=0,this.pci_space[e+17]=0,this.pci_space[e+18]=0,this.pci_space[e+19]=0},_t.prototype.get_state=function(){let t=[];return t[0]=this.device_feature_select,t[1]=this.driver_feature_select,t[2]=this.device_feature,t[3]=this.driver_feature,t[4]=this.features_ok,t[5]=this.device_status,t[6]=this.config_has_changed,t[7]=this.config_generation,t[8]=this.isr_status,t[9]=this.queue_select,t.concat(this.queues)},_t.prototype.set_state=function(t){this.device_feature_select=t[0],this.driver_feature_select=t[1],this.device_feature=t[2],this.driver_feature=t[3],this.features_ok=t[4],this.device_status=t[5],this.config_has_changed=t[6],this.config_generation=t[7],this.isr_status=t[8],this.queue_select=t[9];let e=0;for(let i of t.slice(10))this.queues[e].set_state(i),e++;this.queue_selected=this.queues[this.queue_select]||null},_t.prototype.reset=function(){this.driver_feature_select=this.device_feature_select=0,this.driver_feature.set(this.device_feature),this.features_ok=!0,this.queue_select=this.device_status=0,this.queue_selected=this.queues[0];for(let t of this.queues)t.reset();this.config_has_changed=!1,this.config_generation=0,this.lower_irq()},_t.prototype.notify_config_changes=function(){this.config_has_changed=!0,4&this.device_status?this.raise_irq(2):dbg_assert(!1,"VirtIO device<"+this.name+"> attempted to notify driver before DRIVER_OK")},_t.prototype.update_config_generation=function(){this.config_has_changed&&(this.config_generation++,this.config_generation&=255,this.config_has_changed=!1)},_t.prototype.is_feature_negotiated=function(t){return 0<(this.driver_feature[t>>>5]&1<<(31&t))},_t.prototype.needs_reset=function(){dbg_log("Device<"+this.name+"> experienced error - requires reset",LOG_VIRTIO),this.device_status|=64,4&this.device_status&&this.notify_config_changes()},_t.prototype.raise_irq=function(t){dbg_log("Raise irq "+h(t),LOG_VIRTIO),this.isr_status|=t,this.pci.raise_irq(this.pci_id)},_t.prototype.lower_irq=function(){dbg_log("Lower irq ",LOG_VIRTIO),this.isr_status=0,this.pci.lower_irq(this.pci_id)},pt.prototype.get_state=function(){let t=[];return t[0]=this.size,t[1]=this.size_supported,t[2]=this.enabled,t[3]=this.notify_offset,t[4]=this.desc_addr,t[5]=this.avail_addr,t[6]=this.avail_last_idx,t[7]=this.used_addr,t[8]=this.num_staged_replies,t},pt.prototype.set_state=function(t){this.size=t[0],this.size_supported=t[1],this.enabled=t[2],this.notify_offset=t[3],this.desc_addr=t[4],this.avail_addr=t[5],this.avail_last_idx=t[6],this.used_addr=t[7],this.num_staged_replies=t[8],this.mask=this.size-1},pt.prototype.reset=function(){this.enabled=!1,this.num_staged_replies=this.used_addr=this.avail_last_idx=this.avail_addr=this.desc_addr=0,this.set_size(this.size_supported)},pt.prototype.is_configured=function(){return this.desc_addr&&this.avail_addr&&this.used_addr},pt.prototype.enable=function(){dbg_assert(this.is_configured(),"VirtQueue must be configured before enabled"),this.enabled=!0},pt.prototype.set_size=function(t){dbg_assert(0==(t&t-1),"VirtQueue size must be power of 2 or zero"),dbg_assert(t<=this.size_supported,"VirtQueue size must be within supported size"),this.size=t,this.mask=t-1},pt.prototype.count_requests=function(){return dbg_assert(this.avail_addr,"VirtQueue addresses must be configured before use"),this.avail_get_idx()-this.avail_last_idx&this.mask},pt.prototype.has_request=function(){return dbg_assert(this.avail_addr,"VirtQueue addresses must be configured before use"),(this.avail_get_idx()&this.mask)!==this.avail_last_idx},pt.prototype.pop_request=function(){dbg_assert(this.avail_addr,"VirtQueue addresses must be configured before use"),dbg_assert(this.has_request(),"VirtQueue must not pop nonexistent request");var t=this.avail_get_entry(this.avail_last_idx);return dbg_log("Pop request: avail_last_idx="+this.avail_last_idx+" desc_idx="+t,LOG_VIRTIO),t=new ft(this,t),this.avail_last_idx=this.avail_last_idx+1&this.mask,t},pt.prototype.push_reply=function(t){dbg_assert(this.used_addr,"VirtQueue addresses must be configured before use"),dbg_assert(this.num_staged_replies<this.size,"VirtQueue replies must not exceed queue size");let e=this.used_get_idx()+this.num_staged_replies&this.mask;dbg_log("Push reply: used_idx="+e+" desc_idx="+t.head_idx,LOG_VIRTIO),this.used_set_entry(e,t.head_idx,t.length_written),this.num_staged_replies++},pt.prototype.flush_replies=function(){if(dbg_assert(this.used_addr,"VirtQueue addresses must be configured before use"),0===this.num_staged_replies)dbg_log("flush_replies: Nothing to flush",LOG_VIRTIO);else{dbg_log("Flushing "+this.num_staged_replies+" replies",LOG_VIRTIO);var t=this.used_get_idx()+this.num_staged_replies&65535;this.used_set_idx(t),this.num_staged_replies=0,this.virtio.is_feature_negotiated(29)?(this.avail_get_used_event(),this.virtio.raise_irq(1)):1&~this.avail_get_flags()&&this.virtio.raise_irq(1)}},pt.prototype.notify_me_after=function(t){dbg_assert(0<=t,"Must skip a non-negative number of requests"),t=this.avail_get_idx()+t&65535,this.used_set_avail_event(t)},pt.prototype.get_descriptor=function(t,e){return{addr_low:this.cpu.read32s(t+16*e),addr_high:this.cpu.read32s(t+16*e+4),len:this.cpu.read32s(t+16*e+8),flags:this.cpu.read16(t+16*e+12),next:this.cpu.read16(t+16*e+14)}},pt.prototype.avail_get_flags=function(){return this.cpu.read16(this.avail_addr)},pt.prototype.avail_get_idx=function(){return this.cpu.read16(this.avail_addr+2)},pt.prototype.avail_get_entry=function(t){return this.cpu.read16(this.avail_addr+4+2*t)},pt.prototype.avail_get_used_event=function(){return this.cpu.read16(this.avail_addr+4+2*this.size)},pt.prototype.used_get_flags=function(){return this.cpu.read16(this.used_addr)},pt.prototype.used_set_flags=function(t){this.cpu.write16(this.used_addr,t)},pt.prototype.used_get_idx=function(){return this.cpu.read16(this.used_addr+2)},pt.prototype.used_set_idx=function(t){this.cpu.write16(this.used_addr+2,t)},pt.prototype.used_set_entry=function(t,e,i){this.cpu.write32(this.used_addr+4+8*t,e),this.cpu.write32(this.used_addr+8+8*t,i)},pt.prototype.used_set_avail_event=function(t){this.cpu.write16(this.used_addr+4+8*this.size,t)},ft.prototype.get_next_blob=function(t){let e=0,i=t.length;for(;i;){if(this.read_buffer_idx===this.read_buffers.length){dbg_log("Device<"+this.virtio.name+"> Read more than device-readable buffers has",LOG_VIRTIO);break}var r=this.read_buffers[this.read_buffer_idx];let s=r.addr_low+this.read_buffer_offset;(r=r.len-this.read_buffer_offset)>i?(r=i,this.read_buffer_offset+=i):(this.read_buffer_idx++,this.read_buffer_offset=0),t.set(this.cpu.read_blob(s,r),e),e+=r,i-=r}return e},ft.prototype.set_next_blob=function(t){let e=0,i=t.length;for(;i;){if(this.write_buffer_idx===this.write_buffers.length){dbg_log("Device<"+this.virtio.name+"> Write more than device-writable capacity",LOG_VIRTIO);break}var r=this.write_buffers[this.write_buffer_idx];let s=r.addr_low+this.write_buffer_offset;(r=r.len-this.write_buffer_offset)>i?(r=i,this.write_buffer_offset+=i):(this.write_buffer_idx++,this.write_buffer_offset=0),this.cpu.write_blob(t.subarray(e,e+r),s),e+=r,i-=r}return this.length_written+=e,e},mt.prototype.handle_message=function(t){this.bus&&this.bus.send("net0-receive",new Uint8Array(t.data))},mt.prototype.handle_close=function(){this.connect(),setTimeout(this.connect.bind(this),this.reconnect_interval)},mt.prototype.handle_open=function(){for(var t=0;t<this.send_queue.length;t++)this.send(this.send_queue[t]);this.send_queue=[]},mt.prototype.handle_error=function(){},mt.prototype.destroy=function(){this.socket&&this.socket.close()},mt.prototype.connect=function(){if("undefined"!=typeof WebSocket){if(this.socket){var t=this.socket.readyState;if(0===t||1===t)return}t=Date.now(),this.last_connect_attempt+this.reconnect_interval>t||(this.last_connect_attempt=Date.now(),this.socket=new WebSocket(this.url),this.socket.binaryType="arraybuffer",this.socket.onopen=this.handle_open.bind(this),this.socket.onmessage=this.handle_message.bind(this),this.socket.onclose=this.handle_close.bind(this),this.socket.onerror=this.handle_error.bind(this))}},mt.prototype.send=function(t){this.socket&&1===this.socket.readyState?this.socket.send(t):(this.send_queue.push(t),this.send_queue.length>2*this.send_queue_limit&&(this.send_queue=this.send_queue.slice(-this.send_queue_limit)),this.connect())},mt.prototype.change_proxy=function(t){this.url=t,this.socket&&(this.socket.onclose=function(){},this.socket.onerror=function(){},this.socket.close(),this.socket=void 0)},kt.prototype.show=function(){this.term&&this.term.open(this.element)},xt.prototype.destroy=function(){this.audio_context&&this.audio_context.close(),this.dac&&this.dac.node_processor&&this.dac.node_processor.port.close()},Ct.prototype.add_source=function(t,e){return t=new St(this.audio_context,t,this.input_left,this.input_right),this.sources.has(e),this.sources.set(e,t),t},Ct.prototype.connect_source=function(t,e){void 0!==(t=this.sources.get(t))&&t.connect(e)},Ct.prototype.disconnect_source=function(t,e){void 0!==(t=this.sources.get(t))&&t.disconnect(e)},Ct.prototype.set_volume=function(t,e){switch(void 0===e&&(e=2),e){case 0:this.volume_left=t;break;case 1:this.volume_right=t;break;case 2:this.volume_both=t;break;default:return}this.update()},Ct.prototype.update=function(){var t=this.volume_both*this.volume_right*this.gain_right;this.node_gain_left.gain.setValueAtTime(this.volume_both*this.volume_left*this.gain_left,this.audio_context.currentTime),this.node_gain_right.gain.setValueAtTime(t,this.audio_context.currentTime)},St.prototype.update=function(){var t=this.connected_right*this.gain_hidden*this.volume_both*this.volume_right;this.node_gain_left.gain.setValueAtTime(this.connected_left*this.gain_hidden*this.volume_both*this.volume_left,this.audio_context.currentTime),this.node_gain_right.gain.setValueAtTime(t,this.audio_context.currentTime)},St.prototype.connect=function(t){var e=!t||2===t;(e||0===t)&&(this.connected_left=!0),(e||1===t)&&(this.connected_right=!0),this.update()},St.prototype.disconnect=function(t){var e=!t||2===t;(e||0===t)&&(this.connected_left=!1),(e||1===t)&&(this.connected_right=!1),this.update()},St.prototype.set_volume=function(t,e){switch(void 0===e&&(e=2),e){case 0:this.volume_left=t;break;case 1:this.volume_right=t;break;case 2:this.volume_both=t;break;default:return}this.update()},St.prototype.set_gain_hidden=function(t){this.gain_hidden=t},At.prototype.start=function(){this.node_oscillator.start()},Et.prototype.queue=function(t){this.node_processor&&this.node_processor.port.postMessage({type:"queue",value:t},[t[0].buffer,t[1].buffer])},Et.prototype.pump=function(){this.enabled&&this.bus.send("dac-request-data")},zt.prototype.queue=function(t){var e=t[0].length,i=e/this.sampling_rate;if(1<this.rate_ratio)for(var r=this.audio_context.createBuffer(2,e*this.rate_ratio,this.sampling_rate*this.rate_ratio),s=r.getChannelData(0),n=r.getChannelData(1),a=0,o=0;o<e;o++)for(var l=0;l<this.rate_ratio;l++,a++)s[a]=t[0][o],n[a]=t[1][o];else(r=this.audio_context.createBuffer(2,e,this.sampling_rate)).copyToChannel?(r.copyToChannel(t[0],0),r.copyToChannel(t[1],1)):(r.getChannelData(0).set(t[0]),r.getChannelData(1).set(t[1]));if((t=this.audio_context.createBufferSource()).buffer=r,t.connect(this.node_lowpass),t.addEventListener("ended",this.pump.bind(this)),r=this.audio_context.currentTime,this.buffered_time<r)for(this.buffered_time=r,r=.2-i,e=0;e<=r;)e+=i,this.buffered_time+=i,setTimeout((()=>this.pump()),1e3*e);t.start(this.buffered_time),this.buffered_time+=i,setTimeout((()=>this.pump()),0)},zt.prototype.pump=function(){this.enabled&&(.2<this.buffered_time-this.audio_context.currentTime||this.bus.send("dac-request-data"))},It.prototype.continue_init=async function(t,e){function i(t,e){switch(t){case"hda":s.hda=this.disk_images.hda=e;break;case"hdb":s.hdb=this.disk_images.hdb=e;break;case"cdrom":s.cdrom=this.disk_images.cdrom=e;break;case"fda":s.fda=this.disk_images.fda=e;break;case"fdb":s.fdb=this.disk_images.fdb=e;break;case"multiboot":s.multiboot=this.disk_images.multiboot=e.buffer;break;case"bzimage":s.bzimage=this.disk_images.bzimage=e.buffer;break;case"initrd":s.initrd=this.disk_images.initrd=e.buffer;break;case"bios":s.bios=e.buffer;break;case"vga_bios":s.vga_bios=e.buffer;break;case"initial_state":s.initial_state=e.buffer;break;case"fs9p_json":s.fs9p_json=e}}async function r(){if(s.fs9p&&s.fs9p_json&&(s.initial_state||s.fs9p.load_from_json(s.fs9p_json),e.bzimage_initrd_from_filesystem)){let{bzimage_path:t,initrd_path:e}=this.get_bzimage_initrd_from_filesystem(s.fs9p),[r,n]=await Promise.all([s.fs9p.read_file(e),s.fs9p.read_file(t)]);i.call(this,"initrd",new o.SyncBuffer(r.buffer)),i.call(this,"bzimage",new o.SyncBuffer(n.buffer))}this.serial_adapter&&this.serial_adapter.show&&this.serial_adapter.show(),this.bus.send("cpu-init",s),s.initial_state&&(t.restore_state(s.initial_state),s.initial_state=void 0),e.autostart&&this.bus.send("cpu-run"),this.emulator_bus.send("emulator-loaded")}this.bus.register("emulator-stopped",(function(){this.cpu_is_running=!1}),this),this.bus.register("emulator-started",(function(){this.cpu_is_running=!0}),this);var s={};this.disk_images={fda:void 0,fdb:void 0,hda:void 0,hdb:void 0,cdrom:void 0},s.acpi=e.acpi,s.load_devices=!0,s.log_level=e.log_level,s.memory_size=e.memory_size||67108864,s.vga_memory_size=e.vga_memory_size||8388608,s.boot_order=e.boot_order||531,s.fastboot=e.fastboot||!1,s.fda=void 0,s.fdb=void 0,s.uart1=e.uart1,s.uart2=e.uart2,s.uart3=e.uart3,s.cmdline=e.cmdline,s.preserve_mac_from_state_image=e.preserve_mac_from_state_image,s.mac_address_translation=e.mac_address_translation,s.cpuid_level=e.cpuid_level,e.network_adapter?this.network_adapter=e.network_adapter(this.bus):e.network_relay_url&&(this.network_adapter=new mt(e.network_relay_url,this.bus)),s.enable_ne2k=!0,e.disable_keyboard||(this.keyboard_adapter=new gt(this.bus)),e.disable_mouse||(this.mouse_adapter=new yt(this.bus,e.screen_container)),e.screen_container?this.screen_adapter=new bt(e.screen_container,this.bus):e.screen_dummy&&(this.screen_adapter=new vt(this.bus)),e.serial_container&&(this.serial_adapter=new wt(e.serial_container,this.bus)),e.serial_container_xtermjs&&(this.serial_adapter=new kt(e.serial_container_xtermjs,this.bus)),e.disable_speaker||(this.speaker_adapter=new xt(this.bus));var n,a,l=[];e.state&&console.warn("Warning: Unknown option 'state'. Did you mean 'initial_state'?");for(var u="bios vga_bios cdrom hda hdb fda fdb initial_state multiboot bzimage initrd".split(" "),h=0;h<u.length;h++)n=u[h],(a=e[u[h]])&&(a.get&&a.set&&a.load?l.push({name:n,loadable:a}):("bios"!==n&&"vga_bios"!==n&&"initial_state"!==n&&"multiboot"!==n&&"bzimage"!==n&&"initrd"!==n||(a.async=!1),a.buffer instanceof ArrayBuffer?(a=new o.SyncBuffer(a.buffer),l.push({name:n,loadable:a})):"undefined"!=typeof File&&a.buffer instanceof File?(void 0===a.async&&(a.async=268435456<=a.buffer.size),a=a.async?new o.AsyncFileBuffer(a.buffer):new o.SyncFileBuffer(a.buffer),l.push({name:n,loadable:a})):a.url?a.async?(a=a.use_parts?new o.AsyncXHRPartfileBuffer(a.url,a.size,a.fixed_chunk_size):new o.AsyncXHRBuffer(a.url,a.size,a.fixed_chunk_size),l.push({name:n,loadable:a})):l.push({name:n,url:a.url,size:a.size}):(a.url,a.buffer)));if(e.filesystem){u=e.filesystem.basefs,h=e.filesystem.baseurl;let t=new MemoryFileStorage;if(h&&(t=new ServerFileStorageWrapper(t,h)),s.fs9p=this.fs9p=new FS(t),u){if("object"==typeof u){var c=u.size;u=u.url}l.push({name:"fs9p_json",url:u,size:c,as_json:!0})}}var d=this,_=l.length,p=function(t){if(t===_)setTimeout(r.bind(this),0);else{var e=l[t];e.loadable?(e.loadable.onload=function(){i.call(this,e.name,e.loadable),p(t+1)}.bind(this),e.loadable.load()):o.load_file(e.url,{done:function(r){i.call(this,e.name,e.as_json?r:new o.SyncBuffer(r)),p(t+1)}.bind(this),progress:function(i){200===i.target.status?d.emulator_bus.send("download-progress",{file_index:t,file_count:_,file_name:e.url,lengthComputable:i.lengthComputable,total:i.total||e.size,loaded:i.loaded}):d.emulator_bus.send("download-error",{file_index:t,file_count:_,file_name:e.url,request:i.target})},as_json:e.as_json})}}.bind(this);p(0)},It.prototype.get_bzimage_initrd_from_filesystem=function(t){let e,i,r=(t.read_dir("/")||[]).map((t=>"/"+t));t=(t.read_dir("/boot/")||[]).map((t=>"/boot/"+t));for(let s of[].concat(r,t)){let t=/old/i.test(s)||/fallback/i.test(s);!(/vmlinuz/i.test(s)||/bzimage/i.test(s))||i&&t||(i=s),!(/initrd/i.test(s)||/initramfs/i.test(s))||e&&t||(e=s)}return e&&i||(console.log("Failed to find bzimage or initrd in filesystem. Files:"),console.log(r.join(" ")),console.log(t.join(" "))),{initrd_path:e,bzimage_path:i}},It.prototype.run=async function(){this.bus.send("cpu-run")},a.exportProperty(It.prototype,"run",It.prototype.run),It.prototype.stop=async function(){this.cpu_is_running&&await new Promise((t=>{let e=()=>{this.remove_listener("emulator-stopped",e),t()};this.add_listener("emulator-stopped",e),this.bus.send("cpu-stop")}))},a.exportProperty(It.prototype,"stop",It.prototype.stop),It.prototype.destroy=async function(){await this.stop(),this.v86.destroy(),this.keyboard_adapter&&this.keyboard_adapter.destroy(),this.network_adapter&&this.network_adapter.destroy(),this.mouse_adapter&&this.mouse_adapter.destroy(),this.screen_adapter&&this.screen_adapter.destroy(),this.serial_adapter&&this.serial_adapter.destroy(),this.speaker_adapter&&this.speaker_adapter.destroy()},a.exportProperty(It.prototype,"destroy",It.prototype.destroy),It.prototype.restart=function(){this.bus.send("cpu-restart")},a.exportProperty(It.prototype,"restart",It.prototype.restart),It.prototype.add_listener=function(t,e){this.bus.register(t,e,this)},a.exportProperty(It.prototype,"add_listener",It.prototype.add_listener),It.prototype.remove_listener=function(t,e){this.bus.unregister(t,e)},a.exportProperty(It.prototype,"remove_listener",It.prototype.remove_listener),It.prototype.restore_state=async function(t){this.v86.restore_state(t)},a.exportProperty(It.prototype,"restore_state",It.prototype.restore_state),It.prototype.save_state=async function(){return this.v86.save_state()},a.exportProperty(It.prototype,"save_state",It.prototype.save_state),It.prototype.get_statistics=function(){console.warn("V86Starter.prototype.get_statistics is deprecated. Use events instead.");var t={cpu:{instruction_counter:this.get_instruction_counter()}};if(!this.v86)return t;var e=this.v86.cpu.devices;return e.hda&&(t.hda=e.hda.stats),e.cdrom&&(t.cdrom=e.cdrom.stats),e.ps2&&(t.mouse={enabled:e.ps2.use_mouse}),e.vga&&(t.vga={is_graphical:e.vga.stats.is_graphical}),t},a.exportProperty(It.prototype,"get_statistics",It.prototype.get_statistics),It.prototype.get_instruction_counter=function(){return this.v86?this.v86.cpu.instruction_counter[0]>>>0:0},a.exportProperty(It.prototype,"get_instruction_counter",It.prototype.get_instruction_counter),It.prototype.is_running=function(){return this.cpu_is_running},a.exportProperty(It.prototype,"is_running",It.prototype.is_running),It.prototype.keyboard_send_scancodes=function(t){for(var e=0;e<t.length;e++)this.bus.send("keyboard-code",t[e])},a.exportProperty(It.prototype,"keyboard_send_scancodes",It.prototype.keyboard_send_scancodes),It.prototype.keyboard_send_keys=function(t){for(var e=0;e<t.length;e++)this.keyboard_adapter.simulate_press(t[e])},a.exportProperty(It.prototype,"keyboard_send_keys",It.prototype.keyboard_send_keys),It.prototype.keyboard_send_text=function(t){for(var e=0;e<t.length;e++)this.keyboard_adapter.simulate_char(t[e])},a.exportProperty(It.prototype,"keyboard_send_text",It.prototype.keyboard_send_text),It.prototype.screen_make_screenshot=function(){this.screen_adapter&&this.screen_adapter.make_screenshot()},a.exportProperty(It.prototype,"screen_make_screenshot",It.prototype.screen_make_screenshot),It.prototype.screen_set_scale=function(t,e){this.screen_adapter&&this.screen_adapter.set_scale(t,e)},a.exportProperty(It.prototype,"screen_set_scale",It.prototype.screen_set_scale),It.prototype.screen_go_fullscreen=function(){if(this.screen_adapter){var t=document.getElementById("screen_container");if(t){var e=t.requestFullScreen||t.webkitRequestFullscreen||t.mozRequestFullScreen||t.msRequestFullScreen;e&&(e.call(t),(t=document.getElementsByClassName("phone_keyboard")[0])&&t.focus());try{navigator.keyboard.lock()}catch(t){}this.lock_mouse()}}},a.exportProperty(It.prototype,"screen_go_fullscreen",It.prototype.screen_go_fullscreen),It.prototype.lock_mouse=function(){var t=document.body,e=t.requestPointerLock||t.mozRequestPointerLock||t.webkitRequestPointerLock;e&&e.call(t)},a.exportProperty(It.prototype,"lock_mouse",It.prototype.lock_mouse),It.prototype.mouse_set_status=function(t){this.mouse_adapter&&(this.mouse_adapter.emu_enabled=t)},It.prototype.keyboard_set_status=function(t){this.keyboard_adapter&&(this.keyboard_adapter.emu_enabled=t)},a.exportProperty(It.prototype,"keyboard_set_status",It.prototype.keyboard_set_status),It.prototype.serial0_send=function(t){for(var e=0;e<t.length;e++)this.bus.send("serial0-input",t.charCodeAt(e))},a.exportProperty(It.prototype,"serial0_send",It.prototype.serial0_send),It.prototype.serial_send_bytes=function(t,e){for(var i=0;i<e.length;i++)this.bus.send("serial"+t+"-input",e[i])},a.exportProperty(It.prototype,"serial_send_bytes",It.prototype.serial_send_bytes),It.prototype.mount_fs=async function(t,e,i,r){let s=new MemoryFileStorage;e&&(s=new ServerFileStorageWrapper(s,e));let n=new FS(s,this.fs9p.qidcounter),a=()=>{const e=this.fs9p.Mount(t,n);r&&(e===-ENOENT?r(new qt):e===-EEXIST?r(new Pt):r(0>e?Error("Failed to mount. Error number: "+-e):null))};e?n.load_from_json(i,(()=>a())):a()},a.exportProperty(It.prototype,"mount_fs",It.prototype.mount_fs),It.prototype.create_file=async function(t,e){var i=this.fs9p;if(i){var r=t.split("/");if(r=r[r.length-1],t=i.SearchPath(t).parentid,""===r||-1===t)return Promise.reject(new qt);await i.CreateBinaryFile(r,t,e)}},a.exportProperty(It.prototype,"create_file",It.prototype.create_file),It.prototype.read_file=async function(t){var e=this.fs9p;if(e)return(t=await e.read_file(t))?t:Promise.reject(new qt)},a.exportProperty(It.prototype,"read_file",It.prototype.read_file),It.prototype.automatically=function(t){let e=t=>{const i=t[0];if(i){var r=t.slice(1);if(i.sleep)setTimeout((()=>e(r)),1e3*i.sleep);else if(i.vga_text){const s=this.screen_adapter.get_text_screen();for(let t of s)if(t.includes(i.vga_text))return void e(r);setTimeout((()=>e(t)),1e3)}else i.keyboard_send?(i.keyboard_send instanceof Array?this.keyboard_send_scancodes(i.keyboard_send):this.keyboard_send_text(i.keyboard_send),e(r)):i.call&&(i.call(),e(r))}};e(t)},It.prototype.read_memory=function(t,e){return this.v86.cpu.read_blob(t,e)},It.prototype.write_memory=function(t,e){this.v86.cpu.write_blob(t,e)},Pt.prototype=Error.prototype,qt.prototype=Error.prototype,"undefined"!=typeof window?(window.V86Starter=It,window.V86=It):void 0!==t.exports?(t.exports.V86Starter=It,t.exports.V86=It):"function"==typeof importScripts&&(self.V86Starter=It,self.V86=It)},919:()=>{}},e={};function i(r){var s=e[r];if(void 0!==s)return s.exports;var n=e[r]={id:r,loaded:!1,exports:{}};return t[r](n,n.exports,i),n.loaded=!0,n.exports}i.m=t,(()=>{var t,e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__;i.t=function(r,s){if(1&s&&(r=this(r)),8&s)return r;if("object"===typeof r&&r){if(4&s&&r.__esModule)return r;if(16&s&&"function"===typeof r.then)return r}var n=Object.create(null);i.r(n);var a={};t=t||[null,e({}),e([]),e(e)];for(var o=2&s&&r;"object"==typeof o&&!~t.indexOf(o);o=e(o))Object.getOwnPropertyNames(o).forEach((t=>a[t]=()=>r[t]));return a.default=()=>r,i.d(n,a),n}})(),i.d=(t,e)=>{for(var r in e)i.o(e,r)&&!i.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},i.f={},i.e=t=>Promise.all(Object.keys(i.f).reduce(((e,r)=>(i.f[r](t,e),e)),[])),i.u=t=>"static/js/"+t+".8463039d.chunk.js",i.miniCssF=t=>{},i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}(),i.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={},e="my-personal-website:";i.l=(r,s,n,a)=>{if(t[r])t[r].push(s);else{var o,l;if(void 0!==n)for(var u=document.getElementsByTagName("script"),h=0;h<u.length;h++){var c=u[h];if(c.getAttribute("src")==r||c.getAttribute("data-webpack")==e+n){o=c;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,i.nc&&o.setAttribute("nonce",i.nc),o.setAttribute("data-webpack",e+n),o.src=r),t[r]=[s];var d=(e,i)=>{o.onerror=o.onload=null,clearTimeout(_);var s=t[r];if(delete t[r],o.parentNode&&o.parentNode.removeChild(o),s&&s.forEach((t=>t(i))),e)return e(i)},_=setTimeout(d.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=d.bind(null,o.onerror),o.onload=d.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),i.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.p="/my-personal-website/",(()=>{var t={792:0};i.f.j=(e,r)=>{var s=i.o(t,e)?t[e]:void 0;if(0!==s)if(s)r.push(s[2]);else{var n=new Promise(((i,r)=>s=t[e]=[i,r]));r.push(s[2]=n);var a=i.p+i.u(e),o=new Error;i.l(a,(r=>{if(i.o(t,e)&&(0!==(s=t[e])&&(t[e]=void 0),s)){var n=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;o.message="Loading chunk "+e+" failed.\n("+n+": "+a+")",o.name="ChunkLoadError",o.type=n,o.request=a,s[1](o)}}),"chunk-"+e,e)}};var e=(e,r)=>{var s,n,a=r[0],o=r[1],l=r[2],u=0;if(a.some((e=>0!==t[e]))){for(s in o)i.o(o,s)&&(i.m[s]=o[s]);if(l)l(i)}for(e&&e(r);u<a.length;u++)n=a[u],i.o(t,n)&&t[n]&&t[n][0](),t[n]=0},r=self.webpackChunkmy_personal_website=self.webpackChunkmy_personal_website||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})(),(()=>{"use strict";var t,e=i(43),r=i.t(e,2),s=i(391),n=i(950),a=i.t(n,2);function o(){return o=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},o.apply(this,arguments)}!function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"}(t||(t={}));const l="popstate";function u(t,e){if(!1===t||null===t||"undefined"===typeof t)throw new Error(e)}function h(t,e){if(!t){"undefined"!==typeof console&&console.warn(e);try{throw new Error(e)}catch(i){}}}function c(t,e){return{usr:t.state,key:t.key,idx:e}}function d(t,e,i,r){return void 0===i&&(i=null),o({pathname:"string"===typeof t?t:t.pathname,search:"",hash:""},"string"===typeof e?p(e):e,{state:i,key:e&&e.key||r||Math.random().toString(36).substr(2,8)})}function _(t){let{pathname:e="/",search:i="",hash:r=""}=t;return i&&"?"!==i&&(e+="?"===i.charAt(0)?i:"?"+i),r&&"#"!==r&&(e+="#"===r.charAt(0)?r:"#"+r),e}function p(t){let e={};if(t){let i=t.indexOf("#");i>=0&&(e.hash=t.substr(i),t=t.substr(0,i));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function f(e,i,r,s){void 0===s&&(s={});let{window:n=document.defaultView,v5Compat:a=!1}=s,h=n.history,p=t.Pop,f=null,m=g();function g(){return(h.state||{idx:null}).idx}function y(){p=t.Pop;let e=g(),i=null==e?null:e-m;m=e,f&&f({action:p,location:v.location,delta:i})}function b(t){let e="null"!==n.location.origin?n.location.origin:n.location.href,i="string"===typeof t?t:_(t);return i=i.replace(/ $/,"%20"),u(e,"No window.location.(origin|href) available to create URL for href: "+i),new URL(i,e)}null==m&&(m=0,h.replaceState(o({},h.state,{idx:m}),""));let v={get action(){return p},get location(){return e(n,h)},listen(t){if(f)throw new Error("A history only accepts one active listener");return n.addEventListener(l,y),f=t,()=>{n.removeEventListener(l,y),f=null}},createHref:t=>i(n,t),createURL:b,encodeLocation(t){let e=b(t);return{pathname:e.pathname,search:e.search,hash:e.hash}},push:function(e,i){p=t.Push;let s=d(v.location,e,i);r&&r(s,e),m=g()+1;let o=c(s,m),l=v.createHref(s);try{h.pushState(o,"",l)}catch(u){if(u instanceof DOMException&&"DataCloneError"===u.name)throw u;n.location.assign(l)}a&&f&&f({action:p,location:v.location,delta:1})},replace:function(e,i){p=t.Replace;let s=d(v.location,e,i);r&&r(s,e),m=g();let n=c(s,m),o=v.createHref(s);h.replaceState(n,"",o),a&&f&&f({action:p,location:v.location,delta:0})},go:t=>h.go(t)};return v}var m;!function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"}(m||(m={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function g(t,e,i){void 0===i&&(i="/");let r=q(("string"===typeof e?p(e):e).pathname||"/",i);if(null==r)return null;let s=y(t);!function(t){t.sort(((t,e)=>t.score!==e.score?e.score-t.score:function(t,e){let i=t.length===e.length&&t.slice(0,-1).every(((t,i)=>t===e[i]));return i?t[t.length-1]-e[e.length-1]:0}(t.routesMeta.map((t=>t.childrenIndex)),e.routesMeta.map((t=>t.childrenIndex)))))}(s);let n=null;for(let a=0;null==n&&a<s.length;++a){let t=P(r);n=z(s[a],t)}return n}function y(t,e,i,r){void 0===e&&(e=[]),void 0===i&&(i=[]),void 0===r&&(r="");let s=(t,s,n)=>{let a={relativePath:void 0===n?t.path||"":n,caseSensitive:!0===t.caseSensitive,childrenIndex:s,route:t};a.relativePath.startsWith("/")&&(u(a.relativePath.startsWith(r),'Absolute route path "'+a.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),a.relativePath=a.relativePath.slice(r.length));let o=O([r,a.relativePath]),l=i.concat(a);t.children&&t.children.length>0&&(u(!0!==t.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),y(t.children,e,l,o)),(null!=t.path||t.index)&&e.push({path:o,score:E(o,t.index),routesMeta:l})};return t.forEach(((t,e)=>{var i;if(""!==t.path&&null!=(i=t.path)&&i.includes("?"))for(let r of b(t.path))s(t,e,r);else s(t,e)})),e}function b(t){let e=t.split("/");if(0===e.length)return[];let[i,...r]=e,s=i.endsWith("?"),n=i.replace(/\?$/,"");if(0===r.length)return s?[n,""]:[n];let a=b(r.join("/")),o=[];return o.push(...a.map((t=>""===t?n:[n,t].join("/")))),s&&o.push(...a),o.map((e=>t.startsWith("/")&&""===e?"/":e))}const v=/^:[\w-]+$/,w=3,k=2,x=1,C=10,S=-2,A=t=>"*"===t;function E(t,e){let i=t.split("/"),r=i.length;return i.some(A)&&(r+=S),e&&(r+=k),i.filter((t=>!A(t))).reduce(((t,e)=>t+(v.test(e)?w:""===e?x:C)),r)}function z(t,e){let{routesMeta:i}=t,r={},s="/",n=[];for(let a=0;a<i.length;++a){let t=i[a],o=a===i.length-1,l="/"===s?e:e.slice(s.length)||"/",u=I({path:t.relativePath,caseSensitive:t.caseSensitive,end:o},l);if(!u)return null;Object.assign(r,u.params);let h=t.route;n.push({params:r,pathname:O([s,u.pathname]),pathnameBase:L(O([s,u.pathnameBase])),route:h}),"/"!==u.pathnameBase&&(s=O([s,u.pathnameBase]))}return n}function I(t,e){"string"===typeof t&&(t={path:t,caseSensitive:!1,end:!0});let[i,r]=function(t,e,i){void 0===e&&(e=!1);void 0===i&&(i=!0);h("*"===t||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were "'+t.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+t.replace(/\*$/,"/*")+'".');let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((t,e,i)=>(r.push({paramName:e,isOptional:null!=i}),i?"/?([^\\/]+)?":"/([^\\/]+)")));t.endsWith("*")?(r.push({paramName:"*"}),s+="*"===t||"/*"===t?"(.*)$":"(?:\\/(.+)|\\/*)$"):i?s+="\\/*$":""!==t&&"/"!==t&&(s+="(?:(?=\\/|$))");let n=new RegExp(s,e?void 0:"i");return[n,r]}(t.path,t.caseSensitive,t.end),s=e.match(i);if(!s)return null;let n=s[0],a=n.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:r.reduce(((t,e,i)=>{let{paramName:r,isOptional:s}=e;if("*"===r){let t=o[i]||"";a=n.slice(0,n.length-t.length).replace(/(.)\/+$/,"$1")}const l=o[i];return t[r]=s&&!l?void 0:(l||"").replace(/%2F/g,"/"),t}),{}),pathname:n,pathnameBase:a,pattern:t}}function P(t){try{return t.split("/").map((t=>decodeURIComponent(t).replace(/\//g,"%2F"))).join("/")}catch(e){return h(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+e+")."),t}}function q(t,e){if("/"===e)return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let i=e.endsWith("/")?e.length-1:e.length,r=t.charAt(i);return r&&"/"!==r?null:t.slice(i)||"/"}const O=t=>t.join("/").replace(/\/\/+/g,"/"),L=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/");Error;function T(t){return null!=t&&"number"===typeof t.status&&"string"===typeof t.statusText&&"boolean"===typeof t.internal&&"data"in t}const R=["post","put","patch","delete"],N=(new Set(R),["get",...R]);new Set(N),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function U(){return U=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},U.apply(this,arguments)}const D=e.createContext(null);const M=e.createContext(null);const F=e.createContext(null);const j=e.createContext(null);const V=e.createContext({outlet:null,matches:[],isDataRoute:!1});const B=e.createContext(null);function G(){return null!=e.useContext(j)}function W(){return G()||u(!1),e.useContext(j).location}function H(i,r,s,n){G()||u(!1);let{navigator:a}=e.useContext(F),{matches:o}=e.useContext(V),l=o[o.length-1],h=l?l.params:{},c=(l&&l.pathname,l?l.pathnameBase:"/");l&&l.route;let d,_=W();if(r){var f;let t="string"===typeof r?p(r):r;"/"===c||(null==(f=t.pathname)?void 0:f.startsWith(c))||u(!1),d=t}else d=_;let m=d.pathname||"/",y=m;if("/"!==c){let t=c.replace(/^\//,"").split("/");y="/"+m.replace(/^\//,"").split("/").slice(t.length).join("/")}let b=g(i,{pathname:y});let v=Y(b&&b.map((t=>Object.assign({},t,{params:Object.assign({},h,t.params),pathname:O([c,a.encodeLocation?a.encodeLocation(t.pathname).pathname:t.pathname]),pathnameBase:"/"===t.pathnameBase?c:O([c,a.encodeLocation?a.encodeLocation(t.pathnameBase).pathname:t.pathnameBase])}))),o,s,n);return r&&v?e.createElement(j.Provider,{value:{location:U({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:t.Pop}},v):v}function $(){let t=function(){var t;let i=e.useContext(B),r=Z(J.UseRouteError),s=tt(J.UseRouteError);if(void 0!==i)return i;return null==(t=r.errors)?void 0:t[s]}(),i=T(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,s="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:s};return e.createElement(e.Fragment,null,e.createElement("h2",null,"Unexpected Application Error!"),e.createElement("h3",{style:{fontStyle:"italic"}},i),r?e.createElement("pre",{style:n},r):null,null)}const Q=e.createElement($,null);class K extends e.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||"idle"!==e.revalidation&&"idle"===t.revalidation?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:void 0!==t.error?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return void 0!==this.state.error?e.createElement(V.Provider,{value:this.props.routeContext},e.createElement(B.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function X(t){let{routeContext:i,match:r,children:s}=t,n=e.useContext(D);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),e.createElement(V.Provider,{value:i},s)}function Y(t,i,r,s){var n;if(void 0===i&&(i=[]),void 0===r&&(r=null),void 0===s&&(s=null),null==t){var a;if(null==(a=r)||!a.errors)return null;t=r.matches}let o=t,l=null==(n=r)?void 0:n.errors;if(null!=l){let t=o.findIndex((t=>t.route.id&&void 0!==(null==l?void 0:l[t.route.id])));t>=0||u(!1),o=o.slice(0,Math.min(o.length,t+1))}let h=!1,c=-1;if(r&&s&&s.v7_partialHydration)for(let e=0;e<o.length;e++){let t=o[e];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(c=e),t.route.id){let{loaderData:e,errors:i}=r,s=t.route.loader&&void 0===e[t.route.id]&&(!i||void 0===i[t.route.id]);if(t.route.lazy||s){h=!0,o=c>=0?o.slice(0,c+1):[o[0]];break}}}return o.reduceRight(((t,s,n)=>{let a,u=!1,d=null,_=null;var p;r&&(a=l&&s.route.id?l[s.route.id]:void 0,d=s.route.errorElement||Q,h&&(c<0&&0===n?(p="route-fallback",!1||et[p]||(et[p]=!0),u=!0,_=null):c===n&&(u=!0,_=s.route.hydrateFallbackElement||null)));let f=i.concat(o.slice(0,n+1)),m=()=>{let i;return i=a?d:u?_:s.route.Component?e.createElement(s.route.Component,null):s.route.element?s.route.element:t,e.createElement(X,{match:s,routeContext:{outlet:t,matches:f,isDataRoute:null!=r},children:i})};return r&&(s.route.ErrorBoundary||s.route.errorElement||0===n)?e.createElement(K,{location:r.location,revalidation:r.revalidation,component:d,error:a,children:m(),routeContext:{outlet:null,matches:f,isDataRoute:!0}}):m()}),null)}var J=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(J||{});function Z(t){let i=e.useContext(M);return i||u(!1),i}function tt(t){let i=function(t){let i=e.useContext(V);return i||u(!1),i}(),r=i.matches[i.matches.length-1];return r.route.id||u(!1),r.route.id}const et={};r.startTransition;function it(t){u(!1)}function rt(i){let{basename:r="/",children:s=null,location:n,navigationType:a=t.Pop,navigator:o,static:l=!1,future:h}=i;G()&&u(!1);let c=r.replace(/^\/*/,"/"),d=e.useMemo((()=>({basename:c,navigator:o,static:l,future:U({v7_relativeSplatPath:!1},h)})),[c,h,o,l]);"string"===typeof n&&(n=p(n));let{pathname:_="/",search:f="",hash:m="",state:g=null,key:y="default"}=n,b=e.useMemo((()=>{let t=q(_,c);return null==t?null:{location:{pathname:t,search:f,hash:m,state:g,key:y},navigationType:a}}),[c,_,f,m,g,y,a]);return null==b?null:e.createElement(F.Provider,{value:d},e.createElement(j.Provider,{children:s,value:b}))}function st(t){let{children:e,location:i}=t;return H(nt(e),i)}new Promise((()=>{}));e.Component;function nt(t,i){void 0===i&&(i=[]);let r=[];return e.Children.forEach(t,((t,s)=>{if(!e.isValidElement(t))return;let n=[...i,s];if(t.type===e.Fragment)return void r.push.apply(r,nt(t.props.children,n));t.type!==it&&u(!1),t.props.index&&t.props.children&&u(!1);let a={id:t.props.id||n.join("-"),caseSensitive:t.props.caseSensitive,element:t.props.element,Component:t.props.Component,index:t.props.index,path:t.props.path,loader:t.props.loader,action:t.props.action,errorElement:t.props.errorElement,ErrorBoundary:t.props.ErrorBoundary,hasErrorBoundary:null!=t.props.ErrorBoundary||null!=t.props.errorElement,shouldRevalidate:t.props.shouldRevalidate,handle:t.props.handle,lazy:t.props.lazy};t.props.children&&(a.children=nt(t.props.children,n)),r.push(a)})),r}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);try{window.__reactRouterVersion="6"}catch(zt){}new Map;const at=r.startTransition;a.flushSync,r.useId;function ot(t){let{basename:i,children:r,future:s,window:n}=t,a=e.useRef();var o;null==a.current&&(a.current=(void 0===(o={window:n,v5Compat:!0})&&(o={}),f((function(t,e){let{pathname:i,search:r,hash:s}=t.location;return d("",{pathname:i,search:r,hash:s},e.state&&e.state.usr||null,e.state&&e.state.key||"default")}),(function(t,e){return"string"===typeof e?e:_(e)}),null,o)));let l=a.current,[u,h]=e.useState({action:l.action,location:l.location}),{v7_startTransition:c}=s||{},p=e.useCallback((t=>{c&&at?at((()=>h(t))):h(t)}),[h,c]);return e.useLayoutEffect((()=>l.listen(p)),[l,p]),e.createElement(rt,{basename:i,children:r,location:u.location,navigationType:u.action,navigator:l,future:s})}"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;var lt,ut;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(lt||(lt={})),function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"}(ut||(ut={}));var ht=i(579);const ct=function(){return(0,ht.jsxs)("div",{className:"header",children:[(0,ht.jsx)("div",{className:"header-tab",children:(0,ht.jsx)("p",{className:"header-text",children:(0,ht.jsx)("strong",{children:"Gyury Lee"})})}),(0,ht.jsxs)("ul",{className:"header-tab menu effect",children:[(0,ht.jsx)("li",{children:(0,ht.jsx)("a",{href:"#about",children:"About"})}),(0,ht.jsx)("li",{children:(0,ht.jsx)("a",{href:"#experience",children:"Experience"})}),(0,ht.jsx)("li",{children:(0,ht.jsx)("a",{href:"#resume",children:"Resume"})}),(0,ht.jsx)("li",{children:(0,ht.jsx)("a",{href:"#contact",children:"Contact"})})]})]})};var dt=Object.defineProperty,_t=(t,e,i)=>(((t,e,i)=>{e in t?dt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!==typeof e?e+"":e,i),i),pt=new Map,ft=new WeakMap,mt=0,gt=void 0;function yt(t){return Object.keys(t).sort().filter((e=>void 0!==t[e])).map((e=>"".concat(e,"_").concat("root"===e?function(t){return t?(ft.has(t)||(mt+=1,ft.set(t,mt.toString())),ft.get(t)):"0"}(t.root):t[e]))).toString()}function bt(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:gt;if("undefined"===typeof window.IntersectionObserver&&void 0!==r){const s=t.getBoundingClientRect();return e(r,{isIntersecting:r,target:t,intersectionRatio:"number"===typeof i.threshold?i.threshold:0,time:0,boundingClientRect:s,intersectionRect:s,rootBounds:s}),()=>{}}const{id:s,observer:n,elements:a}=function(t){const e=yt(t);let i=pt.get(e);if(!i){const r=new Map;let s;const n=new IntersectionObserver((e=>{e.forEach((e=>{var i;const n=e.isIntersecting&&s.some((t=>e.intersectionRatio>=t));t.trackVisibility&&"undefined"===typeof e.isVisible&&(e.isVisible=n),null==(i=r.get(e.target))||i.forEach((t=>{t(n,e)}))}))}),t);s=n.thresholds||(Array.isArray(t.threshold)?t.threshold:[t.threshold||0]),i={id:e,observer:n,elements:r},pt.set(e,i)}return i}(i),o=a.get(t)||[];return a.has(t)||a.set(t,o),o.push(e),n.observe(t),function(){o.splice(o.indexOf(e),1),0===o.length&&(a.delete(t),n.unobserve(t)),0===a.size&&(n.disconnect(),pt.delete(s))}}e.Component;function vt(){let{threshold:t,delay:i,trackVisibility:r,rootMargin:s,root:n,triggerOnce:a,skip:o,initialInView:l,fallbackInView:u,onChange:h}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var c;const[d,_]=e.useState(null),p=e.useRef(),[f,m]=e.useState({inView:!!l,entry:void 0});p.current=h,e.useEffect((()=>{if(o||!d)return;let e;return e=bt(d,((t,i)=>{m({inView:t,entry:i}),p.current&&p.current(t,i),i.isIntersecting&&a&&e&&(e(),e=void 0)}),{root:n,rootMargin:s,threshold:t,trackVisibility:r,delay:i},u),()=>{e&&e()}}),[Array.isArray(t)?t.toString():t,d,n,s,a,o,r,u,i]);const g=null==(c=f.entry)?void 0:c.target,y=e.useRef();d||!g||a||o||y.current===g||(y.current=g,m({inView:!!l,entry:void 0}));const b=[_,f.inView,f.entry];return b.ref=b[0],b.inView=b[1],b.entry=b[2],b}i(479);i.p,i.p,i.p,i.p;const wt=function(){const[t,i]=(0,e.useState)(null),{ref:r,inView:s}=vt({triggerOnce:!1,threshold:.25}),{ref:n,inView:a}=vt({triggerOnce:!1,threshold:.25}),{ref:o,inView:l}=vt({triggerOnce:!1,threshold:.25}),{ref:u,inView:h}=vt({triggerOnce:!1,threshold:.25}),{ref:c,inView:d}=vt({triggerOnce:!1,threshold:.25});return(0,e.useEffect)((()=>{(new Image).src="https://dn0w09n4za09x.cloudfront.net/grad_pic.png"}),[]),(0,ht.jsxs)("div",{className:"body",children:[t&&(0,ht.jsx)("div",{className:"full-screen-overlay active"}),(0,ht.jsxs)("div",{className:"about",ref:r,style:{opacity:s?1:0},children:[(0,ht.jsx)("div",{className:"intro-tab",children:(0,ht.jsxs)("p",{className:"intro-text",children:[(0,ht.jsx)("strong",{children:"Welcome!"})," \ud83d\udc4b You're in the right place."]})}),(0,ht.jsxs)("div",{className:"intro-container",children:[(0,ht.jsx)("div",{className:"profile-img-container",children:(0,ht.jsx)("img",{className:"profile",src:"https://dn0w09n4za09x.cloudfront.net/grad_pic.png",loading:"eager",alt:"Gyury Lee"})}),(0,ht.jsx)("div",{className:"profile-img-container",children:(0,ht.jsx)("p",{className:"main-intro",children:"I am a recent UIUC grad with a Bachelor of Science in Information Sciences and a minor in Computer Science. My academic journey and experiences span broadly from high-level, human-centered design and data analysis to lower-level computer systems and architecture engineering. I look forward to contributing to your team."})})]})]}),(0,ht.jsxs)("div",{className:"contents",children:[(0,ht.jsxs)("div",{id:"experience",className:"section ".concat(a?"section-visible":"section-hidden"),ref:n,children:[(0,ht.jsx)("div",{children:(0,ht.jsx)("p",{className:"exp_header",children:(0,ht.jsx)("strong",{children:"Experience"})})}),(0,ht.jsx)("div",{className:"projects",children:[{id:1,title:"Linux-like Kernel",desc:"3 developers and I implemented a Linux-like kernel with robust interrupt handling, including IDT configuration for keyboard and RTC interrupts. We implemented paging for memory alignment and developed drivers for terminals, file systems, and RTCs, enhancing functionality with features like vertical scrolling and adjustable virtualized clock frequencies. Additionally, we implemented system calls for effective program and file system management, supported multiple shell instances, and introduced a preemptive scheduler to manage up to six processes across multiple terminals, optimizing task switching and system performance.",img:"/my-personal-website/391os.gif"},{id:2,title:"Elden Ring Speedrun Optimizer",desc:"4 fellow developers and I optimized speedrunning routes in the video game Elden Ring by representing the game's map as a weighted, directed graph with bosses as nodes and travel times as edges. \n            \n                Since we had to account for intricate gameplay dynamics such as boss fight prerequisites and area access restrictions, which required certain bosses to be defeated before others could be accessed. These constraints necessitated more innovative implementation of various algorithms to identify the most efficient routes, both for comprehensive (100% completion) and specific boss-to-boss sequences. The image above showcases the computed paths through a Python-based GUI. \n                \n                Data for the graph was meticulously gathered from actual gameplay by one of our team members, an avid Elden Ring enthusiast.",img:"/my-personal-website/ER_project.png"},{id:3,title:"ML Project Management",desc:"To supplement statistical analysis, I developed an automated data analysis pipeline to create a reproducible and scalable project infrastructure, which significantly enhanced the management of dependencies and streamlined the execution processes that are oftentimes a barrier to 3rd-party verification and reproduction of data analysis.\n\n                This process involves more than the simple automation of mundane tasks. It also supports a robust, modular structure that could easily be scaled and adapted as needed. This ability to abstract away the many planes of complications related to building the project to completion, something ubiquitously important throughout the tech industry, makes it easier for our audience to focus on what is important to them - the analysis and results.\n\n                Above is the DAG representation of the pipeline specific to Iris flower data analysis used to demonstrate the workflow.",img:"/my-personal-website/workflow.png"},{id:4,title:"Dear (My) Data",desc:"Inspired by the year-long, analog data drawing project by Giorgia Lupi and Stefanie Posavec called \u201cDear Data\u201d centered around creating novel and human-centered representations of collected personal data, this project represents my own way of visualizing my music consumption over a week. In this project, I developed a Python application I had run continuously for a week to fetch data on the tracks I listened to, their artists, durations, and genres using Spotify API. I then used this log to categorize and visualize my listening habits by genre, which unveiled interesting patterns in my day-to-day relationship with music.",img:"/my-personal-website/dear_data.png"}].map((t=>(0,ht.jsxs)("div",{className:"project",onClick:()=>i(t),children:[(0,ht.jsx)("div",{className:"project-image-container",children:(0,ht.jsx)("img",{src:t.img,alt:t.title})}),(0,ht.jsx)("div",{className:"overlay",children:(0,ht.jsx)("div",{className:"project-title",children:t.title})})]},t.id)))})]}),t&&(0,ht.jsxs)("div",{className:"popup",children:[(0,ht.jsx)("div",{className:"popup_top",children:(0,ht.jsx)("img",{src:t.img,alt:t.title})}),(0,ht.jsx)("div",{className:"popup_bottom",children:(0,ht.jsx)("div",{className:"popup_desc",children:(0,ht.jsx)("p",{children:t.desc})})}),(0,ht.jsx)("button",{className:"exit_button",onClick:()=>i(null),children:(0,ht.jsx)("img",{src:"/my-personal-website/exit_button.png",alt:"Close"})})]}),(0,ht.jsx)("div",{id:"resume",className:"section ".concat(l?"section-visible":"section-hidden"),ref:o,children:(0,ht.jsxs)("div",{className:"intro-container",children:[(0,ht.jsx)("div",{className:"profile-img-container",children:(0,ht.jsx)("p",{className:"main-intro",children:"Let's get to work. Click here to view or download my resume. \u2192"})}),(0,ht.jsx)("div",{className:"profile-img-container",children:(0,ht.jsx)("a",{href:"/my-personal-website/Gyury Resume 6-2.pdf",target:"_blank",style:{textDecoration:"none"},children:(0,ht.jsxs)("div",{className:"project-image-container",children:[(0,ht.jsx)("img",{className:"profile",src:"/my-personal-website/resume.png",alt:"Resume"}),(0,ht.jsx)("div",{className:"resume-overlay"})]})})})]})}),(0,ht.jsx)("div",{id:"contact",className:"section ".concat(h?"section-visible":"section-hidden"),ref:u,children:(0,ht.jsxs)("p",{className:"contact-text",children:[" Get in touch with me at ",(0,ht.jsx)("a",{href:"mailto:youremail@example.com",style:{textDecoration:"none",color:"hsl(70, 100%, 40%)"},children:"gyury.lee9@gmail.com"})]})}),(0,ht.jsx)("div",{id:"outro",className:"section ".concat(d?"section-visible":"section-hidden"),ref:c,children:(0,ht.jsx)("div",{className:"outro-tab"})})]})]})};const kt=function(){return(0,ht.jsxs)("div",{children:[(0,ht.jsx)("h1",{}),(0,ht.jsx)("p",{})]})};const xt=function(){return(0,ht.jsxs)("div",{children:[(0,ht.jsx)("h1",{children:"My Experience"}),(0,ht.jsx)("p",{children:"This is the experience section."})]})};const Ct=function(){return(0,ht.jsxs)("div",{children:[(0,ht.jsx)("h1",{children:"My Resume"}),(0,ht.jsx)("p",{children:"This is the resume section."})]})};const St=function(){return(0,ht.jsxs)("div",{children:[(0,ht.jsx)("h1",{children:"Contact Me"}),(0,ht.jsx)("p",{children:"Contact me here."})]})};const At=function(){return(0,ht.jsx)(ot,{children:(0,ht.jsxs)("div",{children:[(0,ht.jsx)(ct,{}),(0,ht.jsx)(wt,{}),(0,ht.jsxs)(st,{children:[(0,ht.jsx)(it,{path:"/",element:(0,ht.jsx)(kt,{})}),(0,ht.jsx)(it,{path:"/experience",element:(0,ht.jsx)(xt,{})}),(0,ht.jsx)(it,{path:"/resume",element:(0,ht.jsx)(Ct,{})}),(0,ht.jsx)(it,{path:"/contact",element:(0,ht.jsx)(St,{})})]})]})})},Et=t=>{t&&t instanceof Function&&i.e(453).then(i.bind(i,453)).then((e=>{let{getCLS:i,getFID:r,getFCP:s,getLCP:n,getTTFB:a}=e;i(t),r(t),s(t),n(t),a(t)}))};s.createRoot(document.getElementById("root")).render((0,ht.jsx)(e.StrictMode,{children:(0,ht.jsx)(At,{})})),Et()})()})();
//# sourceMappingURL=main.7aca1340.js.map